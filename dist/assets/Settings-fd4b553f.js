import{_ as d}from"./ListPageTop-78cbc2f3.js";import{r as u,b as p}from"./bypass-api-6126dc83.js";import{r as f,a as m}from"./module-api-04d2f26d.js";import{r as h,b as _}from"./malleable-api-09135b63.js";import{a1 as g,u as i,C as v,as as w,br as b,bs as y,bt as k,n as $,bu as C,at as n,a2 as P,a as r,i as o,a7 as S,j as c}from"./index-e409ba63.js";import{_ as l}from"./VSwitch-3f004360.js";import"./VTooltip-7c0b187f.js";import"./VItemGroup-3637266a.js";const x={components:{ListPageTop:d},data(){return{password:{form:{},loading:!1},rules:{password:[a=>!!a||"Password is required",a=>!!a&&a.length>5||"Password must be larger than 5 characters"],confirmPassword:[a=>!!a||"Confirmation is required",a=>a===this.password.form.password||"Password must match"]},modules:{loading:!1},bypasses:{loading:!1},profiles:{loading:!1},plugins:{loading:!1},showPassword:!1,showConfirm:!1,valid:!1,breads:[{text:"Settings",disabled:!0,href:"/settings"}],avatarUrl:""}},computed:{...g(i,["user"]),applicationStore(){return i()},agentStore(){return v()},userId(){return this.user.id}},watch:{"user.avatar":{async handler(){this.user.avatar&&(this.avatarUrl=await this.getDownloadUrl(this.user.avatar))},immediate:!0}},methods:{async getDownloadUrl(a){return await w(a.id)},handleFileImport(){this.isSelecting=!0,window.addEventListener("focus",()=>{this.isSelecting=!1},{once:!0}),this.$refs.uploader.click()},async onFileChanged(a){const s=a.target.files[0],e=new FormData;e.append("file",s),await b(this.userId,e),this.applicationStore.refreshMe(),this.$snack.success("Upload complete")},async logout(){await this.$root.$confirm("","Are you sure you want to logout?",{color:"green"})&&this.applicationStore.logout()},clearState(){this.applicationStore.clear(),this.agentStore.clear()},submit(){this.password.loading||!this.$refs.form.validate()||(this.password.loading=!0,y(this.user.id,this.password.form.password).then(()=>{this.$snack.success("Password updated"),this.password.form={},this.$refs.form.resetValidation()}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.password.loading=!1}))},resetProfiles(){this.profiles.loading=!0,h().then(()=>{this.$snack.success("Profiles reset successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.profiles.loading=!1})},reloadProfiles(){this.profiles.loading=!0,_().then(()=>{this.$snack.success("Profiles reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.profiles.loading=!1})},reloadModules(){this.modules.loading=!0,f().then(()=>{this.$snack.success("Module reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.modules.loading=!1})},resetModules(){this.modules.loading=!0,m().then(()=>{this.$snack.success("Module reset successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.modules.loading=!1})},reloadBypasses(){this.bypasses.loading=!0,u().then(()=>{this.$snack.success("Bypass reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.bypasses.loading=!1})},resetBypasses(){this.bypasses.loading=!0,p().then(()=>{this.$snack.success("Bypass reset successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.bypasses.loading=!1})},reloadPlugins(){this.plugins.loading=!0,k().then(()=>{this.$snack.success("Plugin reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.plugins.loading=!1})}}};var R=function(){var s=this,e=s._self._c;return e("div",[e(d,{attrs:{breads:s.breads}}),e("div",{staticClass:"page"},[e("div",{staticClass:"first-part point",staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[e(C,{staticClass:"ma-2",on:{click:s.handleFileImport}},[s.user.avatar?e(n,{attrs:{src:s.avatarUrl}}):e(n,{attrs:{src:`https://ui-avatars.com/api/?background=random&name=${s.user.username}`}})],1),e("input",{ref:"uploader",staticClass:"d-none",attrs:{type:"file","aria-label":"uploader"},on:{change:s.onFileChanged}}),e("span",{staticClass:"ma-2"},[s._v(s._s(s.user.username))]),e(P),e(r,{attrs:{color:"primary",text:""},on:{click:s.logout}},[s._v(" Logout ")])],1),e(o),e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e(l,{attrs:{label:"Dark Mode"},model:{value:s.applicationStore.darkMode,callback:function(t){s.$set(s.applicationStore,"darkMode",t)},expression:"applicationStore.darkMode"}}),e(l,{staticClass:"pl-8",attrs:{label:"Chat Widget"},model:{value:s.applicationStore.chatWidget,callback:function(t){s.$set(s.applicationStore,"chatWidget",t)},expression:"applicationStore.chatWidget"}})],1),e(o),s._m(0),e(S,{ref:"form",staticStyle:{"max-width":"500px"},nativeOn:{submit:function(t){return t.preventDefault(),s.submit.apply(null,arguments)}},model:{value:s.valid,callback:function(t){s.valid=t},expression:"valid"}},[e(c,{attrs:{type:s.showPassword?"text":"password","append-icon":s.showPassword?"fa-eye":"fa-eye-slash",rules:s.rules.password,label:"Password",autocomplete:"off",outlined:"",dense:"",required:""},on:{"click:append":function(t){s.showPassword=!s.showPassword}},model:{value:s.password.form.password,callback:function(t){s.$set(s.password.form,"password",t)},expression:"password.form.password"}}),e(c,{attrs:{type:s.showConfirm?"text":"password","append-icon":s.showConfirm?"fa-eye":"fa-eye-slash",rules:s.rules.confirmPassword,label:"Confirm Password",autocomplete:"off",outlined:"",dense:"",required:""},on:{"click:append":function(t){s.showConfirm=!s.showConfirm}},model:{value:s.password.form.confirmPassword,callback:function(t){s.$set(s.password.form,"confirmPassword",t)},expression:"password.form.confirmPassword"}}),e(r,{staticClass:"mt-4 mb-4 primary",attrs:{type:"submit",loading:s.password.loading}},[s._v(" submit ")])],1),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(1),e(l,{attrs:{color:"primary"},model:{value:s.applicationStore.autoSubscribeAgents,callback:function(t){s.$set(s.applicationStore,"autoSubscribeAgents",t)},expression:"applicationStore.autoSubscribeAgents"}})],1),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(2),e(r,{attrs:{color:"error"},on:{click:s.clearState}},[s._v(" Clear ")])],1),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(3),e("div",{staticClass:"d-flex justify-end"},[e(r,{staticClass:"ml-2 mr-2",attrs:{loading:s.profiles.loading,color:"primary"},on:{click:s.reloadProfiles}},[s._v(" Reload ")]),e(r,{staticClass:"ml-2",attrs:{loading:s.profiles.loading,color:"error"},on:{click:s.resetProfiles}},[s._v(" Reset to Defaults ")])],1)]),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(4),e("div",{staticClass:"d-flex justify-end"},[e(r,{staticClass:"ml-2 mr-2",attrs:{loading:s.modules.loading,color:"primary"},on:{click:s.reloadModules}},[s._v(" Reload ")]),e(r,{staticClass:"ml-2",attrs:{loading:s.modules.loading,color:"error"},on:{click:s.resetModules}},[s._v(" Reset to Defaults ")])],1)]),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(5),e("div",{staticClass:"d-flex justify-end"},[e(r,{staticClass:"ml-2 mr-2",attrs:{loading:s.bypasses.loading,color:"primary"},on:{click:s.reloadBypasses}},[s._v(" Reload ")]),e(r,{staticClass:"ml-2",attrs:{loading:s.bypasses.loading,color:"error"},on:{click:s.resetBypasses}},[s._v(" Reset to Defaults ")])],1)]),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(6),e(r,{attrs:{loading:s.plugins.loading,color:"error"},on:{click:s.reloadPlugins}},[s._v(" Reload ")])],1)],1)],1)},M=[function(){var a=this,s=a._self._c;return s("div",{staticClass:"headers pl-0 mt-2"},[s("h4",[a._v("Update Password")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Auto-Subscribe to Agents")]),s("span",[a._v(" This will automatically subscribe to agent notifications."),s("br"),a._v(" Turning this off will require you to manually subscribe to agents. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Clear Application State")]),s("span",[a._v(" This will clear UI preferences and other localstorage data.")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Malleable Profiles")]),s("span",[a._v(" Reload will check for and load new profile configurations."),s("br"),a._v(" Reset will do the same but also reset all database records to defaults. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Modules")]),s("span",[a._v(" Reload will check for and load new module configurations."),s("br"),a._v(" Reset will do the same but also reset all database records to defaults. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Bypasses")]),s("span",[a._v(" Reload will check for and load new bypass configurations."),s("br"),a._v(" Reset will do the same but also reset all database records to defaults. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Plugins")]),s("span",[a._v("Reload will check for and load new plugins.")])])}],A=$(x,R,M,!1,null,null,null,null);const T=A.exports;export{T as default};

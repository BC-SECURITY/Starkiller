import{_ as i}from"./DateTimeDisplay-fc323acc.js";import{h as u}from"./moment-fbc5633a.js";import{D as c}from"./download-stager-ae353708.js";import{C as d,u as _}from"./stager-module-82089185.js";import{n as p,u as g,G as h,H as v,p as w,a as x,b as n,d as k,e as o,f as l,i as b,I as $}from"./index-0d642ee6.js";import{_ as D}from"./VDataTable-330eab6e.js";import{_ as m}from"./AdvancedTable-e25605c2.js";import{_ as f}from"./ListPageTop-45935f88.js";import{_ as T}from"./VSwitch-2fb0a974.js";import"./VTooltip-d0afbec0.js";import"./VSelect-bf684f23.js";import"./VExpansionPanels-d3fe38fe.js";import"./VItemGroup-69e76bc2.js";const L={name:"StagersTable",components:{DateTimeDisplay:i},mixins:[c,d],props:{onlyMyStagers:{type:Boolean,default:!1},input:{type:Array,default:()=>[]}},data(){return{moment:u,headers:[{text:"Name",value:"name"},{text:"Listener",value:"options.Listener"},{text:"Type",value:"template"},{text:"Language",value:"options.Language"},{text:"Created At",value:"created_at"},{text:"Actions",value:"actions",sortable:!1}],selected:[]}},computed:{stagerStore(){return _()},applicationStore(){return g()},stagers(){return this.stagerStore.stagers},stagersStatus(){return this.stagerStore.status},userId(){return this.applicationStore.user.id},filteredStagers(){return this.onlyMyStagers?this.stagers.filter(s=>s.user_id===this.userId):this.stagers}},watch:{selected(s){this.$emit("input",s)}},mounted(){this.getStagers()},methods:{isDownload(s){return s.downloads&&s.downloads.length>0},isOneLiner(s){return s.one_liner},async copy(s){const e=s.downloads.length-1;return this.copyStager(await h(s.downloads[e].id))},async download(s){const e=s.downloads.length-1;return v(s.downloads[e].id)},async deleteStager(s){this.$emit("delete-stager",s)},getStagers(){this.stagerStore.getStagers()}}};var C=function(){var e=this,t=e._self._c;return t("div",[t(D,{attrs:{headers:e.headers,items:e.filteredStagers,"footer-props":{itemsPerPageOptions:[5,10,15,20,50,100]},"items-per-page":15,loading:e.stagersStatus==="loading","item-key":"id",dense:"","show-select":""},scopedSlots:e._u([{key:"item.name",fn:function({item:r}){return[t("router-link",{staticStyle:{color:"inherit"},attrs:{to:{name:"stagerEdit",params:{id:r.id}}}},[e._v(" "+e._s(r.name)+" ")])]}},{key:"item.options.Listener",fn:function({item:r}){return[t("router-link",{staticStyle:{color:"inherit"},attrs:{to:{name:"listenerEdit",params:{id:r.id}}}},[e._v(" "+e._s(r.options.Listener)+" ")])]}},{key:"item.created_at",fn:function({item:r}){return[t(i,{attrs:{timestamp:r.created_at}})]}},{key:"item.actions",fn:function({item:r}){return[t(w,{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:S}){return[t(x,e._g(e._b({attrs:{text:"",icon:"","x-small":""}},"v-btn",S,!1),a),[t(n,[e._v("fa-ellipsis-v")])],1)]}}],null,!0)},[t(k,{staticClass:"ml-2 mr-2"},[e.isDownload(r)?t(o,{key:"download",attrs:{link:""},on:{click:function(a){return e.download(r)}}},[t(l,[t(n,[e._v("fa-download")]),e._v(" Download ")],1)],1):e._e(),e.isOneLiner(r)?t(o,{key:"clipboard",attrs:{link:""},on:{click:function(a){return e.copy(r)}}},[t(l,[t(n,[e._v("fa-paperclip")]),e._v(" Copy to Clipboard ")],1)],1):e._e(),t(o,{key:"copy",attrs:{to:{name:"stagerNew",params:{copy:!0,id:r.id}},link:""}},[t(l,[t(n,[e._v("fa-clone")]),e._v(" Copy ")],1)],1),t(b,{staticClass:"pb-4"}),t(o,{key:"delete",attrs:{link:""},on:{click:function(a){return e.deleteStager(r)}}},[t(l,[t(n,[e._v("fa-trash-alt")]),e._v(" Delete ")],1)],1)],1)],1)]}}]),model:{value:e.selected,callback:function(r){e.selected=r},expression:"selected"}})],1)},M=[],A=p(L,C,M,!1,null,null,null,null);const y=A.exports;const O={name:"Stagers",components:{AdvancedTable:m,ListPageTop:f,StagersTable:y},mixins:[c,d],data(){return{moment:u,breads:[{text:"Stagers",disabled:!0,href:"/stagers"}],selected:[]}},computed:{app(){return $},stagerStore(){return _()},applicationStore(){return g()},showDelete(){return this.selected.length>0}},methods:{create(){this.$router.push({name:"stagerNew"})},async deleteStager(s){await this.$root.$confirm("Delete","Are you sure you want to delete this stager?",{color:"red"})&&await this.stagerStore.deleteStager(s.id)},async deleteStagers(){await this.$root.$confirm("Delete",`Are you sure you want to delete ${this.selected.length} stagers?`,{color:"red"})&&(this.selected.forEach(s=>{this.stagerStore.deleteStager(s.id)}),this.selected=[])},getStagers(){this.$refs.stagersTable.getStagers()}}};var I=function(){var e=this,t=e._self._c;return t("div",[t(f,{attrs:{breads:e.breads,"show-create":!0,"show-refresh":!0,"show-delete":e.showDelete},on:{create:e.create,refresh:e.getStagers,delete:e.deleteStagers}}),t(m,{scopedSlots:e._u([{key:"filters",fn:function(){return[t(T,{attrs:{label:"Only My Stagers"},model:{value:e.applicationStore.filterOnlyMyStagers,callback:function(r){e.$set(e.applicationStore,"filterOnlyMyStagers",r)},expression:"applicationStore.filterOnlyMyStagers"}})]},proxy:!0},{key:"table",fn:function(){return[t(y,{ref:"stagersTable",attrs:{"only-my-stagers":e.applicationStore.filterOnlyMyStagers},on:{"delete-stager":e.deleteStager},model:{value:e.selected,callback:function(r){e.selected=r},expression:"selected"}})]},proxy:!0}])})],1)},E=[],N=p(O,I,E,!1,null,null,null,null);const U=N.exports;export{U as default};

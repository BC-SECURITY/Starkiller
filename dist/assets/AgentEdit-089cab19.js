import{h as pt}from"./moment-fbc5633a.js";import{S as Se,T as G,U as ae,W as wi,b as W,X as Ae,a as Y,Y as ce,Z as Fi,$ as ki,a0 as mn,a1 as Jt,a2 as Dn,a3 as Ei,a4 as Gt,a5 as $i,n as X,p as gn,q as de,a6 as pe,M as yn,j as bn,N as Si,O as Bi,P as xi,a7 as Pi,a8 as Mi,a9 as Ai,aa as ft,A as Ct,x as vt,c as Q,y as _t,z as Te,B as wt,ab as it,ac as Cn,ad as Ti,ae as vn,d as ji,e as Ri,V as Li,s as O,af as Oi,ag as _n,ah as $e,Q as Be,ai as wn,R as zi,aj as Ni,ak as Ii,al as qi,i as Hi}from"./index-10311458.js";import{_ as Ft,a as he,b as Fn,c as Vi}from"./ErrorStateAlert-1a7de5b6.js";import{_ as kt,a as Wi}from"./VTooltip-564982d7.js";import{a as Ui,c as kn,f as Yi}from"./GeneralForm-38aafc57.js";import{_ as En}from"./TagViewer-282b873f.js";import $n from"./AgentTasksList-b3b4c8d3.js";import{_ as je,a as Ji}from"./AgentExecuteModule-f5cec821.js";import{d as Gi}from"./index-c7c3ed43.js";import{e as Fe}from"./module-api-5a85f790.js";import{A as Zi}from"./ansi_up-085adddc.js";import{u as Ki}from"./module-module-281acd1a.js";import{u as Xi}from"./bypass-module-b1cd930a.js";import{_ as J}from"./TooltipButton-4dcca8d6.js";import{a as Sn}from"./ListPageTop-cb2a636e.js";import{_ as Zt,a as ne,b as Kt,c as ie}from"./VTabItem-289cabcc.js";import{a as Qi}from"./VSelect-1496120a.js";import"./VSwitch-71bb7c40.js";import"./credential-module-f94f3b69.js";import"./malleable-module-7f01d214.js";import"./malleable-api-4aa381f4.js";import"./DateTimeDisplay-8bfd7670.js";import"./download-stager-ae353708.js";import"./VPagination-692ea40d.js";import"./VDataTable-5269bf7d.js";import"./ExpansionPanelFilter-56efe5c4.js";import"./VExpansionPanelHeader-3951e104.js";import"./ExpansionPanelSearch-7b06bf94.js";import"./AdvancedTable-b400d6ea.js";import"./VExpansionPanels-9a2763da.js";import"./VItemGroup-06045a82.js";import"./tag-api-315e79cc.js";import"./TechniqueChips-452261c4.js";import"./InfoViewer-e53a7aff.js";import"./AuthorChips-198f4a8a.js";import"./bypass-api-1c22d252.js";const Re=Se.extend({name:"localable",props:{locale:String},computed:{currentLocale(){return this.locale||this.$vuetify.lang.current}}});function er(e,t=0,n=1){let s;return e<100&&e>=0?(s=new Date(Date.UTC(e,t,n)),isFinite(s.getUTCFullYear())&&s.setUTCFullYear(e)):s=new Date(Date.UTC(e,t,n)),s}function mt(e,t,n){const s=7+t-n;return-((7+er(e,0,s).getUTCDay()-t)%7)+s-1}function tr(e,t,n,s){let i=[0,31,59,90,120,151,181,212,243,273,304,334][t];return t>1&&Et(e)&&i++,i+n}function rt(e,t,n){const s=mt(e,t,n),i=mt(e+1,t,n);return((Et(e)?366:365)-s+i)/7}function nr(e,t,n,s,i){const a=mt(e,s,i),o=Math.ceil((tr(e,t,n)-a)/7);return o<1?o+rt(e-1,s,i):o>rt(e,s,i)?o-rt(e,s,i):o}function Et(e){return e%4===0&&e%100!==0||e%400===0}const ir=[0,31,28,31,30,31,30,31,31,30,31,30,31],rr=[0,31,29,31,30,31,30,31,31,30,31,30,31];function sr(e,t){return Et(e)?rr[t]:ir[t]}const ar=G(ae).extend({methods:{genPickerButton(e,t,n,s=!1,i=""){const a=this[e]===t,o=u=>{u.stopPropagation(),this.$emit(`update:${wi(e)}`,t)};return this.$createElement("div",{staticClass:`v-picker__title__btn ${i}`.trim(),class:{"v-picker__title__btn--active":a,"v-picker__title__btn--readonly":s},on:a||s?void 0:{click:o}},Array.isArray(n)?n:[n])}}}),or=G(ar).extend({name:"v-date-picker-title",props:{date:{type:String,default:""},disabled:Boolean,readonly:Boolean,selectingYear:Boolean,value:{type:String},year:{type:[Number,String],default:""},yearIcon:{type:String}},data:()=>({isReversing:!1}),computed:{computedTransition(){return this.isReversing?"picker-reverse-transition":"picker-transition"}},watch:{value(e,t){this.isReversing=e<t}},methods:{genYearIcon(){return this.$createElement(W,{props:{dark:!0}},this.yearIcon)},getYearBtn(){return this.genPickerButton("selectingYear",!0,[String(this.year),this.yearIcon?this.genYearIcon():null],!1,"v-date-picker-title__year")},genTitleText(){return this.$createElement("transition",{props:{name:this.computedTransition}},[this.$createElement("div",{domProps:{innerHTML:this.date||"&nbsp;"},key:this.value})])},genTitleDate(){return this.genPickerButton("selectingYear",!1,[this.genTitleText()],!1,"v-date-picker-title__date")}},render(e){return e("div",{staticClass:"v-date-picker-title",class:{"v-date-picker-title--disabled":this.disabled}},[this.getYearBtn(),this.genTitleDate()])}});function Bn(e,t,n){return Object.keys(e.$listeners).reduce((s,i)=>(i.endsWith(t)&&(s[i.slice(0,-t.length)]=a=>e.$emit(i,n,a)),s),{})}function st(e,t){return Object.keys(e.$listeners).reduce((n,s)=>(s.endsWith(t)&&(n[s]=e.$listeners[s]),n),{})}const lr=(e,t,n)=>(t=t>>0,e=String(e),n=String(n),e.length>t?String(e):(t=t-e.length,t>n.length&&(n+=n.repeat(t/n.length)),n.slice(0,t)+String(e))),L=(e,t=2)=>lr(e,t,"0");function ee(e,t,n={start:0,length:0}){const s=i=>{const[a,o,u]=i.trim().split(" ")[0].split("-");return[L(a,4),L(o||1),L(u||1)].join("-")};try{const i=new Intl.DateTimeFormat(e||void 0,t);return a=>i.format(new Date(`${s(a)}T00:00:00+00:00`))}catch{return n.start||n.length?a=>s(a).substr(n.start||0,n.length):void 0}}const xn=(e,t)=>{const[n,s]=e.split("-").map(Number);return s+t===0?`${n-1}-12`:s+t===13?`${n+1}-01`:`${n}-${L(s+t)}`},V=(e,t)=>{const[n,s=1,i=1]=e.split("-");return`${n}-${L(s)}-${L(i)}`.substr(0,{date:10,month:7,year:4}[t])},ur=G(ae,Re,Ae).extend({name:"v-date-picker-header",props:{disabled:Boolean,format:Function,min:String,max:String,nextAriaLabel:String,nextIcon:{type:String,default:"$next"},prevAriaLabel:String,prevIcon:{type:String,default:"$prev"},readonly:Boolean,value:{type:[Number,String],required:!0}},data(){return{isReversing:!1}},computed:{formatter(){return this.format?this.format:String(this.value).split("-")[1]?ee(this.currentLocale,{month:"long",year:"numeric",timeZone:"UTC"},{length:7}):ee(this.currentLocale,{year:"numeric",timeZone:"UTC"},{length:4})}},watch:{value(e,t){this.isReversing=e<t}},methods:{genBtn(e){const t=e>0?this.nextAriaLabel:this.prevAriaLabel,n=t?this.$vuetify.lang.t(t):void 0,s=this.disabled||e<0&&this.min&&this.calculateChange(e)<this.min||e>0&&this.max&&this.calculateChange(e)>this.max;return this.$createElement(Y,{attrs:{"aria-label":n},props:{dark:this.dark,disabled:s,icon:!0,light:this.light},on:{click:i=>{i.stopPropagation(),this.$emit("input",this.calculateChange(e))}}},[this.$createElement(W,e<0==!this.$vuetify.rtl?this.prevIcon:this.nextIcon)])},calculateChange(e){const[t,n]=String(this.value).split("-").map(Number);return n==null?`${t+e}`:xn(String(this.value),e)},genHeader(){const e=!this.disabled&&(this.color||"accent"),t=this.$createElement("div",this.setTextColor(e,{key:String(this.value)}),[this.$createElement("button",{attrs:{type:"button"},on:{click:()=>this.$emit("toggle")}},ce(this)||[this.formatter(String(this.value))])]),n=this.$createElement("transition",{props:{name:this.isReversing===!this.$vuetify.rtl?"tab-reverse-transition":"tab-transition"}},[t]);return this.$createElement("div",{staticClass:"v-date-picker-header__value",class:{"v-date-picker-header__value--disabled":this.disabled}},[n])}},render(){return this.$createElement("div",{staticClass:"v-date-picker-header",class:{"v-date-picker-header--disabled":this.disabled,...this.themeClasses}},[this.genBtn(-1),this.genHeader(),this.genBtn(1)])}});function Pn(e,t,n,s){return(!s||s(e))&&(!t||e>=t.substr(0,10))&&(!n||e<=n)}const Mn=G(ae,Re,Ae).extend({directives:{Touch:Fi},props:{allowedDates:Function,current:String,disabled:Boolean,format:Function,events:{type:[Array,Function,Object],default:()=>null},eventColor:{type:[Array,Function,Object,String],default:()=>"warning"},min:String,max:String,range:Boolean,readonly:Boolean,scrollable:Boolean,tableDate:{type:String,required:!0},value:[String,Array]},data:()=>({isReversing:!1,wheelThrottle:null}),computed:{computedTransition(){return this.isReversing===!this.$vuetify.rtl?"tab-reverse-transition":"tab-transition"},displayedMonth(){return Number(this.tableDate.split("-")[1])-1},displayedYear(){return Number(this.tableDate.split("-")[0])}},watch:{tableDate(e,t){this.isReversing=e<t}},mounted(){this.wheelThrottle=ki(this.wheel,250)},methods:{genButtonClasses(e,t,n,s,i,a){return{"v-size--default":!t,"v-date-picker-table__current":s,"v-btn--active":n,"v-btn--flat":!e||this.disabled,"v-btn--text":n===s,"v-btn--rounded":t,"v-btn--disabled":!e||this.disabled,"v-btn--outlined":s&&!n,"v-date-picker--first-in-range":i,"v-date-picker--last-in-range":a,...this.themeClasses}},genButtonEvents(e,t,n){if(!this.disabled)return mn({click:()=>{t&&!this.readonly&&this.$emit("input",e)}},Bn(this,`:${n}`,e))},genButton(e,t,n,s,i=!1){const a=Pn(e,this.min,this.max,this.allowedDates),o=this.isSelected(e)&&a,u=e===this.current,c=o?this.setBackgroundColor:this.setTextColor,d=(o||u)&&(this.color||"accent");let p=!1,f=!1;return this.range&&this.value&&Array.isArray(this.value)&&(p=e===this.value[0],f=e===this.value[this.value.length-1]),this.$createElement("button",c(d,{staticClass:"v-btn",class:this.genButtonClasses(a&&!i,t,o,u,p,f),attrs:{type:"button"},domProps:{disabled:this.disabled||!a||i},on:this.genButtonEvents(e,a,n)}),[this.$createElement("div",{staticClass:"v-btn__content"},[s(e)]),this.genEvents(e)])},getEventColors(e){const t=i=>Array.isArray(i)?i:[i];let n,s=[];if(Array.isArray(this.events)?n=this.events.includes(e):this.events instanceof Function?n=this.events(e)||!1:this.events?n=this.events[e]||!1:n=!1,n)n!==!0?s=t(n):typeof this.eventColor=="string"?s=[this.eventColor]:typeof this.eventColor=="function"?s=t(this.eventColor(e)):Array.isArray(this.eventColor)?s=this.eventColor:s=t(this.eventColor[e]);else return[];return s.filter(i=>i)},genEvents(e){const t=this.getEventColors(e);return t.length?this.$createElement("div",{staticClass:"v-date-picker-table__events"},t.map(n=>this.$createElement("div",this.setBackgroundColor(n)))):null},isValidScroll(e,t){const n=t(e),s=n.split("-").length===1?"year":"month";return e<0&&(this.min?n>=V(this.min,s):!0)||e>0&&(this.max?n<=V(this.max,s):!0)},wheel(e,t){this.$emit("update:table-date",t(e.deltaY))},touch(e,t){this.$emit("update:table-date",t(e))},genTable(e,t,n){const s=this.$createElement("transition",{props:{name:this.computedTransition}},[this.$createElement("table",{key:this.tableDate},t)]),i={name:"touch",value:{left:a=>a.offsetX<-15&&this.isValidScroll(1,n)&&this.touch(1,n),right:a=>a.offsetX>15&&this.isValidScroll(-1,n)&&this.touch(-1,n)}};return this.$createElement("div",{staticClass:e,class:{"v-date-picker-table--disabled":this.disabled,...this.themeClasses},on:!this.disabled&&this.scrollable?{wheel:a=>{a.preventDefault(),this.isValidScroll(a.deltaY,n)&&this.wheelThrottle(a,n)}}:void 0,directives:[i]},[s])},isSelected(e){if(Array.isArray(this.value))if(this.range&&this.value.length===2){const[t,n]=[...this.value].sort();return t<=e&&e<=n}else return this.value.indexOf(e)!==-1;return e===this.value}}}),cr=G(Mn).extend({name:"v-date-picker-date-table",props:{firstDayOfWeek:{type:[String,Number],default:0},localeFirstDayOfYear:{type:[String,Number],default:0},showAdjacentMonths:Boolean,showWeek:Boolean,weekdayFormat:Function},computed:{formatter(){return this.format||ee(this.currentLocale,{day:"numeric",timeZone:"UTC"},{start:8,length:2})},weekdayFormatter(){return this.weekdayFormat||ee(this.currentLocale,{weekday:"narrow",timeZone:"UTC"})},weekDays(){const e=parseInt(this.firstDayOfWeek,10);return this.weekdayFormatter?Jt(7).map(t=>this.weekdayFormatter(`2017-01-${e+t+15}`)):Jt(7).map(t=>["S","M","T","W","T","F","S"][(t+e)%7])}},methods:{calculateTableDate(e){return xn(this.tableDate,Math.sign(e||1))},genTHead(){const e=this.weekDays.map(t=>this.$createElement("th",t));return this.showWeek&&e.unshift(this.$createElement("th")),this.$createElement("thead",this.genTR(e))},weekDaysBeforeFirstDayOfTheMonth(){return(new Date(`${this.displayedYear}-${L(this.displayedMonth+1)}-01T00:00:00+00:00`).getUTCDay()-parseInt(this.firstDayOfWeek)+7)%7},getWeekNumber(e){return nr(this.displayedYear,this.displayedMonth,e,parseInt(this.firstDayOfWeek),parseInt(this.localeFirstDayOfYear))},genWeekNumber(e){return this.$createElement("td",[this.$createElement("small",{staticClass:"v-date-picker-table--date__week"},String(e).padStart(2,"0"))])},genTBody(){const e=[],t=new Date(this.displayedYear,this.displayedMonth+1,0).getDate();let n=[],s=this.weekDaysBeforeFirstDayOfTheMonth();this.showWeek&&n.push(this.genWeekNumber(this.getWeekNumber(1)));const i=this.displayedMonth?this.displayedYear:this.displayedYear-1,a=(this.displayedMonth+11)%12,o=new Date(this.displayedYear,this.displayedMonth,0).getDate(),u=this.showWeek?8:7;for(;s--;){const f=`${i}-${L(a+1)}-${L(o-s)}`;n.push(this.$createElement("td",this.showAdjacentMonths?[this.genButton(f,!0,"date",this.formatter,!0)]:[]))}for(s=1;s<=t;s++){const f=`${this.displayedYear}-${L(this.displayedMonth+1)}-${L(s)}`;n.push(this.$createElement("td",[this.genButton(f,!0,"date",this.formatter)])),n.length%u===0&&(e.push(this.genTR(n)),n=[],this.showWeek&&(s<t||this.showAdjacentMonths)&&n.push(this.genWeekNumber(this.getWeekNumber(s+7))))}const c=this.displayedMonth===11?this.displayedYear+1:this.displayedYear,d=(this.displayedMonth+1)%12;let p=1;for(;n.length<u;){const f=`${c}-${L(d+1)}-${L(p++)}`;n.push(this.$createElement("td",this.showAdjacentMonths?[this.genButton(f,!0,"date",this.formatter,!0)]:[]))}return n.length&&e.push(this.genTR(n)),this.$createElement("tbody",e)},genTR(e){return[this.$createElement("tr",e)]}},render(){return this.genTable("v-date-picker-table v-date-picker-table--date",[this.genTHead(),this.genTBody()],this.calculateTableDate)}}),dr=G(Mn).extend({name:"v-date-picker-month-table",computed:{formatter(){return this.format||ee(this.currentLocale,{month:"short",timeZone:"UTC"},{start:5,length:2})}},methods:{calculateTableDate(e){return`${parseInt(this.tableDate,10)+Math.sign(e||1)}`},genTBody(){const e=[],t=Array(3).fill(null),n=12/t.length;for(let s=0;s<n;s++){const i=t.map((a,o)=>{const u=s*t.length+o,c=`${this.displayedYear}-${L(u+1)}`;return this.$createElement("td",{key:u},[this.genButton(c,!1,"month",this.formatter)])});e.push(this.$createElement("tr",{key:s},i))}return this.$createElement("tbody",e)}},render(){return this.genTable("v-date-picker-table v-date-picker-table--month",[this.genTBody()],this.calculateTableDate)}});const hr=G(ae,Re).extend({name:"v-date-picker-years",props:{format:Function,min:[Number,String],max:[Number,String],readonly:Boolean,value:[Number,String]},data(){return{defaultColor:"primary"}},computed:{formatter(){return this.format||ee(this.currentLocale,{year:"numeric",timeZone:"UTC"},{length:4})}},mounted(){setTimeout(()=>{const e=this.$el.getElementsByClassName("active")[0];e?this.$el.scrollTop=e.offsetTop-this.$el.offsetHeight/2+e.offsetHeight/2:this.min&&!this.max?this.$el.scrollTop=this.$el.scrollHeight:!this.min&&this.max?this.$el.scrollTop=0:this.$el.scrollTop=this.$el.scrollHeight/2-this.$el.offsetHeight/2})},methods:{genYearItem(e){const t=this.formatter(`${e}`),n=parseInt(this.value,10)===e,s=n&&(this.color||"primary");return this.$createElement("li",this.setTextColor(s,{key:e,class:{active:n},on:mn({click:()=>this.$emit("input",e)},Bn(this,":year",e))}),t)},genYearItems(){const e=[],t=this.value?parseInt(this.value,10):new Date().getFullYear(),n=this.max?parseInt(this.max,10):t+100,s=Math.min(n,this.min?parseInt(this.min,10):t-100);for(let i=n;i>=s;i--)e.push(this.genYearItem(i));return e}},render(){return this.$createElement("ul",{staticClass:"v-date-picker-years",ref:"years"},this.genYearItems())}});const pr=G(ae,Dn,Ae).extend({name:"v-picker",props:{flat:Boolean,fullWidth:Boolean,landscape:Boolean,noTitle:Boolean,transition:{type:String,default:"fade-transition"},width:{type:[Number,String],default:290}},computed:{computedTitleColor(){const e=this.isDark?!1:this.color||"primary";return this.color||e}},methods:{genTitle(){return this.$createElement("div",this.setBackgroundColor(this.computedTitleColor,{staticClass:"v-picker__title",class:{"v-picker__title--landscape":this.landscape}}),ce(this,"title"))},genBodyTransition(){return this.$createElement("transition",{props:{name:this.transition}},ce(this))},genBody(){return this.$createElement("div",{staticClass:"v-picker__body",class:{"v-picker__body--no-title":this.noTitle,...this.themeClasses},style:this.fullWidth?void 0:{width:Ei(this.width)}},[this.genBodyTransition()])},genActions(){return this.$createElement("div",{staticClass:"v-picker__actions v-card__actions",class:{"v-picker__actions--no-title":this.noTitle}},ce(this,"actions"))}},render(e){return e("div",{staticClass:"v-picker v-card",class:{"v-picker--flat":this.flat,"v-picker--landscape":this.landscape,"v-picker--full-width":this.fullWidth,...this.themeClasses,...this.elevationClasses}},[this.$slots.title?this.genTitle():null,this.genBody(),this.$slots.actions?this.genActions():null])}}),fr=G(ae,Dn,Ae).extend({name:"picker",props:{flat:Boolean,fullWidth:Boolean,headerColor:String,landscape:Boolean,noTitle:Boolean,width:{type:[Number,String],default:290}},methods:{genPickerTitle(){return null},genPickerBody(){return null},genPickerActionsSlot(){return this.$scopedSlots.default?this.$scopedSlots.default({save:this.save,cancel:this.cancel}):ce(this)},genPicker(e){const t=[];if(!this.noTitle){const s=this.genPickerTitle();s&&t.push(s)}const n=this.genPickerBody();return n&&t.push(n),t.push(this.$createElement("template",{slot:"actions"},[this.genPickerActionsSlot()])),this.$createElement(pr,{staticClass:e,props:{color:this.headerColor||this.color,dark:this.dark,elevation:this.elevation,flat:this.flat,fullWidth:this.fullWidth,landscape:this.landscape,light:this.light,width:this.width,noTitle:this.noTitle}},t)}}}),mr=G(Re,fr).extend({name:"v-date-picker",props:{activePicker:String,allowedDates:Function,dayFormat:Function,disabled:Boolean,events:{type:[Array,Function,Object],default:()=>null},eventColor:{type:[Array,Function,Object,String],default:()=>"warning"},firstDayOfWeek:{type:[String,Number],default:0},headerDateFormat:Function,localeFirstDayOfYear:{type:[String,Number],default:0},max:String,min:String,monthFormat:Function,multiple:Boolean,nextIcon:{type:String,default:"$next"},nextMonthAriaLabel:{type:String,default:"$vuetify.datePicker.nextMonthAriaLabel"},nextYearAriaLabel:{type:String,default:"$vuetify.datePicker.nextYearAriaLabel"},pickerDate:String,prevIcon:{type:String,default:"$prev"},prevMonthAriaLabel:{type:String,default:"$vuetify.datePicker.prevMonthAriaLabel"},prevYearAriaLabel:{type:String,default:"$vuetify.datePicker.prevYearAriaLabel"},range:Boolean,reactive:Boolean,readonly:Boolean,scrollable:Boolean,showCurrent:{type:[Boolean,String],default:!0},selectedItemsText:{type:String,default:"$vuetify.datePicker.itemsSelected"},showAdjacentMonths:Boolean,showWeek:Boolean,titleDateFormat:Function,type:{type:String,default:"date",validator:e=>["date","month"].includes(e)},value:[Array,String],weekdayFormat:Function,yearFormat:Function,yearIcon:String},data(){const e=new Date;return{internalActivePicker:this.type.toUpperCase(),inputDay:null,inputMonth:null,inputYear:null,isReversing:!1,now:e,tableDate:(()=>{if(this.pickerDate)return this.pickerDate;const t=Gt(this.value),n=t[t.length-1]||(typeof this.showCurrent=="string"?this.showCurrent:`${e.getFullYear()}-${e.getMonth()+1}`);return V(n,this.type==="date"?"month":"year")})()}},computed:{multipleValue(){return Gt(this.value)},isMultiple(){return this.multiple||this.range},lastValue(){return this.isMultiple?this.multipleValue[this.multipleValue.length-1]:this.value},selectedMonths(){return!this.value||this.type==="month"?this.value:this.isMultiple?this.multipleValue.map(e=>e.substr(0,7)):this.value.substr(0,7)},current(){return this.showCurrent===!0?V(`${this.now.getFullYear()}-${this.now.getMonth()+1}-${this.now.getDate()}`,this.type):this.showCurrent||null},inputDate(){return this.type==="date"?`${this.inputYear}-${L(this.inputMonth+1)}-${L(this.inputDay)}`:`${this.inputYear}-${L(this.inputMonth+1)}`},tableMonth(){return Number((this.pickerDate||this.tableDate).split("-")[1])-1},tableYear(){return Number((this.pickerDate||this.tableDate).split("-")[0])},minMonth(){return this.min?V(this.min,"month"):null},maxMonth(){return this.max?V(this.max,"month"):null},minYear(){return this.min?V(this.min,"year"):null},maxYear(){return this.max?V(this.max,"year"):null},formatters(){return{year:this.yearFormat||ee(this.currentLocale,{year:"numeric",timeZone:"UTC"},{length:4}),titleDate:this.titleDateFormat||(this.isMultiple?this.defaultTitleMultipleDateFormatter:this.defaultTitleDateFormatter)}},defaultTitleMultipleDateFormatter(){return e=>e.length?e.length===1?this.defaultTitleDateFormatter(e[0]):this.$vuetify.lang.t(this.selectedItemsText,e.length):"-"},defaultTitleDateFormatter(){const e={year:{year:"numeric",timeZone:"UTC"},month:{month:"long",timeZone:"UTC"},date:{weekday:"short",month:"short",day:"numeric",timeZone:"UTC"}},t=ee(this.currentLocale,e[this.type],{start:0,length:{date:10,month:7,year:4}[this.type]}),n=s=>t(s).replace(/([^\d\s])([\d])/g,(i,a,o)=>`${a} ${o}`).replace(", ",",<br>");return this.landscape?n:t}},watch:{internalActivePicker:{immediate:!0,handler(e){this.$emit("update:active-picker",e)}},activePicker(e){this.internalActivePicker=e},tableDate(e,t){const n=this.type==="month"?"year":"month";this.isReversing=V(e,n)<V(t,n),this.$emit("update:picker-date",e)},pickerDate(e){e?this.tableDate=e:this.lastValue&&this.type==="date"?this.tableDate=V(this.lastValue,"month"):this.lastValue&&this.type==="month"&&(this.tableDate=V(this.lastValue,"year"))},value(e,t){this.checkMultipleProp(),this.setInputDate(),(!this.isMultiple&&this.value&&!this.pickerDate||this.isMultiple&&this.multipleValue.length&&(!t||!t.length)&&!this.pickerDate)&&(this.tableDate=V(this.inputDate,this.type==="month"?"year":"month"))},type(e){if(this.internalActivePicker=e.toUpperCase(),this.value&&this.value.length){const t=this.multipleValue.map(n=>V(n,e)).filter(this.isDateAllowed);this.$emit("input",this.isMultiple?t:t[0])}}},created(){this.checkMultipleProp(),this.pickerDate!==this.tableDate&&this.$emit("update:picker-date",this.tableDate),this.setInputDate()},methods:{emitInput(e){if(this.range){if(this.multipleValue.length!==1)this.$emit("input",[e]);else{const n=[this.multipleValue[0],e];this.$emit("input",n),this.$emit("change",n)}return}const t=this.multiple?this.multipleValue.indexOf(e)===-1?this.multipleValue.concat([e]):this.multipleValue.filter(n=>n!==e):e;this.$emit("input",t),this.multiple||this.$emit("change",e)},checkMultipleProp(){if(this.value==null)return;const e=this.value.constructor.name,t=this.isMultiple?"Array":"String";e!==t&&$i(`Value must be ${this.isMultiple?"an":"a"} ${t}, got ${e}`,this)},isDateAllowed(e){return Pn(e,this.min,this.max,this.allowedDates)},yearClick(e){this.inputYear=e,this.type==="month"?this.tableDate=`${e}`:this.tableDate=`${e}-${L((this.tableMonth||0)+1)}`,this.internalActivePicker="MONTH",this.reactive&&!this.readonly&&!this.isMultiple&&this.isDateAllowed(this.inputDate)&&this.$emit("input",this.inputDate)},monthClick(e){const[t,n]=e.split("-");this.inputYear=parseInt(t,10),this.inputMonth=parseInt(n,10)-1,this.type==="date"?(this.inputDay&&(this.inputDay=Math.min(this.inputDay,sr(this.inputYear,this.inputMonth+1))),this.tableDate=e,this.internalActivePicker="DATE",this.reactive&&!this.readonly&&!this.isMultiple&&this.isDateAllowed(this.inputDate)&&this.$emit("input",this.inputDate)):this.emitInput(this.inputDate)},dateClick(e){const[t,n,s]=e.split("-");this.inputYear=parseInt(t,10),this.inputMonth=parseInt(n,10)-1,this.inputDay=parseInt(s,10),this.emitInput(this.inputDate)},genPickerTitle(){return this.$createElement(or,{props:{date:this.value?this.formatters.titleDate(this.isMultiple?this.multipleValue:this.value):"",disabled:this.disabled,readonly:this.readonly,selectingYear:this.internalActivePicker==="YEAR",year:this.formatters.year(this.multipleValue.length?`${this.inputYear}`:this.tableDate),yearIcon:this.yearIcon,value:this.multipleValue[0]},slot:"title",on:{"update:selecting-year":e=>this.internalActivePicker=e?"YEAR":this.type.toUpperCase()}})},genTableHeader(){return this.$createElement(ur,{props:{nextIcon:this.nextIcon,color:this.color,dark:this.dark,disabled:this.disabled,format:this.headerDateFormat,light:this.light,locale:this.locale,min:this.internalActivePicker==="DATE"?this.minMonth:this.minYear,max:this.internalActivePicker==="DATE"?this.maxMonth:this.maxYear,nextAriaLabel:this.internalActivePicker==="DATE"?this.nextMonthAriaLabel:this.nextYearAriaLabel,prevAriaLabel:this.internalActivePicker==="DATE"?this.prevMonthAriaLabel:this.prevYearAriaLabel,prevIcon:this.prevIcon,readonly:this.readonly,value:this.internalActivePicker==="DATE"?`${L(this.tableYear,4)}-${L(this.tableMonth+1)}`:`${L(this.tableYear,4)}`},on:{toggle:()=>this.internalActivePicker=this.internalActivePicker==="DATE"?"MONTH":"YEAR",input:e=>this.tableDate=e}})},genDateTable(){return this.$createElement(cr,{props:{allowedDates:this.allowedDates,color:this.color,current:this.current,dark:this.dark,disabled:this.disabled,events:this.events,eventColor:this.eventColor,firstDayOfWeek:this.firstDayOfWeek,format:this.dayFormat,light:this.light,locale:this.locale,localeFirstDayOfYear:this.localeFirstDayOfYear,min:this.min,max:this.max,range:this.range,readonly:this.readonly,scrollable:this.scrollable,showAdjacentMonths:this.showAdjacentMonths,showWeek:this.showWeek,tableDate:`${L(this.tableYear,4)}-${L(this.tableMonth+1)}`,value:this.value,weekdayFormat:this.weekdayFormat},ref:"table",on:{input:this.dateClick,"update:table-date":e=>this.tableDate=e,...st(this,":date")}})},genMonthTable(){return this.$createElement(dr,{props:{allowedDates:this.type==="month"?this.allowedDates:null,color:this.color,current:this.current?V(this.current,"month"):null,dark:this.dark,disabled:this.disabled,events:this.type==="month"?this.events:null,eventColor:this.type==="month"?this.eventColor:null,format:this.monthFormat,light:this.light,locale:this.locale,min:this.minMonth,max:this.maxMonth,range:this.range,readonly:this.readonly&&this.type==="month",scrollable:this.scrollable,value:this.selectedMonths,tableDate:`${L(this.tableYear,4)}`},ref:"table",on:{input:this.monthClick,"update:table-date":e=>this.tableDate=e,...st(this,":month")}})},genYears(){return this.$createElement(hr,{props:{color:this.color,format:this.yearFormat,locale:this.locale,min:this.minYear,max:this.maxYear,value:this.tableYear},on:{input:this.yearClick,...st(this,":year")}})},genPickerBody(){const e=this.internalActivePicker==="YEAR"?[this.genYears()]:[this.genTableHeader(),this.internalActivePicker==="DATE"?this.genDateTable():this.genMonthTable()];return this.$createElement("div",{key:this.internalActivePicker},e)},setInputDate(){if(this.lastValue){const e=this.lastValue.split("-");this.inputYear=parseInt(e[0],10),this.inputMonth=parseInt(e[1],10)-1,this.type==="date"&&(this.inputDay=parseInt(e[2],10))}else this.inputYear=this.inputYear||this.now.getFullYear(),this.inputMonth=this.inputMonth==null?this.inputMonth:this.now.getMonth(),this.inputDay=this.inputDay||this.now.getDate()}},render(){return this.genPicker("v-picker--date")}});const Dr={components:{},props:{editable:{type:Boolean,default:!0},label:{type:String,required:!0},value:{type:[String,Number],default:""},infoText:{type:String,default:""},dataType:{type:String,default:"string"},suggestedValues:{type:Array,default:()=>[]},strict:{type:Boolean,default:!1},rules:{type:Array,default:()=>[]}},data(){return{internalValue:this.value,editing:!1,menu:!1,original:"",moment:pt}},computed:{dirty(){return this.original!==this.internalValue}},watch:{internalValue(e){this.$emit("input",e)}},mounted(){this.original=this.value},methods:{clicked(){this.editable&&(this.editing=!0,this.$nextTick(()=>{this.dataType==="date"||this.dataType==="date-range"?this.menu=!0:this.$refs.field.focus()}))},async update(){this.$refs.field.validate&&this.$refs.field.validate()===!1||(this.label==="Delay"?this.internalValue=Math.floor(this.internalValue):this.label==="Jitter"&&(this.internalValue=Math.floor(this.internalValue*10)/10),await this.$nextTick(),this.editing=!1,this.$emit("update"))},revert(){this.editing=!1,this.internalValue=this.original},async clear(){this.internalValue="",await this.$nextTick(),this.editing=!1,this.$emit("update")},getColClass(){return this.editing===!1&&this.editable===!0?"column-not-editing-dark":""}}};var gr=function(){var t=this,n=t._self._c;return n(Ft,{staticClass:"pb-5"},[n(he,{staticClass:"d-flex align-center justify-start",attrs:{cols:"4"}},[n("span",{staticClass:"text--bold"},[t._v(t._s(t.label))]),t.infoText?n(kt,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:i}){return[n(W,t._g(t._b({staticClass:"ml-2",attrs:{small:""}},"v-icon",i,!1),s),[t._v(" mdi-information-outline ")])]}}],null,!1,3230721012)},[n("span",[t._v(t._s(t.infoText))])]):t._e()],1),n(he,{class:t.getColClass(),attrs:{cols:"6"},on:{click:t.clicked}},[t.editing&&t.editable?[t.suggestedValues.length>0&&t.strict?n(Ui,{ref:"field",attrs:{items:t.suggestedValues,label:t.label,outlined:"",dense:""},on:{blur:t.update,keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.update.apply(null,arguments)}},model:{value:t.internalValue,callback:function(s){t.internalValue=s},expression:"internalValue"}}):t.dataType==="date"||t.dataType==="date-range"?n(gn,{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:i}){return[n(de,t._g(t._b({ref:"field",attrs:{label:"Picker in menu","prepend-icon":"mdi-calendar",readonly:"",clearable:""},on:{"click:clear":t.clear},model:{value:t.internalValue,callback:function(a){t.internalValue=a},expression:"internalValue"}},"v-text-field",i,!1),s))]}}],null,!1,2992141911),model:{value:t.menu,callback:function(s){t.menu=s},expression:"menu"}},[n(mr,{attrs:{outlined:"",dense:"",range:t.dataType==="date-range",min:t.moment().format("YYYY-MM-DD")},on:{blur:t.update,keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.update.apply(null,arguments)}},model:{value:t.internalValue,callback:function(s){t.internalValue=s},expression:"internalValue"}},[n(pe),n(Y,{attrs:{text:"",color:"primary"},on:{click:function(s){t.menu=!1,t.editing=!1,t.revert()}}},[t._v(" Cancel ")]),n(Y,{attrs:{text:"",color:"primary"},on:{click:function(s){t.menu=!1,t.update()}}},[t._v(" OK ")])],1)],1):t.dataType==="string"||t.dataType==="number"?n(de,{ref:"field",staticStyle:{"margin-bottom":"-45px"},attrs:{rules:t.rules,label:t.label,type:t.dataType==="string"?"text":"number",step:t.label==="Jitter"?"0.1":"1",max:t.label==="Jitter"?"1":"",min:"0",outlined:"",dense:"",required:""},on:{blur:t.update},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.update.apply(null,arguments)}},model:{value:t.internalValue,callback:function(s){t.internalValue=s},expression:"internalValue"}}):t._e()]:n("span",{staticClass:"ml-3"},[t._v(" "+t._s(t.internalValue)+" ")])],2)],1)},yr=[],br=X(Dr,gr,yr,!1,null,null,null,null);const z=br.exports;const Cr={components:{TagViewer:En,ClickToEdit:z},props:{agent:{type:Object,required:!0},readOnly:{type:Boolean,default:!1}},data(){return{valid:!0,nameLoading:!1,loading:!1,labelPosition:"left",rules:{},form:{},moment:pt,workingHoursRules:[e=>/^[0-9]{1,2}:[0-5][0-9]-[0-9]{1,2}:[0-5][0-9]$/.test(e)||"Must be in the format 00:00-24:00"],nameRules:[e=>!!e||"Name is required",e=>!!e&&e.length>2||"Name must be at least 3 characters"],jitterRules:[e=>!Number.isNaN(e)||"Jitter must be a number",e=>e>=0&&e<=1||"Jitter must be between 0 and 1"],delayRules:[e=>!Number.isNaN(e)||"Delay must be a number",e=>e>=0||"Delay must be a positive number"]}},computed:{agentStore(){return yn()},listenerStore(){return bn()},listeners(){return this.listenerStore.listeners},fields(){return Object.keys(this.agent).map(e=>({name:e,Value:typeof this.agent[e]=="boolean"?`${this.agent[e]}`:this.agent[e]}))},requiredFields(){return this.fields.filter(e=>["name"].indexOf(e.name)<0)}},watch:{fields:{immediate:!0,handler(e){const t=e.reduce((n,s)=>{if(s.name==="kill_date"&&s.Value&&s.Value.length>0){const i=s.Value.split("/"),a=i[2],o=i[0],u=i[1];n[s.name]=`${a}-${o}-${u}`}else n[s.name]=s.Value;return n},{});Se.set(this,"form",t)}}},mounted(){this.listenerStore.getListeners()},methods:{deleteTag(e){Si(this.agent.session_id,e.id).then(()=>{this.$emit("refresh-agent")}).catch(t=>this.$snack.error(`Error: ${t}`))},updateTag(e){Bi(this.agent.session_id,e).then(()=>{this.$emit("refresh-agent"),this.$snack.success("Tag updated")}).catch(t=>this.$snack.error(`Error: ${t}`))},addTag(e){xi(this.agent.session_id,e).then(()=>{this.$emit("refresh-agent")}).catch(t=>this.$snack.error(`Error: ${t}`))},async updateName(){if(this.agent.name!==this.form.name){try{await this.agentStore.rename({sessionId:this.agent.session_id,newName:this.form.name})}catch(e){this.$snack.error(`Update agent listener failed: ${e}`);return}this.$snack.info(`Agent ${this.agent.name} name updated`),this.$emit("refresh-agent")}},async updateListener(){if(this.agent.listener!==this.form.listener){try{const e=this.listeners.filter(t=>t.name===this.form.listener)[0].id;await Pi(this.agent.session_id,e)}catch(e){this.$snack.error(`Update agent listener failed: ${e}`);return}this.$snack.info(`Tasked agent to change listener to: ${this.form.listener}`),this.$emit("refresh-agent")}},async updateKillDate(){let e="";if(this.form.kill_date&&this.form.kill_date.length>0&&(e=pt(this.form.kill_date).format("MM/DD/YYYY")),this.agent.kill_date!==e){try{await Mi(this.agent.session_id,e)}catch(t){this.$snack.error(`Update agent kill date failed: ${t}`);return}this.$snack.info(`Tasked agent to change kill date to: ${e}`),this.$emit("refresh-agent")}},async updateWorkingHours(){if(this.agent.working_hours!==this.form.working_hours){try{await Ai(this.agent.session_id,this.form.working_hours)}catch(e){this.$snack.error(`Update agent working hours failed: ${e}`);return}this.$snack.info(`Tasked agent to change working hours to: ${this.form.working_hours}`),this.$emit("refresh-agent")}},async updateDelay(){if(this.agent.delay!==this.form.delay){try{await ft(this.agent.session_id,this.form.delay,this.form.jitter)}catch(e){this.$snack.error(`Update agent delay failed: ${e}`);return}this.$snack.info(`Tasked agent to change delay to: ${this.form.delay}`),this.$emit("refresh-agent")}},async updateJitter(){if(this.agent.jitter!==this.form.jitter){try{await ft(this.agent.session_id,this.form.delay,this.form.jitter)}catch(e){this.$snack.error(`Update agent delay failed: ${e}`);return}this.$snack.info(`Tasked agent to change jitter to: ${this.form.jitter}`),this.$emit("refresh-agent")}},fieldExists(e){return this.fields.filter(t=>t.name===e).length>0}}};var vr=function(){var t=this,n=t._self._c;return n("div",{staticStyle:{padding:"10px"}},[n(En,{attrs:{tags:t.agent.tags},on:{"update-tag":t.updateTag,"delete-tag":t.deleteTag,"new-tag":t.addTag}}),t.agent.session_id?n(Ct,{ref:"form",model:{value:t.valid,callback:function(s){t.valid=s},expression:"valid"}},[n(z,{attrs:{label:"Session ID",editable:!1,value:t.form.session_id}}),n(z,{attrs:{label:"Name",rules:t.nameRules,editable:!t.readOnly},on:{update:t.updateName},model:{value:t.form.name,callback:function(s){t.$set(t.form,"name",s)},expression:"form.name"}}),n(z,{attrs:{label:"External IP",value:t.form.external_ip,editable:!1}}),n(z,{attrs:{label:"Internal IP",value:t.form.internal_ip,editable:!1}}),n(z,{attrs:{label:"Host Name",value:t.form.hostname,editable:!1}}),n(z,{attrs:{label:"Username",value:t.form.username,editable:!1}}),n(z,{attrs:{label:"Listener","info-text":"The listener to task the agent to use","data-type":"string","suggested-values":t.listeners.map(s=>s.name),strict:!0,editable:!t.readOnly},on:{update:t.updateListener},model:{value:t.form.listener,callback:function(s){t.$set(t.form,"listener",s)},expression:"form.listener"}}),n(z,{attrs:{label:"Kill Date","data-type":"date","info-text":"Date format: YYYY-MM-DD",editable:!t.readOnly},on:{update:t.updateKillDate},model:{value:t.form.kill_date,callback:function(s){t.$set(t.form,"kill_date",s)},expression:"form.kill_date"}}),n(z,{attrs:{label:"Working Hours","info-text":"Format: 00:00-24:00",rules:t.workingHoursRules,editable:!t.readOnly},on:{update:t.updateWorkingHours},model:{value:t.form.working_hours,callback:function(s){t.$set(t.form,"working_hours",s)},expression:"form.working_hours"}}),n(z,{attrs:{label:"Check In Time",value:t.moment(t.form.checkin_time).fromNow(),editable:!1}}),n(z,{attrs:{label:"Last Seen Time",value:t.moment(t.form.lastseen_time).fromNow(),editable:!1}}),n(z,{attrs:{label:"Delay","info-text":"Delay in seconds before the agent checks in","data-type":"number",rules:t.delayRules,editable:!t.readOnly},on:{update:t.updateDelay},model:{value:t.form.delay,callback:function(s){t.$set(t.form,"delay",s)},expression:"form.delay"}}),n(z,{attrs:{label:"Jitter","info-text":"Randomness in delay as a decimal between 0 and 1","data-type":"number",rules:t.jitterRules,editable:!t.readOnly},on:{update:t.updateJitter},model:{value:t.form.jitter,callback:function(s){t.$set(t.form,"jitter",s)},expression:"form.jitter"}}),n(z,{attrs:{label:"Lost Limit","data-type":"number",editable:!1},model:{value:t.form.lost_limit,callback:function(s){t.$set(t.form,"lost_limit",s)},expression:"form.lost_limit"}}),n(z,{attrs:{label:"OS Details",value:t.form.os_details,editable:!1}}),n(z,{attrs:{label:"Architecture",value:t.form.architecture,editable:!1}}),n(z,{attrs:{label:"Process ID",value:t.form.process_id,editable:!1}}),n(z,{attrs:{label:"Process Name",value:t.form.process_name,editable:!1}}),n(z,{attrs:{label:"Language",value:t.form.language,editable:!1}}),n(z,{attrs:{label:"Language Version",value:t.form.language_version,editable:!1}}),n(z,{attrs:{label:"Profile",value:t.form.profile,editable:!1}})],1):t._e()],1)},_r=[],wr=X(Cr,vr,_r,!1,null,"3e179fb2",null,null);const An=wr.exports,Fr={components:{AgentExecuteModule:je},props:{value:Boolean,loading:{type:Boolean,default:!1},agent:{type:String,required:!0},moduleName:{type:String,required:!0},moduleOptionDefaults:{type:Object,default:()=>{}}},data(){return{}},computed:{show:{get(){return this.value},set(e){this.$emit("input",e)}}},methods:{async submit(){this.$refs.executeform.validate()&&(this.$refs.executeform.create(),this.show=!1)}}};var kr=function(){var t=this,n=t._self._c;return n(vt,{ref:"downloadDialog",attrs:{"max-width":"800px"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[n(Q,[n(_t,[n("span",{staticClass:"headline"})]),n(Te,[t.show?n(je,{ref:"executeform",attrs:{agents:[t.agent],"module-name":t.moduleName,"module-option-defaults":t.moduleOptionDefaults,"show-submit":!1},on:{submitted:t.submit}}):t._e()],1),n(wt,[n(pe),n(Y,{attrs:{color:"error",text:""},on:{click:function(s){s.stopPropagation(),t.show=!1}}},[t._v(" Close ")]),n(Y,{attrs:{color:"primary",loading:t.loading},on:{click:t.submit}},[t._v(" Submit ")])],1)],1)],1)},Er=[],$r=X(Fr,kr,Er,!1,null,null,null,null);const Tn=$r.exports;async function Dt(e=1e3){return new Promise(t=>setTimeout(t,e))}const Sr={components:{ExecuteModuleDialog:Tn},props:{agent:{type:Object,required:!0},readOnly:{type:Boolean,default:!1}},data(){return{files:{html:"mdi-language-html5",js:"mdi-nodejs",json:"mdi-json",md:"mdi-markdown",pdf:"mdi-file-pdf",png:"mdi-file-image",txt:"mdi-file-document-outline",xls:"mdi-file-excel",xlsx:"mdi-file-excel",ppt:"mdi-file-powerpoint",pptx:"mdi-file-powerpoint",jpg:"mdi-file-image",jpeg:"mdi-file-image",gif:"mdi-file-image",doc:"mdi-file-word",docx:"mdi-file-word"},tree:[],open:[],showMenu:!1,menuPosition:{x:0,y:0},selected:{},force:{},currentlyLoading:{},loading:!1,debouncedLoadChildren:null,executeDialog:!1,moduleName:"",moduleOptionDefaults:{}}},computed:{menuItems(){return[{id:"close",name:"Close",fileOption:!1,folderOption:!0},{id:"open",name:"Open",fileOption:!1,folderOption:!0},{id:"refresh",name:"Refresh",fileOption:!1,folderOption:!0},{id:"download",name:"Download to Empire",fileOption:!0,folderOption:!1},{id:"zip",name:"Zip Folder",fileOption:!1,folderOption:!0},{id:"upload",name:"Upload",folderOption:!0,fileOption:!1}].filter(e=>this.selected.file?e.fileOption===!0:e.folderOption===!0).filter(e=>!(e.id==="zip"&&this.agent.language!=="powershell")).filter(e=>{if(e.id==="open"){if(this.open.find(t=>t===this.selected.id))return!1}else if((e.id==="close"||e.id==="refresh")&&!this.open.find(t=>t===this.selected.id))return!1;return!0})}},watch:{agent:{handler(){this.initialize()}}},async mounted(){this.agent&&this.initialize()},methods:{async initialize(){this.debouncedLoadChildren=Gi(this.loadChildren,500,{leading:!0}),this.loading=!0;try{const e=await it(this.agent.session_id,"/");e.sort(this.sortFiles),this.tree=e.map(t=>this.transform(t))}catch{if(this.readOnly){this.loading=!1;return}const t=await this.scrapeDirectory("/");let n=0,s=0;for(;n<10;){if(await Dt(6e3),await this.checkTaskComplete(t.id)){s=!0;break}n++}s||this.$snack.error("Agent didn't respond in time. Please try again later.");const i=await it(this.agent.session_id,"/");i.sort(this.sortFiles),this.tree=i.map(a=>this.transform(a))}this.loading=!1},async clickAction(e){if(e==="open")this.open.push(this.selected.id);else if(e==="close")this.open.splice(this.open.findIndex(t=>t===this.selected.id),1);else if(e==="refresh"){this.selected.children=[];const t=this.$refs.treeview.nodes[this.selected.id];this.open.splice(this.open.findIndex(n=>n===this.selected.id),1),await Se.nextTick(),t.vnode.hasLoaded=!1,this.force[this.selected.id]=!0,await Se.nextTick(),this.open.push(this.selected.id)}else e==="download"?(Cn(this.agent.session_id,this.selected.path),this.$snack.success(`Tasked ${this.agent.session_id} for download ${this.selected.path}`)):e==="zip"?this.prepareZip():e==="upload"&&this.$emit("openUploadDialog",{pathToFile:this.selected.path})},prepareZip(){const e={agent:this.agent.session_id,Folder:this.selected.path,ZipFileName:`${this.selected.path}\\${this.selected.path.split("\\").pop()}.zip`};this.moduleName="powershell/management/zipfolder",this.moduleOptionDefaults=e,this.executeDialog=!0},show(e,t){t.preventDefault(),this.showMenu=!1,this.menuPosition.x=t.clientX,this.menuPosition.y=t.clientY,this.selected=e,this.$nextTick(()=>{this.showMenu=!0})},transform(e){return{file:e.is_file===!0?e.name.split(".").pop():!1,...e,children:e.is_file===!1?[]:void 0}},async loadChildren(e,{stopTrying:t}={}){if(this.currentlyLoading[e.id])return Promise.resolve();this.currentlyLoading[e.id]=!0;const n=await it(this.agent.session_id,e.id);if(n.sort(this.sortFiles),!this.force[e.id]&&n.length>0)return this.removeFromCurrentlyLoading(e.id),e.children=n.map(s=>this.transform(s)),Promise.resolve();if(!t&&!this.readOnly){console.log(t,this.readOnly),this.$snack.success(`Attempting to retrieve directory: ${e.path} with id ${e.id}`);const s=await this.scrapeDirectory(e.path);let i=0,a=!1;for(;i<10;){if(await Dt(6e3),await this.checkTaskComplete(s.id)){console.log("task complete",s.id),a=!0;break}i++}return a||this.$snack.error("Agent didn't respond in time. Please try again later."),this.removeFromForce(e.id),this.removeFromCurrentlyLoading(e.id),Promise.resolve(this.loadChildren(e,{stopTrying:!0}))}return this.removeFromForce(e.id),this.removeFromCurrentlyLoading(e.id),Promise.resolve()},removeFromForce(e){this.force[e]&&delete this.force[e]},removeFromCurrentlyLoading(e){this.currentlyLoading[e]&&delete this.currentlyLoading[e]},async scrapeDirectory(e){return Ti(this.agent.session_id,e)},async checkTaskComplete(e){try{return!!(await vn(this.agent.session_id,e)).output}catch{return!1}},sortFiles(e,t){const n=e.name.toLowerCase(),s=t.name.toLowerCase();return n<s?-1:n>s?1:0}}};var Br=function(){var t=this,n=t._self._c;return n("div",[n(Tn,{attrs:{agent:t.agent.session_id,"module-name":t.moduleName,"module-option-defaults":t.moduleOptionDefaults},model:{value:t.executeDialog,callback:function(s){t.executeDialog=s},expression:"executeDialog"}}),t.loading?n(W,{staticClass:"fa-3x fas fa-spinner fa-spin",staticStyle:{width:"50px"}}):t._e(),n(Ji,{ref:"treeview",attrs:{dense:"",hoverable:"","open-on-click":"","item-key":"id","load-children":t.debouncedLoadChildren,open:t.open,items:t.tree},on:{"update:open":function(s){t.open=s}},scopedSlots:t._u([{key:"label",fn:function({item:s,open:i}){return[n(Y,{staticClass:"text-left",staticStyle:{"margin-left":"-15px",width:"100%"},attrs:{text:""},on:{contextmenu:function(a){return t.show(s,a)}}},[n("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[s.file?n(W,[t._v(" "+t._s(t.files[s.file]||"mdi-file")+" ")]):n(W,[t._v(" "+t._s(i?"mdi-folder-open":"mdi-folder")+" ")]),n("span",{staticClass:"ml-2"},[t._v(t._s(s.name))])],1)])]}}])}),n(gn,{attrs:{"position-x":t.menuPosition.x,"position-y":t.menuPosition.y,"close-on-content-click":"",absolute:"","offset-y":""},model:{value:t.showMenu,callback:function(s){t.showMenu=s},expression:"showMenu"}},[n(ji,t._l(t.menuItems,function(s){return n(Ri,{key:s.id,on:{click:function(i){return t.clickAction(s.id)}}},[n(Li,[t._v(t._s(s.name))])],1)}),1)],1)],1)},xr=[],Pr=X(Sr,Br,xr,!1,null,null,null,null);const jn=Pr.exports;var gt={},Le={},fe={},me={},$t={exports:{}},Mr=({onlyFirst:e=!1}={})=>{const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")};const Ar=Mr;var St=e=>typeof e=="string"?e.replace(Ar(),""):e,Bt={exports:{}};const Rn=e=>Number.isNaN(e)?!1:e>=4352&&(e<=4447||e===9001||e===9002||11904<=e&&e<=12871&&e!==12351||12880<=e&&e<=19903||19968<=e&&e<=42182||43360<=e&&e<=43388||44032<=e&&e<=55203||63744<=e&&e<=64255||65040<=e&&e<=65049||65072<=e&&e<=65131||65281<=e&&e<=65376||65504<=e&&e<=65510||110592<=e&&e<=110593||127488<=e&&e<=127569||131072<=e&&e<=262141);Bt.exports=Rn;Bt.exports.default=Rn;var Ln=Bt.exports,Tr=function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F|\uD83D\uDC68(?:\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68\uD83C\uDFFB|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|[\u2695\u2696\u2708]\uFE0F|\uD83D[\uDC66\uDC67]|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708])\uFE0F|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C[\uDFFB-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)\uD83C\uDFFB|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB\uDFFC])|\uD83D\uDC69(?:\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFD])|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83C\uDFF4\u200D\u2620)\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDF6\uD83C\uDDE6|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDBB\uDDD2-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5\uDEEB\uDEEC\uDEF4-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])\uFE0F|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])/g};const jr=St,Rr=Ln,Lr=Tr,On=e=>{if(typeof e!="string"||e.length===0||(e=jr(e),e.length===0))return 0;e=e.replace(Lr(),"  ");let t=0;for(let n=0;n<e.length;n++){const s=e.codePointAt(n);s<=31||s>=127&&s<=159||s>=768&&s<=879||(s>65535&&n++,t+=Rr(s)?2:1)}return t};$t.exports=On;$t.exports.default=On;var De=$t.exports,q={};const Xt="[\uD800-\uDBFF][\uDC00-\uDFFF]",Or=e=>e&&e.exact?new RegExp(`^${Xt}$`):new RegExp(Xt,"g");var zr=Or,xt={exports:{}},at,Qt;function Nr(){return Qt||(Qt=1,at={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),at}var ot,en;function zn(){if(en)return ot;en=1;const e=Nr(),t={};for(const i of Object.keys(e))t[e[i]]=i;const n={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};ot=n;for(const i of Object.keys(n)){if(!("channels"in n[i]))throw new Error("missing channels property: "+i);if(!("labels"in n[i]))throw new Error("missing channel labels property: "+i);if(n[i].labels.length!==n[i].channels)throw new Error("channel and label counts mismatch: "+i);const{channels:a,labels:o}=n[i];delete n[i].channels,delete n[i].labels,Object.defineProperty(n[i],"channels",{value:a}),Object.defineProperty(n[i],"labels",{value:o})}n.rgb.hsl=function(i){const a=i[0]/255,o=i[1]/255,u=i[2]/255,c=Math.min(a,o,u),d=Math.max(a,o,u),p=d-c;let f,g;d===c?f=0:a===d?f=(o-u)/p:o===d?f=2+(u-a)/p:u===d&&(f=4+(a-o)/p),f=Math.min(f*60,360),f<0&&(f+=360);const b=(c+d)/2;return d===c?g=0:b<=.5?g=p/(d+c):g=p/(2-d-c),[f,g*100,b*100]},n.rgb.hsv=function(i){let a,o,u,c,d;const p=i[0]/255,f=i[1]/255,g=i[2]/255,b=Math.max(p,f,g),w=b-Math.min(p,f,g),S=function(x){return(b-x)/6/w+1/2};return w===0?(c=0,d=0):(d=w/b,a=S(p),o=S(f),u=S(g),p===b?c=u-o:f===b?c=1/3+a-u:g===b&&(c=2/3+o-a),c<0?c+=1:c>1&&(c-=1)),[c*360,d*100,b*100]},n.rgb.hwb=function(i){const a=i[0],o=i[1];let u=i[2];const c=n.rgb.hsl(i)[0],d=1/255*Math.min(a,Math.min(o,u));return u=1-1/255*Math.max(a,Math.max(o,u)),[c,d*100,u*100]},n.rgb.cmyk=function(i){const a=i[0]/255,o=i[1]/255,u=i[2]/255,c=Math.min(1-a,1-o,1-u),d=(1-a-c)/(1-c)||0,p=(1-o-c)/(1-c)||0,f=(1-u-c)/(1-c)||0;return[d*100,p*100,f*100,c*100]};function s(i,a){return(i[0]-a[0])**2+(i[1]-a[1])**2+(i[2]-a[2])**2}return n.rgb.keyword=function(i){const a=t[i];if(a)return a;let o=1/0,u;for(const c of Object.keys(e)){const d=e[c],p=s(i,d);p<o&&(o=p,u=c)}return u},n.keyword.rgb=function(i){return e[i]},n.rgb.xyz=function(i){let a=i[0]/255,o=i[1]/255,u=i[2]/255;a=a>.04045?((a+.055)/1.055)**2.4:a/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92,u=u>.04045?((u+.055)/1.055)**2.4:u/12.92;const c=a*.4124+o*.3576+u*.1805,d=a*.2126+o*.7152+u*.0722,p=a*.0193+o*.1192+u*.9505;return[c*100,d*100,p*100]},n.rgb.lab=function(i){const a=n.rgb.xyz(i);let o=a[0],u=a[1],c=a[2];o/=95.047,u/=100,c/=108.883,o=o>.008856?o**(1/3):7.787*o+16/116,u=u>.008856?u**(1/3):7.787*u+16/116,c=c>.008856?c**(1/3):7.787*c+16/116;const d=116*u-16,p=500*(o-u),f=200*(u-c);return[d,p,f]},n.hsl.rgb=function(i){const a=i[0]/360,o=i[1]/100,u=i[2]/100;let c,d,p;if(o===0)return p=u*255,[p,p,p];u<.5?c=u*(1+o):c=u+o-u*o;const f=2*u-c,g=[0,0,0];for(let b=0;b<3;b++)d=a+1/3*-(b-1),d<0&&d++,d>1&&d--,6*d<1?p=f+(c-f)*6*d:2*d<1?p=c:3*d<2?p=f+(c-f)*(2/3-d)*6:p=f,g[b]=p*255;return g},n.hsl.hsv=function(i){const a=i[0];let o=i[1]/100,u=i[2]/100,c=o;const d=Math.max(u,.01);u*=2,o*=u<=1?u:2-u,c*=d<=1?d:2-d;const p=(u+o)/2,f=u===0?2*c/(d+c):2*o/(u+o);return[a,f*100,p*100]},n.hsv.rgb=function(i){const a=i[0]/60,o=i[1]/100;let u=i[2]/100;const c=Math.floor(a)%6,d=a-Math.floor(a),p=255*u*(1-o),f=255*u*(1-o*d),g=255*u*(1-o*(1-d));switch(u*=255,c){case 0:return[u,g,p];case 1:return[f,u,p];case 2:return[p,u,g];case 3:return[p,f,u];case 4:return[g,p,u];case 5:return[u,p,f]}},n.hsv.hsl=function(i){const a=i[0],o=i[1]/100,u=i[2]/100,c=Math.max(u,.01);let d,p;p=(2-o)*u;const f=(2-o)*c;return d=o*c,d/=f<=1?f:2-f,d=d||0,p/=2,[a,d*100,p*100]},n.hwb.rgb=function(i){const a=i[0]/360;let o=i[1]/100,u=i[2]/100;const c=o+u;let d;c>1&&(o/=c,u/=c);const p=Math.floor(6*a),f=1-u;d=6*a-p,p&1&&(d=1-d);const g=o+d*(f-o);let b,w,S;switch(p){default:case 6:case 0:b=f,w=g,S=o;break;case 1:b=g,w=f,S=o;break;case 2:b=o,w=f,S=g;break;case 3:b=o,w=g,S=f;break;case 4:b=g,w=o,S=f;break;case 5:b=f,w=o,S=g;break}return[b*255,w*255,S*255]},n.cmyk.rgb=function(i){const a=i[0]/100,o=i[1]/100,u=i[2]/100,c=i[3]/100,d=1-Math.min(1,a*(1-c)+c),p=1-Math.min(1,o*(1-c)+c),f=1-Math.min(1,u*(1-c)+c);return[d*255,p*255,f*255]},n.xyz.rgb=function(i){const a=i[0]/100,o=i[1]/100,u=i[2]/100;let c,d,p;return c=a*3.2406+o*-1.5372+u*-.4986,d=a*-.9689+o*1.8758+u*.0415,p=a*.0557+o*-.204+u*1.057,c=c>.0031308?1.055*c**(1/2.4)-.055:c*12.92,d=d>.0031308?1.055*d**(1/2.4)-.055:d*12.92,p=p>.0031308?1.055*p**(1/2.4)-.055:p*12.92,c=Math.min(Math.max(0,c),1),d=Math.min(Math.max(0,d),1),p=Math.min(Math.max(0,p),1),[c*255,d*255,p*255]},n.xyz.lab=function(i){let a=i[0],o=i[1],u=i[2];a/=95.047,o/=100,u/=108.883,a=a>.008856?a**(1/3):7.787*a+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,u=u>.008856?u**(1/3):7.787*u+16/116;const c=116*o-16,d=500*(a-o),p=200*(o-u);return[c,d,p]},n.lab.xyz=function(i){const a=i[0],o=i[1],u=i[2];let c,d,p;d=(a+16)/116,c=o/500+d,p=d-u/200;const f=d**3,g=c**3,b=p**3;return d=f>.008856?f:(d-16/116)/7.787,c=g>.008856?g:(c-16/116)/7.787,p=b>.008856?b:(p-16/116)/7.787,c*=95.047,d*=100,p*=108.883,[c,d,p]},n.lab.lch=function(i){const a=i[0],o=i[1],u=i[2];let c;c=Math.atan2(u,o)*360/2/Math.PI,c<0&&(c+=360);const p=Math.sqrt(o*o+u*u);return[a,p,c]},n.lch.lab=function(i){const a=i[0],o=i[1],c=i[2]/360*2*Math.PI,d=o*Math.cos(c),p=o*Math.sin(c);return[a,d,p]},n.rgb.ansi16=function(i,a=null){const[o,u,c]=i;let d=a===null?n.rgb.hsv(i)[2]:a;if(d=Math.round(d/50),d===0)return 30;let p=30+(Math.round(c/255)<<2|Math.round(u/255)<<1|Math.round(o/255));return d===2&&(p+=60),p},n.hsv.ansi16=function(i){return n.rgb.ansi16(n.hsv.rgb(i),i[2])},n.rgb.ansi256=function(i){const a=i[0],o=i[1],u=i[2];return a===o&&o===u?a<8?16:a>248?231:Math.round((a-8)/247*24)+232:16+36*Math.round(a/255*5)+6*Math.round(o/255*5)+Math.round(u/255*5)},n.ansi16.rgb=function(i){let a=i%10;if(a===0||a===7)return i>50&&(a+=3.5),a=a/10.5*255,[a,a,a];const o=(~~(i>50)+1)*.5,u=(a&1)*o*255,c=(a>>1&1)*o*255,d=(a>>2&1)*o*255;return[u,c,d]},n.ansi256.rgb=function(i){if(i>=232){const d=(i-232)*10+8;return[d,d,d]}i-=16;let a;const o=Math.floor(i/36)/5*255,u=Math.floor((a=i%36)/6)/5*255,c=a%6/5*255;return[o,u,c]},n.rgb.hex=function(i){const o=(((Math.round(i[0])&255)<<16)+((Math.round(i[1])&255)<<8)+(Math.round(i[2])&255)).toString(16).toUpperCase();return"000000".substring(o.length)+o},n.hex.rgb=function(i){const a=i.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!a)return[0,0,0];let o=a[0];a[0].length===3&&(o=o.split("").map(f=>f+f).join(""));const u=parseInt(o,16),c=u>>16&255,d=u>>8&255,p=u&255;return[c,d,p]},n.rgb.hcg=function(i){const a=i[0]/255,o=i[1]/255,u=i[2]/255,c=Math.max(Math.max(a,o),u),d=Math.min(Math.min(a,o),u),p=c-d;let f,g;return p<1?f=d/(1-p):f=0,p<=0?g=0:c===a?g=(o-u)/p%6:c===o?g=2+(u-a)/p:g=4+(a-o)/p,g/=6,g%=1,[g*360,p*100,f*100]},n.hsl.hcg=function(i){const a=i[1]/100,o=i[2]/100,u=o<.5?2*a*o:2*a*(1-o);let c=0;return u<1&&(c=(o-.5*u)/(1-u)),[i[0],u*100,c*100]},n.hsv.hcg=function(i){const a=i[1]/100,o=i[2]/100,u=a*o;let c=0;return u<1&&(c=(o-u)/(1-u)),[i[0],u*100,c*100]},n.hcg.rgb=function(i){const a=i[0]/360,o=i[1]/100,u=i[2]/100;if(o===0)return[u*255,u*255,u*255];const c=[0,0,0],d=a%1*6,p=d%1,f=1-p;let g=0;switch(Math.floor(d)){case 0:c[0]=1,c[1]=p,c[2]=0;break;case 1:c[0]=f,c[1]=1,c[2]=0;break;case 2:c[0]=0,c[1]=1,c[2]=p;break;case 3:c[0]=0,c[1]=f,c[2]=1;break;case 4:c[0]=p,c[1]=0,c[2]=1;break;default:c[0]=1,c[1]=0,c[2]=f}return g=(1-o)*u,[(o*c[0]+g)*255,(o*c[1]+g)*255,(o*c[2]+g)*255]},n.hcg.hsv=function(i){const a=i[1]/100,o=i[2]/100,u=a+o*(1-a);let c=0;return u>0&&(c=a/u),[i[0],c*100,u*100]},n.hcg.hsl=function(i){const a=i[1]/100,u=i[2]/100*(1-a)+.5*a;let c=0;return u>0&&u<.5?c=a/(2*u):u>=.5&&u<1&&(c=a/(2*(1-u))),[i[0],c*100,u*100]},n.hcg.hwb=function(i){const a=i[1]/100,o=i[2]/100,u=a+o*(1-a);return[i[0],(u-a)*100,(1-u)*100]},n.hwb.hcg=function(i){const a=i[1]/100,u=1-i[2]/100,c=u-a;let d=0;return c<1&&(d=(u-c)/(1-c)),[i[0],c*100,d*100]},n.apple.rgb=function(i){return[i[0]/65535*255,i[1]/65535*255,i[2]/65535*255]},n.rgb.apple=function(i){return[i[0]/255*65535,i[1]/255*65535,i[2]/255*65535]},n.gray.rgb=function(i){return[i[0]/100*255,i[0]/100*255,i[0]/100*255]},n.gray.hsl=function(i){return[0,0,i[0]]},n.gray.hsv=n.gray.hsl,n.gray.hwb=function(i){return[0,100,i[0]]},n.gray.cmyk=function(i){return[0,0,0,i[0]]},n.gray.lab=function(i){return[i[0],0,0]},n.gray.hex=function(i){const a=Math.round(i[0]/100*255)&255,u=((a<<16)+(a<<8)+a).toString(16).toUpperCase();return"000000".substring(u.length)+u},n.rgb.gray=function(i){return[(i[0]+i[1]+i[2])/3/255*100]},ot}var lt,tn;function Ir(){if(tn)return lt;tn=1;const e=zn();function t(){const a={},o=Object.keys(e);for(let u=o.length,c=0;c<u;c++)a[o[c]]={distance:-1,parent:null};return a}function n(a){const o=t(),u=[a];for(o[a].distance=0;u.length;){const c=u.pop(),d=Object.keys(e[c]);for(let p=d.length,f=0;f<p;f++){const g=d[f],b=o[g];b.distance===-1&&(b.distance=o[c].distance+1,b.parent=c,u.unshift(g))}}return o}function s(a,o){return function(u){return o(a(u))}}function i(a,o){const u=[o[a].parent,a];let c=e[o[a].parent][a],d=o[a].parent;for(;o[d].parent;)u.unshift(o[d].parent),c=s(e[o[d].parent][d],c),d=o[d].parent;return c.conversion=u,c}return lt=function(a){const o=n(a),u={},c=Object.keys(o);for(let d=c.length,p=0;p<d;p++){const f=c[p];o[f].parent!==null&&(u[f]=i(f,o))}return u},lt}var ut,nn;function qr(){if(nn)return ut;nn=1;const e=zn(),t=Ir(),n={},s=Object.keys(e);function i(o){const u=function(...c){const d=c[0];return d==null?d:(d.length>1&&(c=d),o(c))};return"conversion"in o&&(u.conversion=o.conversion),u}function a(o){const u=function(...c){const d=c[0];if(d==null)return d;d.length>1&&(c=d);const p=o(c);if(typeof p=="object")for(let f=p.length,g=0;g<f;g++)p[g]=Math.round(p[g]);return p};return"conversion"in o&&(u.conversion=o.conversion),u}return s.forEach(o=>{n[o]={},Object.defineProperty(n[o],"channels",{value:e[o].channels}),Object.defineProperty(n[o],"labels",{value:e[o].labels});const u=t(o);Object.keys(u).forEach(d=>{const p=u[d];n[o][d]=a(p),n[o][d].raw=i(p)})}),ut=n,ut}xt.exports;(function(e){const t=(p,f)=>(...g)=>`\x1B[${p(...g)+f}m`,n=(p,f)=>(...g)=>{const b=p(...g);return`\x1B[${38+f};5;${b}m`},s=(p,f)=>(...g)=>{const b=p(...g);return`\x1B[${38+f};2;${b[0]};${b[1]};${b[2]}m`},i=p=>p,a=(p,f,g)=>[p,f,g],o=(p,f,g)=>{Object.defineProperty(p,f,{get:()=>{const b=g();return Object.defineProperty(p,f,{value:b,enumerable:!0,configurable:!0}),b},enumerable:!0,configurable:!0})};let u;const c=(p,f,g,b)=>{u===void 0&&(u=qr());const w=b?10:0,S={};for(const[x,T]of Object.entries(u)){const j=x==="ansi16"?"ansi":x;x===f?S[j]=p(g,w):typeof T=="object"&&(S[j]=p(T[f],w))}return S};function d(){const p=new Map,f={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};f.color.gray=f.color.blackBright,f.bgColor.bgGray=f.bgColor.bgBlackBright,f.color.grey=f.color.blackBright,f.bgColor.bgGrey=f.bgColor.bgBlackBright;for(const[g,b]of Object.entries(f)){for(const[w,S]of Object.entries(b))f[w]={open:`\x1B[${S[0]}m`,close:`\x1B[${S[1]}m`},b[w]=f[w],p.set(S[0],S[1]);Object.defineProperty(f,g,{value:b,enumerable:!1})}return Object.defineProperty(f,"codes",{value:p,enumerable:!1}),f.color.close="\x1B[39m",f.bgColor.close="\x1B[49m",o(f.color,"ansi",()=>c(t,"ansi16",i,!1)),o(f.color,"ansi256",()=>c(n,"ansi256",i,!1)),o(f.color,"ansi16m",()=>c(s,"rgb",a,!1)),o(f.bgColor,"ansi",()=>c(t,"ansi16",i,!0)),o(f.bgColor,"ansi256",()=>c(n,"ansi256",i,!0)),o(f.bgColor,"ansi16m",()=>c(s,"rgb",a,!0)),f}Object.defineProperty(e,"exports",{enumerable:!0,get:d})})(xt);var Hr=xt.exports;const Vr=Ln,Wr=zr,rn=Hr,Nn=["\x1B",""],ke=e=>`${Nn[0]}[${e}m`,sn=(e,t,n)=>{let s=[];e=[...e];for(let i of e){const a=i;i.includes(";")&&(i=i.split(";")[0][0]+"0");const o=rn.codes.get(Number.parseInt(i,10));if(o){const u=e.indexOf(o.toString());u===-1?s.push(ke(t?o:a)):e.splice(u,1)}else if(t){s.push(ke(0));break}else s.push(ke(a))}if(t&&(s=s.filter((i,a)=>s.indexOf(i)===a),n!==void 0)){const i=ke(rn.codes.get(Number.parseInt(n,10)));s=s.reduce((a,o)=>o===i?[o,...a]:[...a,o],[])}return s.join("")};var Pt=(e,t,n)=>{const s=[...e],i=[];let a=typeof n=="number"?n:s.length,o=!1,u,c=0,d="";for(const[p,f]of s.entries()){let g=!1;if(Nn.includes(f)){const b=/\d[^m]*/.exec(e.slice(p,p+18));u=b&&b.length>0?b[0]:void 0,c<a&&(o=!0,u!==void 0&&i.push(u))}else o&&f==="m"&&(o=!1,g=!0);if(!o&&!g&&c++,!Wr({exact:!0}).test(f)&&Vr(f.codePointAt())&&(c++,typeof n!="number"&&a++),c>t&&c<=a)d+=f;else if(c===t&&!o&&u!==void 0)d=sn(i);else if(c>=a){d+=sn(i,!0,u);break}}return d},ge={};Object.defineProperty(ge,"__esModule",{value:!0});ge.getBorderCharacters=void 0;const Ur=e=>{if(e==="honeywell")return{topBody:"═",topJoin:"╤",topLeft:"╔",topRight:"╗",bottomBody:"═",bottomJoin:"╧",bottomLeft:"╚",bottomRight:"╝",bodyLeft:"║",bodyRight:"║",bodyJoin:"│",headerJoin:"┬",joinBody:"─",joinLeft:"╟",joinRight:"╢",joinJoin:"┼",joinMiddleDown:"┬",joinMiddleUp:"┴",joinMiddleLeft:"┤",joinMiddleRight:"├"};if(e==="norc")return{topBody:"─",topJoin:"┬",topLeft:"┌",topRight:"┐",bottomBody:"─",bottomJoin:"┴",bottomLeft:"└",bottomRight:"┘",bodyLeft:"│",bodyRight:"│",bodyJoin:"│",headerJoin:"┬",joinBody:"─",joinLeft:"├",joinRight:"┤",joinJoin:"┼",joinMiddleDown:"┬",joinMiddleUp:"┴",joinMiddleLeft:"┤",joinMiddleRight:"├"};if(e==="ramac")return{topBody:"-",topJoin:"+",topLeft:"+",topRight:"+",bottomBody:"-",bottomJoin:"+",bottomLeft:"+",bottomRight:"+",bodyLeft:"|",bodyRight:"|",bodyJoin:"|",headerJoin:"+",joinBody:"-",joinLeft:"|",joinRight:"|",joinJoin:"|",joinMiddleDown:"+",joinMiddleUp:"+",joinMiddleLeft:"+",joinMiddleRight:"+"};if(e==="void")return{topBody:"",topJoin:"",topLeft:"",topRight:"",bottomBody:"",bottomJoin:"",bottomLeft:"",bottomRight:"",bodyLeft:"",bodyRight:"",bodyJoin:"",headerJoin:"",joinBody:"",joinLeft:"",joinRight:"",joinJoin:"",joinMiddleDown:"",joinMiddleUp:"",joinMiddleLeft:"",joinMiddleRight:""};throw new Error('Unknown border template "'+e+'".')};ge.getBorderCharacters=Ur;(function(e){var t=O&&O.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(e,"__esModule",{value:!0}),e.isCellInRange=e.areCellEqual=e.calculateRangeCoordinate=e.findOriginalRowIndex=e.flatten=e.extractTruncates=e.sumArray=e.sequence=e.distributeUnevenly=e.countSpaceSequence=e.groupBySizes=e.makeBorderConfig=e.splitAnsi=e.normalizeString=void 0;const n=t(Pt),s=t(De),i=t(St),a=ge,o=F=>F.replace(/\r\n/g,`
`);e.normalizeString=o;const u=F=>{const l=(0,i.default)(F).split(`
`).map(s.default),m=[];let M=0;return l.forEach(A=>{m.push(A===0?"":(0,n.default)(F,M,M+A)),M+=A+1}),m};e.splitAnsi=u;const c=F=>({...(0,a.getBorderCharacters)("honeywell"),...F});e.makeBorderConfig=c;const d=(F,l)=>{let m=0;return l.map(M=>{const A=F.slice(m,m+M);return m+=M,A})};e.groupBySizes=d;const p=F=>{var l,m;return(m=(l=F.match(/\s+/g))===null||l===void 0?void 0:l.length)!==null&&m!==void 0?m:0};e.countSpaceSequence=p;const f=(F,l)=>Array.from({length:l}).fill(Math.floor(F/l)).map((M,A)=>M+(A<F%l?1:0));e.distributeUnevenly=f;const g=(F,l)=>Array.from({length:l-F+1},(m,M)=>M+F);e.sequence=g;const b=F=>F.reduce((l,m)=>l+m,0);e.sumArray=b;const w=F=>F.columns.map(({truncate:l})=>l);e.extractTruncates=w;const S=F=>[].concat(...F);e.flatten=S;const x=(F,l)=>(0,e.flatten)(F.map((M,A)=>Array.from({length:M},()=>A)))[l];e.findOriginalRowIndex=x;const T=F=>{const{row:l,col:m,colSpan:M=1,rowSpan:A=1}=F;return{bottomRight:{col:m+M-1,row:l+A-1},topLeft:{col:m,row:l}}};e.calculateRangeCoordinate=T;const j=(F,l)=>F.row===l.row&&F.col===l.col;e.areCellEqual=j;const H=(F,{topLeft:l,bottomRight:m})=>l.row<=F.row&&F.row<=m.row&&l.col<=F.col&&F.col<=m.col;e.isCellInRange=H})(q);var Yr=O&&O.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(me,"__esModule",{value:!0});me.alignString=void 0;const Jr=Yr(De),an=q,yt=(e,t)=>e+" ".repeat(t),Gr=(e,t)=>" ".repeat(t)+e,Zr=(e,t)=>" ".repeat(Math.floor(t/2))+e+" ".repeat(Math.ceil(t/2)),Kr=(e,t)=>{const n=(0,an.countSpaceSequence)(e);if(n===0)return yt(e,t);const s=(0,an.distributeUnevenly)(t,n);if(Math.max(...s)>3)return yt(e,t);let i=0;return e.replace(/\s+/g,a=>a+" ".repeat(s[i++]))},Xr=(e,t,n)=>{const s=(0,Jr.default)(e);if(s===t)return e;if(s>t)throw new Error("Subject parameter value width cannot be greater than the container width.");if(s===0)return" ".repeat(t);const i=t-s;return n==="left"?yt(e,i):n==="right"?Gr(e,i):n==="justify"?Kr(e,i):Zr(e,i)};me.alignString=Xr;Object.defineProperty(fe,"__esModule",{value:!0});fe.alignTableData=void 0;const Qr=me,es=(e,t)=>e.map((n,s)=>n.map((i,a)=>{var o;const{width:u,alignment:c}=t.columns[a];return((o=t.spanningCellManager)===null||o===void 0?void 0:o.getContainingRange({col:a,row:s},{mapped:!0}))?i:(0,Qr.alignString)(i,u,c)}));fe.alignTableData=es;var ye={},Oe={},oe={},ze={},In=O&&O.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ze,"__esModule",{value:!0});ze.wrapString=void 0;const on=In(Pt),ts=In(De),ns=(e,t)=>{let n=e;const s=[];do s.push((0,on.default)(n,0,t)),n=(0,on.default)(n,t).trim();while((0,ts.default)(n));return s};ze.wrapString=ns;var Ne={},qn=O&&O.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ne,"__esModule",{value:!0});Ne.wrapWord=void 0;const is=qn(Pt),rs=qn(St),ss=(e,t)=>{let n=(0,rs.default)(e);const s=[],i=new RegExp("(^.{1,"+String(Math.max(t,1))+"}(\\s+|$))|(^.{1,"+String(Math.max(t-1,1))+"}(\\\\|/|_|\\.|,|;|-))");do{let a;const o=i.exec(n);if(o){a=o[0],n=n.slice(a.length);const u=a.trim().length,c=a.length-u;s.push([u,c])}else a=n.slice(0,t),n=n.slice(t),s.push([a.length,0])}while(n.length);return s},as=(e,t)=>{const n=[];let s=0;return ss(e,t).forEach(([i,a])=>{n.push((0,is.default)(e,s,s+i)),s+=i+a}),n};Ne.wrapWord=as;Object.defineProperty(oe,"__esModule",{value:!0});oe.wrapCell=void 0;const os=q,ls=ze,us=Ne,cs=(e,t,n)=>{const s=(0,os.splitAnsi)(e);for(let i=0;i<s.length;){let a;n?a=(0,us.wrapWord)(s[i],t):a=(0,ls.wrapString)(s[i],t),s.splice(i,1,...a),i+=a.length}return s};oe.wrapCell=cs;Object.defineProperty(Oe,"__esModule",{value:!0});Oe.calculateCellHeight=void 0;const ds=oe,hs=(e,t,n=!1)=>(0,ds.wrapCell)(e,t,n).length;Oe.calculateCellHeight=hs;Object.defineProperty(ye,"__esModule",{value:!0});ye.calculateRowHeights=void 0;const ps=Oe,ln=q,fs=(e,t)=>{const n=[];for(const[s,i]of e.entries()){let a=1;i.forEach((o,u)=>{var c;const d=(c=t.spanningCellManager)===null||c===void 0?void 0:c.getContainingRange({col:u,row:s});if(!d){const b=(0,ps.calculateCellHeight)(o,t.columns[u].width,t.columns[u].wrapWord);a=Math.max(a,b);return}const{topLeft:p,bottomRight:f,height:g}=d;if(s===f.row){const b=(0,ln.sumArray)(n.slice(p.row)),w=f.row-p.row,S=(0,ln.sequence)(p.row+1,f.row).filter(T=>{var j;return!(!((j=t.drawHorizontalLine)===null||j===void 0)&&j.call(t,T,e.length))}).length,x=g-b-w+S;a=Math.max(a,x)}}),n.push(a)}return n};ye.calculateRowHeights=fs;var Mt={},le={};Object.defineProperty(le,"__esModule",{value:!0});le.drawContent=void 0;const ms=e=>{const{contents:t,separatorGetter:n,drawSeparator:s,spanningCellManager:i,rowIndex:a,elementType:o}=e,u=t.length,c=[];return s(0,u)&&c.push(n(0,u)),t.forEach((d,p)=>{if((!o||o==="border"||o==="row")&&c.push(d),o==="cell"&&a===void 0&&c.push(d),o==="cell"&&a!==void 0){const f=i==null?void 0:i.getContainingRange({col:p,row:a});(!f||p===f.topLeft.col)&&c.push(d)}if(p+1<u&&s(p+1,u)){const f=n(p+1,u);if(o==="cell"&&a!==void 0){const g={col:p+1,row:a},b=i==null?void 0:i.getContainingRange(g);(!b||b.topLeft.col===g.col)&&c.push(f)}else c.push(f)}}),s(u,u)&&c.push(n(u,u)),c.join("")};le.drawContent=ms;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createTableBorderGetter=e.drawBorderBottom=e.drawBorderJoin=e.drawBorderTop=e.drawBorder=e.createSeparatorGetter=e.drawBorderSegments=void 0;const t=le,n=(d,p)=>{const{separator:f,horizontalBorderIndex:g,spanningCellManager:b}=p;return d.map((w,S)=>{const x=f.body.repeat(w);if(g===void 0)return x;const T=b==null?void 0:b.getContainingRange({col:S,row:g});if(!T)return x;const{topLeft:j}=T;return g===j.row?x:S!==j.col?"":T.extractBorderContent(g)})};e.drawBorderSegments=n;const s=d=>{const{separator:p,spanningCellManager:f,horizontalBorderIndex:g,rowCount:b}=d;return(w,S)=>{const x=f==null?void 0:f.inSameRange;if(g!==void 0&&x){const T={col:w,row:g-1},j={col:w-1,row:g},H={col:w-1,row:g-1},F={col:w,row:g},l=[[H,T],[T,F],[F,j],[j,H]];if(w===0)return x(F,T)&&p.bodyJoinOuter?p.bodyJoinOuter:p.left;if(w===S)return x(H,j)&&p.bodyJoinOuter?p.bodyJoinOuter:p.right;if(g===0)return x(F,j)?p.body:p.join;if(g===b)return x(T,H)?p.body:p.join;const m=l.map(M=>x(...M)).filter(Boolean).length;if(m===0)return p.join;if(m===4)return"";if(m===2)return x(...l[1])&&x(...l[3])&&p.bodyJoinInner?p.bodyJoinInner:p.body;if(m===1){if(!p.joinRight||!p.joinLeft||!p.joinUp||!p.joinDown)throw new Error(`Can not get border separator for position [${g}, ${w}]`);return x(...l[0])?p.joinDown:x(...l[1])?p.joinLeft:x(...l[2])?p.joinUp:p.joinRight}throw new Error("Invalid case")}return w===0?p.left:w===S?p.right:p.join}};e.createSeparatorGetter=s;const i=(d,p)=>{const f=(0,e.drawBorderSegments)(d,p),{drawVerticalLine:g,horizontalBorderIndex:b,spanningCellManager:w}=p;return(0,t.drawContent)({contents:f,drawSeparator:g,elementType:"border",rowIndex:b,separatorGetter:(0,e.createSeparatorGetter)(p),spanningCellManager:w})+`
`};e.drawBorder=i;const a=(d,p)=>{const{border:f}=p,g=(0,e.drawBorder)(d,{...p,separator:{body:f.topBody,join:f.topJoin,left:f.topLeft,right:f.topRight}});return g===`
`?"":g};e.drawBorderTop=a;const o=(d,p)=>{const{border:f}=p;return(0,e.drawBorder)(d,{...p,separator:{body:f.joinBody,bodyJoinInner:f.bodyJoin,bodyJoinOuter:f.bodyLeft,join:f.joinJoin,joinDown:f.joinMiddleDown,joinLeft:f.joinMiddleLeft,joinRight:f.joinMiddleRight,joinUp:f.joinMiddleUp,left:f.joinLeft,right:f.joinRight}})};e.drawBorderJoin=o;const u=(d,p)=>{const{border:f}=p;return(0,e.drawBorder)(d,{...p,separator:{body:f.bottomBody,join:f.bottomJoin,left:f.bottomLeft,right:f.bottomRight}})};e.drawBorderBottom=u;const c=(d,p)=>(f,g)=>{const b={...p,horizontalBorderIndex:f};return f===0?(0,e.drawBorderTop)(d,b):f===g?(0,e.drawBorderBottom)(d,b):(0,e.drawBorderJoin)(d,b)};e.createTableBorderGetter=c})(Mt);var be={};Object.defineProperty(be,"__esModule",{value:!0});be.drawRow=void 0;const Ds=le,gs=(e,t)=>{const{border:n,drawVerticalLine:s,rowIndex:i,spanningCellManager:a}=t;return(0,Ds.drawContent)({contents:e,drawSeparator:s,elementType:"cell",rowIndex:i,separatorGetter:(o,u)=>o===0?n.bodyLeft:o===u?n.bodyRight:n.bodyJoin,spanningCellManager:a})+`
`};be.drawRow=gs;var Ie={},Ce={},Hn={},At={},ys=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var s,i,a;if(Array.isArray(t)){if(s=t.length,s!=n.length)return!1;for(i=s;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),s=a.length,s!==Object.keys(n).length)return!1;for(i=s;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=s;i--!==0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n};Object.defineProperty(At,"__esModule",{value:!0});const Vn=ys;Vn.code='require("ajv/dist/runtime/equal").default';At.default=Vn;(function(e){e["config.json"]=x;const t={$id:"config.json",$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{border:{$ref:"shared.json#/definitions/borders"},header:{type:"object",properties:{content:{type:"string"},alignment:{$ref:"shared.json#/definitions/alignment"},wrapWord:{type:"boolean"},truncate:{type:"integer"},paddingLeft:{type:"integer"},paddingRight:{type:"integer"}},required:["content"],additionalProperties:!1},columns:{$ref:"shared.json#/definitions/columns"},columnDefault:{$ref:"shared.json#/definitions/column"},drawVerticalLine:{typeof:"function"},drawHorizontalLine:{typeof:"function"},singleLine:{typeof:"boolean"},spanningCells:{type:"array",items:{type:"object",properties:{col:{type:"integer",minimum:0},row:{type:"integer",minimum:0},colSpan:{type:"integer",minimum:1},rowSpan:{type:"integer",minimum:1},alignment:{$ref:"shared.json#/definitions/alignment"},verticalAlignment:{$ref:"shared.json#/definitions/verticalAlignment"},wrapWord:{type:"boolean"},truncate:{type:"integer"},paddingLeft:{type:"integer"},paddingRight:{type:"integer"}},required:["row","col"],additionalProperties:!1}}},additionalProperties:!1},n={type:"object",properties:{topBody:{$ref:"#/definitions/border"},topJoin:{$ref:"#/definitions/border"},topLeft:{$ref:"#/definitions/border"},topRight:{$ref:"#/definitions/border"},bottomBody:{$ref:"#/definitions/border"},bottomJoin:{$ref:"#/definitions/border"},bottomLeft:{$ref:"#/definitions/border"},bottomRight:{$ref:"#/definitions/border"},bodyLeft:{$ref:"#/definitions/border"},bodyRight:{$ref:"#/definitions/border"},bodyJoin:{$ref:"#/definitions/border"},headerJoin:{$ref:"#/definitions/border"},joinBody:{$ref:"#/definitions/border"},joinLeft:{$ref:"#/definitions/border"},joinRight:{$ref:"#/definitions/border"},joinJoin:{$ref:"#/definitions/border"},joinMiddleUp:{$ref:"#/definitions/border"},joinMiddleDown:{$ref:"#/definitions/border"},joinMiddleLeft:{$ref:"#/definitions/border"},joinMiddleRight:{$ref:"#/definitions/border"}},additionalProperties:!1},s=Object.prototype.hasOwnProperty;function i(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(typeof l!="string"){const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"string"},message:"must be string"};r===null?r=[h]:r.push(h),D++}return i.errors=r,D===0}function a(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const h in l)if(!s.call(n.properties,h)){const y={instancePath:m,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"};r===null?r=[y]:r.push(y),D++}l.topBody!==void 0&&(i(l.topBody,{instancePath:m+"/topBody",parentData:l,parentDataProperty:"topBody",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.topJoin!==void 0&&(i(l.topJoin,{instancePath:m+"/topJoin",parentData:l,parentDataProperty:"topJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.topLeft!==void 0&&(i(l.topLeft,{instancePath:m+"/topLeft",parentData:l,parentDataProperty:"topLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.topRight!==void 0&&(i(l.topRight,{instancePath:m+"/topRight",parentData:l,parentDataProperty:"topRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomBody!==void 0&&(i(l.bottomBody,{instancePath:m+"/bottomBody",parentData:l,parentDataProperty:"bottomBody",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomJoin!==void 0&&(i(l.bottomJoin,{instancePath:m+"/bottomJoin",parentData:l,parentDataProperty:"bottomJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomLeft!==void 0&&(i(l.bottomLeft,{instancePath:m+"/bottomLeft",parentData:l,parentDataProperty:"bottomLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomRight!==void 0&&(i(l.bottomRight,{instancePath:m+"/bottomRight",parentData:l,parentDataProperty:"bottomRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bodyLeft!==void 0&&(i(l.bodyLeft,{instancePath:m+"/bodyLeft",parentData:l,parentDataProperty:"bodyLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bodyRight!==void 0&&(i(l.bodyRight,{instancePath:m+"/bodyRight",parentData:l,parentDataProperty:"bodyRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bodyJoin!==void 0&&(i(l.bodyJoin,{instancePath:m+"/bodyJoin",parentData:l,parentDataProperty:"bodyJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.headerJoin!==void 0&&(i(l.headerJoin,{instancePath:m+"/headerJoin",parentData:l,parentDataProperty:"headerJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinBody!==void 0&&(i(l.joinBody,{instancePath:m+"/joinBody",parentData:l,parentDataProperty:"joinBody",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinLeft!==void 0&&(i(l.joinLeft,{instancePath:m+"/joinLeft",parentData:l,parentDataProperty:"joinLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinRight!==void 0&&(i(l.joinRight,{instancePath:m+"/joinRight",parentData:l,parentDataProperty:"joinRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinJoin!==void 0&&(i(l.joinJoin,{instancePath:m+"/joinJoin",parentData:l,parentDataProperty:"joinJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleUp!==void 0&&(i(l.joinMiddleUp,{instancePath:m+"/joinMiddleUp",parentData:l,parentDataProperty:"joinMiddleUp",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleDown!==void 0&&(i(l.joinMiddleDown,{instancePath:m+"/joinMiddleDown",parentData:l,parentDataProperty:"joinMiddleDown",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleLeft!==void 0&&(i(l.joinMiddleLeft,{instancePath:m+"/joinMiddleLeft",parentData:l,parentDataProperty:"joinMiddleLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleRight!==void 0&&(i(l.joinMiddleRight,{instancePath:m+"/joinMiddleRight",parentData:l,parentDataProperty:"joinMiddleRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length))}else{const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[h]:r.push(h),D++}return a.errors=r,D===0}const o={type:"string",enum:["left","right","center","justify"]};At.default;function u(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(typeof l!="string"){const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"string"},message:"must be string"};r===null?r=[h]:r.push(h),D++}if(!(l==="left"||l==="right"||l==="center"||l==="justify")){const h={instancePath:m,schemaPath:"#/enum",keyword:"enum",params:{allowedValues:o.enum},message:"must be equal to one of the allowed values"};r===null?r=[h]:r.push(h),D++}return u.errors=r,D===0}const c=new RegExp("^[0-9]+$","u");function d(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(typeof l!="string"){const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"string"},message:"must be string"};r===null?r=[h]:r.push(h),D++}if(!(l==="left"||l==="right"||l==="center"||l==="justify")){const h={instancePath:m,schemaPath:"#/enum",keyword:"enum",params:{allowedValues:o.enum},message:"must be equal to one of the allowed values"};r===null?r=[h]:r.push(h),D++}return d.errors=r,D===0}const p={type:"string",enum:["top","middle","bottom"]};function f(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(typeof l!="string"){const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"string"},message:"must be string"};r===null?r=[h]:r.push(h),D++}if(!(l==="top"||l==="middle"||l==="bottom")){const h={instancePath:m,schemaPath:"#/enum",keyword:"enum",params:{allowedValues:p.enum},message:"must be equal to one of the allowed values"};r===null?r=[h]:r.push(h),D++}return f.errors=r,D===0}function g(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const h in l)if(!(h==="alignment"||h==="verticalAlignment"||h==="width"||h==="wrapWord"||h==="truncate"||h==="paddingLeft"||h==="paddingRight")){const y={instancePath:m,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"};r===null?r=[y]:r.push(y),D++}if(l.alignment!==void 0&&(d(l.alignment,{instancePath:m+"/alignment",parentData:l,parentDataProperty:"alignment",rootData:v})||(r=r===null?d.errors:r.concat(d.errors),D=r.length)),l.verticalAlignment!==void 0&&(f(l.verticalAlignment,{instancePath:m+"/verticalAlignment",parentData:l,parentDataProperty:"verticalAlignment",rootData:v})||(r=r===null?f.errors:r.concat(f.errors),D=r.length)),l.width!==void 0){let h=l.width;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/width",schemaPath:"#/properties/width/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}if(typeof h=="number"&&isFinite(h)&&(h<1||isNaN(h))){const y={instancePath:m+"/width",schemaPath:"#/properties/width/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"};r===null?r=[y]:r.push(y),D++}}if(l.wrapWord!==void 0&&typeof l.wrapWord!="boolean"){const h={instancePath:m+"/wrapWord",schemaPath:"#/properties/wrapWord/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};r===null?r=[h]:r.push(h),D++}if(l.truncate!==void 0){let h=l.truncate;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/truncate",schemaPath:"#/properties/truncate/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}if(l.paddingLeft!==void 0){let h=l.paddingLeft;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/paddingLeft",schemaPath:"#/properties/paddingLeft/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}if(l.paddingRight!==void 0){let h=l.paddingRight;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/paddingRight",schemaPath:"#/properties/paddingRight/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}}else{const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[h]:r.push(h),D++}return g.errors=r,D===0}function b(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;const h=D;let y=!1,k=null;const P=D;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const B in l)if(!c.test(B)){const I={instancePath:m,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:B},message:"must NOT have additional properties"};r===null?r=[I]:r.push(I),D++}for(const B in l)c.test(B)&&(g(l[B],{instancePath:m+"/"+B.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:l,parentDataProperty:B,rootData:v})||(r=r===null?g.errors:r.concat(g.errors),D=r.length))}else{const B={instancePath:m,schemaPath:"#/oneOf/0/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[B]:r.push(B),D++}var E=P===D;E&&(y=!0,k=0);const _=D;if(Array.isArray(l)){const B=l.length;for(let I=0;I<B;I++)g(l[I],{instancePath:m+"/"+I,parentData:l,parentDataProperty:I,rootData:v})||(r=r===null?g.errors:r.concat(g.errors),D=r.length)}else{const B={instancePath:m,schemaPath:"#/oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};r===null?r=[B]:r.push(B),D++}var E=_===D;if(E&&y?(y=!1,k=[k,1]):E&&(y=!0,k=1),y)D=h,r!==null&&(h?r.length=h:r=null);else{const B={instancePath:m,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:k},message:"must match exactly one schema in oneOf"};r===null?r=[B]:r.push(B),D++}return b.errors=r,D===0}function w(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const h in l)if(!(h==="alignment"||h==="verticalAlignment"||h==="width"||h==="wrapWord"||h==="truncate"||h==="paddingLeft"||h==="paddingRight")){const y={instancePath:m,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"};r===null?r=[y]:r.push(y),D++}if(l.alignment!==void 0&&(d(l.alignment,{instancePath:m+"/alignment",parentData:l,parentDataProperty:"alignment",rootData:v})||(r=r===null?d.errors:r.concat(d.errors),D=r.length)),l.verticalAlignment!==void 0&&(f(l.verticalAlignment,{instancePath:m+"/verticalAlignment",parentData:l,parentDataProperty:"verticalAlignment",rootData:v})||(r=r===null?f.errors:r.concat(f.errors),D=r.length)),l.width!==void 0){let h=l.width;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/width",schemaPath:"#/properties/width/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}if(typeof h=="number"&&isFinite(h)&&(h<1||isNaN(h))){const y={instancePath:m+"/width",schemaPath:"#/properties/width/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"};r===null?r=[y]:r.push(y),D++}}if(l.wrapWord!==void 0&&typeof l.wrapWord!="boolean"){const h={instancePath:m+"/wrapWord",schemaPath:"#/properties/wrapWord/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};r===null?r=[h]:r.push(h),D++}if(l.truncate!==void 0){let h=l.truncate;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/truncate",schemaPath:"#/properties/truncate/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}if(l.paddingLeft!==void 0){let h=l.paddingLeft;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/paddingLeft",schemaPath:"#/properties/paddingLeft/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}if(l.paddingRight!==void 0){let h=l.paddingRight;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/paddingRight",schemaPath:"#/properties/paddingRight/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}}else{const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[h]:r.push(h),D++}return w.errors=r,D===0}function S(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(typeof l!="string"){const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"string"},message:"must be string"};r===null?r=[h]:r.push(h),D++}if(!(l==="top"||l==="middle"||l==="bottom")){const h={instancePath:m,schemaPath:"#/enum",keyword:"enum",params:{allowedValues:p.enum},message:"must be equal to one of the allowed values"};r===null?r=[h]:r.push(h),D++}return S.errors=r,D===0}function x(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const h in l)if(!(h==="border"||h==="header"||h==="columns"||h==="columnDefault"||h==="drawVerticalLine"||h==="drawHorizontalLine"||h==="singleLine"||h==="spanningCells")){const y={instancePath:m,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"};r===null?r=[y]:r.push(y),D++}if(l.border!==void 0&&(a(l.border,{instancePath:m+"/border",parentData:l,parentDataProperty:"border",rootData:v})||(r=r===null?a.errors:r.concat(a.errors),D=r.length)),l.header!==void 0){let h=l.header;if(h&&typeof h=="object"&&!Array.isArray(h)){if(h.content===void 0){const y={instancePath:m+"/header",schemaPath:"#/properties/header/required",keyword:"required",params:{missingProperty:"content"},message:"must have required property 'content'"};r===null?r=[y]:r.push(y),D++}for(const y in h)if(!(y==="content"||y==="alignment"||y==="wrapWord"||y==="truncate"||y==="paddingLeft"||y==="paddingRight")){const k={instancePath:m+"/header",schemaPath:"#/properties/header/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:y},message:"must NOT have additional properties"};r===null?r=[k]:r.push(k),D++}if(h.content!==void 0&&typeof h.content!="string"){const y={instancePath:m+"/header/content",schemaPath:"#/properties/header/properties/content/type",keyword:"type",params:{type:"string"},message:"must be string"};r===null?r=[y]:r.push(y),D++}if(h.alignment!==void 0&&(u(h.alignment,{instancePath:m+"/header/alignment",parentData:h,parentDataProperty:"alignment",rootData:v})||(r=r===null?u.errors:r.concat(u.errors),D=r.length)),h.wrapWord!==void 0&&typeof h.wrapWord!="boolean"){const y={instancePath:m+"/header/wrapWord",schemaPath:"#/properties/header/properties/wrapWord/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};r===null?r=[y]:r.push(y),D++}if(h.truncate!==void 0){let y=h.truncate;if(!(typeof y=="number"&&!(y%1)&&!isNaN(y)&&isFinite(y))){const k={instancePath:m+"/header/truncate",schemaPath:"#/properties/header/properties/truncate/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[k]:r.push(k),D++}}if(h.paddingLeft!==void 0){let y=h.paddingLeft;if(!(typeof y=="number"&&!(y%1)&&!isNaN(y)&&isFinite(y))){const k={instancePath:m+"/header/paddingLeft",schemaPath:"#/properties/header/properties/paddingLeft/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[k]:r.push(k),D++}}if(h.paddingRight!==void 0){let y=h.paddingRight;if(!(typeof y=="number"&&!(y%1)&&!isNaN(y)&&isFinite(y))){const k={instancePath:m+"/header/paddingRight",schemaPath:"#/properties/header/properties/paddingRight/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[k]:r.push(k),D++}}}else{const y={instancePath:m+"/header",schemaPath:"#/properties/header/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[y]:r.push(y),D++}}if(l.columns!==void 0&&(b(l.columns,{instancePath:m+"/columns",parentData:l,parentDataProperty:"columns",rootData:v})||(r=r===null?b.errors:r.concat(b.errors),D=r.length)),l.columnDefault!==void 0&&(w(l.columnDefault,{instancePath:m+"/columnDefault",parentData:l,parentDataProperty:"columnDefault",rootData:v})||(r=r===null?w.errors:r.concat(w.errors),D=r.length)),l.drawVerticalLine!==void 0&&typeof l.drawVerticalLine!="function"){const h={instancePath:m+"/drawVerticalLine",schemaPath:"#/properties/drawVerticalLine/typeof",keyword:"typeof",params:{},message:'must pass "typeof" keyword validation'};r===null?r=[h]:r.push(h),D++}if(l.drawHorizontalLine!==void 0&&typeof l.drawHorizontalLine!="function"){const h={instancePath:m+"/drawHorizontalLine",schemaPath:"#/properties/drawHorizontalLine/typeof",keyword:"typeof",params:{},message:'must pass "typeof" keyword validation'};r===null?r=[h]:r.push(h),D++}if(l.singleLine!==void 0&&typeof l.singleLine!="boolean"){const h={instancePath:m+"/singleLine",schemaPath:"#/properties/singleLine/typeof",keyword:"typeof",params:{},message:'must pass "typeof" keyword validation'};r===null?r=[h]:r.push(h),D++}if(l.spanningCells!==void 0){let h=l.spanningCells;if(Array.isArray(h)){const y=h.length;for(let k=0;k<y;k++){let P=h[k];if(P&&typeof P=="object"&&!Array.isArray(P)){if(P.row===void 0){const _={instancePath:m+"/spanningCells/"+k,schemaPath:"#/properties/spanningCells/items/required",keyword:"required",params:{missingProperty:"row"},message:"must have required property 'row'"};r===null?r=[_]:r.push(_),D++}if(P.col===void 0){const _={instancePath:m+"/spanningCells/"+k,schemaPath:"#/properties/spanningCells/items/required",keyword:"required",params:{missingProperty:"col"},message:"must have required property 'col'"};r===null?r=[_]:r.push(_),D++}for(const _ in P)if(!s.call(t.properties.spanningCells.items.properties,_)){const E={instancePath:m+"/spanningCells/"+k,schemaPath:"#/properties/spanningCells/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:_},message:"must NOT have additional properties"};r===null?r=[E]:r.push(E),D++}if(P.col!==void 0){let _=P.col;if(!(typeof _=="number"&&!(_%1)&&!isNaN(_)&&isFinite(_))){const E={instancePath:m+"/spanningCells/"+k+"/col",schemaPath:"#/properties/spanningCells/items/properties/col/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[E]:r.push(E),D++}if(typeof _=="number"&&isFinite(_)&&(_<0||isNaN(_))){const E={instancePath:m+"/spanningCells/"+k+"/col",schemaPath:"#/properties/spanningCells/items/properties/col/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"};r===null?r=[E]:r.push(E),D++}}if(P.row!==void 0){let _=P.row;if(!(typeof _=="number"&&!(_%1)&&!isNaN(_)&&isFinite(_))){const E={instancePath:m+"/spanningCells/"+k+"/row",schemaPath:"#/properties/spanningCells/items/properties/row/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[E]:r.push(E),D++}if(typeof _=="number"&&isFinite(_)&&(_<0||isNaN(_))){const E={instancePath:m+"/spanningCells/"+k+"/row",schemaPath:"#/properties/spanningCells/items/properties/row/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"};r===null?r=[E]:r.push(E),D++}}if(P.colSpan!==void 0){let _=P.colSpan;if(!(typeof _=="number"&&!(_%1)&&!isNaN(_)&&isFinite(_))){const E={instancePath:m+"/spanningCells/"+k+"/colSpan",schemaPath:"#/properties/spanningCells/items/properties/colSpan/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[E]:r.push(E),D++}if(typeof _=="number"&&isFinite(_)&&(_<1||isNaN(_))){const E={instancePath:m+"/spanningCells/"+k+"/colSpan",schemaPath:"#/properties/spanningCells/items/properties/colSpan/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"};r===null?r=[E]:r.push(E),D++}}if(P.rowSpan!==void 0){let _=P.rowSpan;if(!(typeof _=="number"&&!(_%1)&&!isNaN(_)&&isFinite(_))){const E={instancePath:m+"/spanningCells/"+k+"/rowSpan",schemaPath:"#/properties/spanningCells/items/properties/rowSpan/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[E]:r.push(E),D++}if(typeof _=="number"&&isFinite(_)&&(_<1||isNaN(_))){const E={instancePath:m+"/spanningCells/"+k+"/rowSpan",schemaPath:"#/properties/spanningCells/items/properties/rowSpan/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"};r===null?r=[E]:r.push(E),D++}}if(P.alignment!==void 0&&(u(P.alignment,{instancePath:m+"/spanningCells/"+k+"/alignment",parentData:P,parentDataProperty:"alignment",rootData:v})||(r=r===null?u.errors:r.concat(u.errors),D=r.length)),P.verticalAlignment!==void 0&&(S(P.verticalAlignment,{instancePath:m+"/spanningCells/"+k+"/verticalAlignment",parentData:P,parentDataProperty:"verticalAlignment",rootData:v})||(r=r===null?S.errors:r.concat(S.errors),D=r.length)),P.wrapWord!==void 0&&typeof P.wrapWord!="boolean"){const _={instancePath:m+"/spanningCells/"+k+"/wrapWord",schemaPath:"#/properties/spanningCells/items/properties/wrapWord/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};r===null?r=[_]:r.push(_),D++}if(P.truncate!==void 0){let _=P.truncate;if(!(typeof _=="number"&&!(_%1)&&!isNaN(_)&&isFinite(_))){const E={instancePath:m+"/spanningCells/"+k+"/truncate",schemaPath:"#/properties/spanningCells/items/properties/truncate/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[E]:r.push(E),D++}}if(P.paddingLeft!==void 0){let _=P.paddingLeft;if(!(typeof _=="number"&&!(_%1)&&!isNaN(_)&&isFinite(_))){const E={instancePath:m+"/spanningCells/"+k+"/paddingLeft",schemaPath:"#/properties/spanningCells/items/properties/paddingLeft/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[E]:r.push(E),D++}}if(P.paddingRight!==void 0){let _=P.paddingRight;if(!(typeof _=="number"&&!(_%1)&&!isNaN(_)&&isFinite(_))){const E={instancePath:m+"/spanningCells/"+k+"/paddingRight",schemaPath:"#/properties/spanningCells/items/properties/paddingRight/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[E]:r.push(E),D++}}}else{const _={instancePath:m+"/spanningCells/"+k,schemaPath:"#/properties/spanningCells/items/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[_]:r.push(_),D++}}}else{const y={instancePath:m+"/spanningCells",schemaPath:"#/properties/spanningCells/type",keyword:"type",params:{type:"array"},message:"must be array"};r===null?r=[y]:r.push(y),D++}}}else{const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[h]:r.push(h),D++}return x.errors=r,D===0}e["streamConfig.json"]=F;function T(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const h in l)if(!s.call(n.properties,h)){const y={instancePath:m,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"};r===null?r=[y]:r.push(y),D++}l.topBody!==void 0&&(i(l.topBody,{instancePath:m+"/topBody",parentData:l,parentDataProperty:"topBody",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.topJoin!==void 0&&(i(l.topJoin,{instancePath:m+"/topJoin",parentData:l,parentDataProperty:"topJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.topLeft!==void 0&&(i(l.topLeft,{instancePath:m+"/topLeft",parentData:l,parentDataProperty:"topLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.topRight!==void 0&&(i(l.topRight,{instancePath:m+"/topRight",parentData:l,parentDataProperty:"topRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomBody!==void 0&&(i(l.bottomBody,{instancePath:m+"/bottomBody",parentData:l,parentDataProperty:"bottomBody",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomJoin!==void 0&&(i(l.bottomJoin,{instancePath:m+"/bottomJoin",parentData:l,parentDataProperty:"bottomJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomLeft!==void 0&&(i(l.bottomLeft,{instancePath:m+"/bottomLeft",parentData:l,parentDataProperty:"bottomLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bottomRight!==void 0&&(i(l.bottomRight,{instancePath:m+"/bottomRight",parentData:l,parentDataProperty:"bottomRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bodyLeft!==void 0&&(i(l.bodyLeft,{instancePath:m+"/bodyLeft",parentData:l,parentDataProperty:"bodyLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bodyRight!==void 0&&(i(l.bodyRight,{instancePath:m+"/bodyRight",parentData:l,parentDataProperty:"bodyRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.bodyJoin!==void 0&&(i(l.bodyJoin,{instancePath:m+"/bodyJoin",parentData:l,parentDataProperty:"bodyJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.headerJoin!==void 0&&(i(l.headerJoin,{instancePath:m+"/headerJoin",parentData:l,parentDataProperty:"headerJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinBody!==void 0&&(i(l.joinBody,{instancePath:m+"/joinBody",parentData:l,parentDataProperty:"joinBody",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinLeft!==void 0&&(i(l.joinLeft,{instancePath:m+"/joinLeft",parentData:l,parentDataProperty:"joinLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinRight!==void 0&&(i(l.joinRight,{instancePath:m+"/joinRight",parentData:l,parentDataProperty:"joinRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinJoin!==void 0&&(i(l.joinJoin,{instancePath:m+"/joinJoin",parentData:l,parentDataProperty:"joinJoin",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleUp!==void 0&&(i(l.joinMiddleUp,{instancePath:m+"/joinMiddleUp",parentData:l,parentDataProperty:"joinMiddleUp",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleDown!==void 0&&(i(l.joinMiddleDown,{instancePath:m+"/joinMiddleDown",parentData:l,parentDataProperty:"joinMiddleDown",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleLeft!==void 0&&(i(l.joinMiddleLeft,{instancePath:m+"/joinMiddleLeft",parentData:l,parentDataProperty:"joinMiddleLeft",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length)),l.joinMiddleRight!==void 0&&(i(l.joinMiddleRight,{instancePath:m+"/joinMiddleRight",parentData:l,parentDataProperty:"joinMiddleRight",rootData:v})||(r=r===null?i.errors:r.concat(i.errors),D=r.length))}else{const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[h]:r.push(h),D++}return T.errors=r,D===0}function j(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;const h=D;let y=!1,k=null;const P=D;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const B in l)if(!c.test(B)){const I={instancePath:m,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:B},message:"must NOT have additional properties"};r===null?r=[I]:r.push(I),D++}for(const B in l)c.test(B)&&(g(l[B],{instancePath:m+"/"+B.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:l,parentDataProperty:B,rootData:v})||(r=r===null?g.errors:r.concat(g.errors),D=r.length))}else{const B={instancePath:m,schemaPath:"#/oneOf/0/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[B]:r.push(B),D++}var E=P===D;E&&(y=!0,k=0);const _=D;if(Array.isArray(l)){const B=l.length;for(let I=0;I<B;I++)g(l[I],{instancePath:m+"/"+I,parentData:l,parentDataProperty:I,rootData:v})||(r=r===null?g.errors:r.concat(g.errors),D=r.length)}else{const B={instancePath:m,schemaPath:"#/oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};r===null?r=[B]:r.push(B),D++}var E=_===D;if(E&&y?(y=!1,k=[k,1]):E&&(y=!0,k=1),y)D=h,r!==null&&(h?r.length=h:r=null);else{const B={instancePath:m,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:k},message:"must match exactly one schema in oneOf"};r===null?r=[B]:r.push(B),D++}return j.errors=r,D===0}function H(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(l&&typeof l=="object"&&!Array.isArray(l)){for(const h in l)if(!(h==="alignment"||h==="verticalAlignment"||h==="width"||h==="wrapWord"||h==="truncate"||h==="paddingLeft"||h==="paddingRight")){const y={instancePath:m,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"};r===null?r=[y]:r.push(y),D++}if(l.alignment!==void 0&&(d(l.alignment,{instancePath:m+"/alignment",parentData:l,parentDataProperty:"alignment",rootData:v})||(r=r===null?d.errors:r.concat(d.errors),D=r.length)),l.verticalAlignment!==void 0&&(f(l.verticalAlignment,{instancePath:m+"/verticalAlignment",parentData:l,parentDataProperty:"verticalAlignment",rootData:v})||(r=r===null?f.errors:r.concat(f.errors),D=r.length)),l.width!==void 0){let h=l.width;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/width",schemaPath:"#/properties/width/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}if(typeof h=="number"&&isFinite(h)&&(h<1||isNaN(h))){const y={instancePath:m+"/width",schemaPath:"#/properties/width/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"};r===null?r=[y]:r.push(y),D++}}if(l.wrapWord!==void 0&&typeof l.wrapWord!="boolean"){const h={instancePath:m+"/wrapWord",schemaPath:"#/properties/wrapWord/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};r===null?r=[h]:r.push(h),D++}if(l.truncate!==void 0){let h=l.truncate;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/truncate",schemaPath:"#/properties/truncate/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}if(l.paddingLeft!==void 0){let h=l.paddingLeft;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/paddingLeft",schemaPath:"#/properties/paddingLeft/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}if(l.paddingRight!==void 0){let h=l.paddingRight;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/paddingRight",schemaPath:"#/properties/paddingRight/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}}}else{const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[h]:r.push(h),D++}return H.errors=r,D===0}function F(l,{instancePath:m="",parentData:M,parentDataProperty:A,rootData:v=l}={}){let r=null,D=0;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.columnDefault===void 0){const h={instancePath:m,schemaPath:"#/required",keyword:"required",params:{missingProperty:"columnDefault"},message:"must have required property 'columnDefault'"};r===null?r=[h]:r.push(h),D++}if(l.columnCount===void 0){const h={instancePath:m,schemaPath:"#/required",keyword:"required",params:{missingProperty:"columnCount"},message:"must have required property 'columnCount'"};r===null?r=[h]:r.push(h),D++}for(const h in l)if(!(h==="border"||h==="columns"||h==="columnDefault"||h==="columnCount"||h==="drawVerticalLine")){const y={instancePath:m,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"};r===null?r=[y]:r.push(y),D++}if(l.border!==void 0&&(T(l.border,{instancePath:m+"/border",parentData:l,parentDataProperty:"border",rootData:v})||(r=r===null?T.errors:r.concat(T.errors),D=r.length)),l.columns!==void 0&&(j(l.columns,{instancePath:m+"/columns",parentData:l,parentDataProperty:"columns",rootData:v})||(r=r===null?j.errors:r.concat(j.errors),D=r.length)),l.columnDefault!==void 0&&(H(l.columnDefault,{instancePath:m+"/columnDefault",parentData:l,parentDataProperty:"columnDefault",rootData:v})||(r=r===null?H.errors:r.concat(H.errors),D=r.length)),l.columnCount!==void 0){let h=l.columnCount;if(!(typeof h=="number"&&!(h%1)&&!isNaN(h)&&isFinite(h))){const y={instancePath:m+"/columnCount",schemaPath:"#/properties/columnCount/type",keyword:"type",params:{type:"integer"},message:"must be integer"};r===null?r=[y]:r.push(y),D++}if(typeof h=="number"&&isFinite(h)&&(h<1||isNaN(h))){const y={instancePath:m+"/columnCount",schemaPath:"#/properties/columnCount/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"};r===null?r=[y]:r.push(y),D++}}if(l.drawVerticalLine!==void 0&&typeof l.drawVerticalLine!="function"){const h={instancePath:m+"/drawVerticalLine",schemaPath:"#/properties/drawVerticalLine/typeof",keyword:"typeof",params:{},message:'must pass "typeof" keyword validation'};r===null?r=[h]:r.push(h),D++}}else{const h={instancePath:m,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};r===null?r=[h]:r.push(h),D++}return F.errors=r,D===0}})(Hn);var bs=O&&O.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.validateConfig=void 0;const Cs=bs(Hn),vs=(e,t)=>{const n=Cs.default[e];if(!n(t)&&n.errors){const s=n.errors.map(i=>({message:i.message,params:i.params,schemaPath:i.schemaPath}));throw console.log("config",t),console.log("errors",s),new Error("Invalid config.")}};Ce.validateConfig=vs;Object.defineProperty(Ie,"__esModule",{value:!0});Ie.makeStreamConfig=void 0;const _s=q,ws=Ce,Fs=(e,t={},n)=>Array.from({length:e}).map((s,i)=>({alignment:"left",paddingLeft:1,paddingRight:1,truncate:Number.POSITIVE_INFINITY,verticalAlignment:"top",wrapWord:!1,...n,...t[i]})),ks=e=>{if((0,ws.validateConfig)("streamConfig.json",e),e.columnDefault.width===void 0)throw new Error("Must provide config.columnDefault.width when creating a stream.");return{drawVerticalLine:()=>!0,...e,border:(0,_s.makeBorderConfig)(e.border),columns:Fs(e.columnCount,e.columns,e.columnDefault)}};Ie.makeStreamConfig=ks;var qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.mapDataUsingRowHeights=e.padCellVertically=void 0;const t=q,n=oe,s=o=>new Array(o).fill(""),i=(o,u,c)=>{const d=u-o.length;return c==="top"?[...o,...s(d)]:c==="bottom"?[...s(d),...o]:[...s(Math.floor(d/2)),...o,...s(Math.ceil(d/2))]};e.padCellVertically=i;const a=(o,u,c)=>{const d=o[0].length,p=o.map((f,g)=>{const b=u[g],w=Array.from({length:b},()=>new Array(d).fill(""));return f.forEach((S,x)=>{var T;const j=(T=c.spanningCellManager)===null||T===void 0?void 0:T.getContainingRange({col:x,row:g});if(j){j.extractCellContent(g).forEach((l,m)=>{w[m][x]=l});return}const H=(0,n.wrapCell)(S,c.columns[x].width,c.columns[x].wrapWord);(0,e.padCellVertically)(H,b,c.columns[x].verticalAlignment).forEach((l,m)=>{w[m][x]=l})}),w});return(0,t.flatten)(p)};e.mapDataUsingRowHeights=a})(qe);var He={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.padTableData=e.padString=void 0;const t=(s,i,a)=>" ".repeat(i)+s+" ".repeat(a);e.padString=t;const n=(s,i)=>s.map((a,o)=>a.map((u,c)=>{var d;if((d=i.spanningCellManager)===null||d===void 0?void 0:d.getContainingRange({col:c,row:o},{mapped:!0}))return u;const{paddingLeft:f,paddingRight:g}=i.columns[c];return(0,e.padString)(u,f,g)}));e.padTableData=n})(He);var ve={};Object.defineProperty(ve,"__esModule",{value:!0});ve.stringifyTableData=void 0;const Es=q,$s=e=>e.map(t=>t.map(n=>(0,Es.normalizeString)(String(n))));ve.stringifyTableData=$s;var Ve={},xe={exports:{}};xe.exports;(function(e,t){var n=30,s="...",i=1/0,a=17976931348623157e292,o=0/0,u="[object RegExp]",c="[object Symbol]",d=/^\s+|\s+$/g,p=/\w*$/,f=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,b=/^0o[0-7]+$/i,w="\\ud800-\\udfff",S="\\u0300-\\u036f\\ufe20-\\ufe23",x="\\u20d0-\\u20f0",T="\\ufe0e\\ufe0f",j="["+w+"]",H="["+S+x+"]",F="\\ud83c[\\udffb-\\udfff]",l="(?:"+H+"|"+F+")",m="[^"+w+"]",M="(?:\\ud83c[\\udde6-\\uddff]){2}",A="[\\ud800-\\udbff][\\udc00-\\udfff]",v="\\u200d",r=l+"?",D="["+T+"]?",h="(?:"+v+"(?:"+[m,M,A].join("|")+")"+D+r+")*",y=D+r+h,k="(?:"+[m+H+"?",H,M,A,j].join("|")+")",P=RegExp(F+"(?="+F+")|"+k+y,"g"),_=RegExp("["+v+w+S+x+T+"]"),E=parseInt,B=typeof O=="object"&&O&&O.Object===Object&&O,I=typeof self=="object"&&self&&self.Object===Object&&self,ni=B||I||Function("return this")(),Tt=t&&!t.nodeType&&t,jt=Tt&&!0&&e&&!e.nodeType&&e,ii=jt&&jt.exports===Tt,Rt=ii&&B.process,Lt=function(){try{return Rt&&Rt.binding("util")}catch{}}(),Ot=Lt&&Lt.isRegExp,ri=ai("length");function si(C){return C.split("")}function ai(C){return function($){return $==null?void 0:$[C]}}function oi(C){return function($){return C($)}}function tt(C){return _.test(C)}function li(C){return tt(C)?ci(C):ri(C)}function ui(C){return tt(C)?di(C):si(C)}function ci(C){for(var $=P.lastIndex=0;P.test(C);)$++;return $}function di(C){return C.match(P)||[]}var hi=Object.prototype,zt=hi.toString,Nt=ni.Symbol,It=Nt?Nt.prototype:void 0,qt=It?It.toString:void 0;function pi(C){return _e(C)&&zt.call(C)==u}function fi(C,$,R){var U=-1,N=C.length;$<0&&($=-$>N?0:N+$),R=R>N?N:R,R<0&&(R+=N),N=$>R?0:R-$>>>0,$>>>=0;for(var ue=Array(N);++U<N;)ue[U]=C[U+$];return ue}function nt(C){if(typeof C=="string")return C;if(Ht(C))return qt?qt.call(C):"";var $=C+"";return $=="0"&&1/C==-i?"-0":$}function mi(C,$,R){var U=C.length;return R=R===void 0?U:R,!$&&R>=U?C:fi(C,$,R)}function _e(C){var $=typeof C;return!!C&&($=="object"||$=="function")}function Di(C){return!!C&&typeof C=="object"}var gi=Ot?oi(Ot):pi;function Ht(C){return typeof C=="symbol"||Di(C)&&zt.call(C)==c}function yi(C){if(!C)return C===0?C:0;if(C=Ci(C),C===i||C===-i){var $=C<0?-1:1;return $*a}return C===C?C:0}function bi(C){var $=yi(C),R=$%1;return $===$?R?$-R:$:0}function Ci(C){if(typeof C=="number")return C;if(Ht(C))return o;if(_e(C)){var $=typeof C.valueOf=="function"?C.valueOf():C;C=_e($)?$+"":$}if(typeof C!="string")return C===0?C:+C;C=C.replace(d,"");var R=g.test(C);return R||b.test(C)?E(C.slice(2),R?2:8):f.test(C)?o:+C}function Vt(C){return C==null?"":nt(C)}function vi(C,$){var R=n,U=s;if(_e($)){var N="separator"in $?$.separator:N;R="length"in $?bi($.length):R,U="omission"in $?nt($.omission):U}C=Vt(C);var ue=C.length;if(tt(C)){var we=ui(C);ue=we.length}if(R>=ue)return C;var Z=R-li(U);if(Z<1)return U;var K=we?mi(we,0,Z).join(""):C.slice(0,Z);if(N===void 0)return K+U;if(we&&(Z+=K.length-Z),gi(N)){if(C.slice(Z).search(N)){var Wt,_i=K;for(N.global||(N=RegExp(N.source,Vt(p.exec(N))+"g")),N.lastIndex=0;Wt=N.exec(_i);)var Ut=Wt.index;K=K.slice(0,Ut===void 0?Z:Ut)}}else if(C.indexOf(nt(N),Z)!=Z){var Yt=K.lastIndexOf(N);Yt>-1&&(K=K.slice(0,Yt))}return K+U}e.exports=vi})(xe,xe.exports);var Ss=xe.exports;(function(e){var t=O&&O.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0}),e.truncateTableData=e.truncateString=void 0;const n=t(Ss),s=(a,o)=>(0,n.default)(a,{length:o,omission:"…"});e.truncateString=s;const i=(a,o)=>a.map(u=>u.map((c,d)=>(0,e.truncateString)(c,o[d])));e.truncateTableData=i})(Ve);Object.defineProperty(Le,"__esModule",{value:!0});Le.createStream=void 0;const Bs=fe,xs=ye,Pe=Mt,Wn=be,Ps=Ie,Ms=qe,As=He,Ts=ve,js=Ve,Rs=q,Un=(e,t)=>{let n=(0,Ts.stringifyTableData)(e);n=(0,js.truncateTableData)(n,(0,Rs.extractTruncates)(t));const s=(0,xs.calculateRowHeights)(n,t);return n=(0,Ms.mapDataUsingRowHeights)(n,s,t),n=(0,Bs.alignTableData)(n,t),n=(0,As.padTableData)(n,t),n},Ls=(e,t,n)=>{const i=Un([e],n).map(o=>(0,Wn.drawRow)(o,n)).join("");let a;a="",a+=(0,Pe.drawBorderTop)(t,n),a+=i,a+=(0,Pe.drawBorderBottom)(t,n),a=a.trimEnd(),process.stdout.write(a)},Os=(e,t,n)=>{const i=Un([e],n).map(u=>(0,Wn.drawRow)(u,n)).join("");let a="";const o=(0,Pe.drawBorderBottom)(t,n);o!==`
`&&(a="\r\x1B[K"),a+=(0,Pe.drawBorderJoin)(t,n),a+=i,a+=o,a=a.trimEnd(),process.stdout.write(a)},zs=e=>{const t=(0,Ps.makeStreamConfig)(e),n=Object.values(t.columns).map(i=>i.width+i.paddingLeft+i.paddingRight);let s=!0;return{write:i=>{if(i.length!==t.columnCount)throw new Error("Row cell count does not match the config.columnCount.");s?(s=!1,Ls(i,n,t)):Os(i,n,t)}}};Le.createStream=zs;var We={},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.calculateOutputColumnWidths=void 0;const Ns=e=>e.columns.map(t=>t.paddingLeft+t.width+t.paddingRight);Ue.calculateOutputColumnWidths=Ns;var Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.drawTable=void 0;const Is=Mt,qs=le,Hs=be,Vs=q,Ws=(e,t,n,s)=>{const{drawHorizontalLine:i,singleLine:a}=s,o=(0,Vs.groupBySizes)(e,n).map((u,c)=>u.map(d=>(0,Hs.drawRow)(d,{...s,rowIndex:c})).join(""));return(0,qs.drawContent)({contents:o,drawSeparator:(u,c)=>(u===0||u===c||!a)&&i(u,c),elementType:"row",rowIndex:-1,separatorGetter:(0,Is.createTableBorderGetter)(t,{...s,rowCount:o.length}),spanningCellManager:s.spanningCellManager})};Ye.drawTable=Ws;var Je={};Object.defineProperty(Je,"__esModule",{value:!0});Je.injectHeaderConfig=void 0;const Us=(e,t)=>{var n;let s=(n=t.spanningCells)!==null&&n!==void 0?n:[];const i=t.header,a=[...e];if(i){s=s.map(({row:c,...d})=>({...d,row:c+1}));const{content:o,...u}=i;s.unshift({alignment:"center",col:0,colSpan:e[0].length,paddingLeft:1,paddingRight:1,row:0,wrapWord:!1,...u}),a.unshift([o,...Array.from({length:e[0].length-1}).fill("")])}return[a,s]};Je.injectHeaderConfig=Us;var Ge={},Yn={};(function(e){var t=O&&O.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.calculateMaximumColumnWidths=e.calculateMaximumCellWidth=void 0;const n=t(De),s=q,i=o=>Math.max(...o.split(`
`).map(n.default));e.calculateMaximumCellWidth=i;const a=(o,u=[])=>{const c=new Array(o[0].length).fill(0),d=u.map(s.calculateRangeCoordinate),p=(f,g)=>d.some(b=>(0,s.isCellInRange)({col:g,row:f},b));return o.forEach((f,g)=>{f.forEach((b,w)=>{p(g,w)||(c[w]=Math.max(c[w],(0,e.calculateMaximumCellWidth)(b)))})}),c};e.calculateMaximumColumnWidths=a})(Yn);var Ze={},se={},Ys=O&&O.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(se,"__esModule",{value:!0});se.alignVerticalRangeContent=se.wrapRangeContent=void 0;const Js=Ys(De),Gs=me,Zs=qe,Ks=He,Xs=Ve,un=q,Qs=oe,ea=(e,t,n)=>{const{topLeft:s,paddingRight:i,paddingLeft:a,truncate:o,wrapWord:u,alignment:c}=e,d=n.rows[s.row][s.col],p=t-a-i;return(0,Qs.wrapCell)((0,Xs.truncateString)(d,o),p,u).map(f=>{const g=(0,Gs.alignString)(f,p,c);return(0,Ks.padString)(g,a,i)})};se.wrapRangeContent=ea;const ta=(e,t,n)=>{const{rows:s,drawHorizontalLine:i,rowHeights:a}=n,{topLeft:o,bottomRight:u,verticalAlignment:c}=e;if(a.length===0)return[];const d=(0,un.sumArray)(a.slice(o.row,u.row+1)),p=u.row-o.row,f=(0,un.sequence)(o.row+1,u.row).filter(b=>!i(b,s.length)).length,g=d+p-f;return(0,Zs.padCellVertically)(t,g,c).map(b=>b.length===0?" ".repeat((0,Js.default)(t[0])):b)};se.alignVerticalRangeContent=ta;var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.calculateSpanningCellWidth=void 0;const ct=q,na=(e,t)=>{const{columnsConfig:n,drawVerticalLine:s}=t,{topLeft:i,bottomRight:a}=e,o=(0,ct.sumArray)(n.slice(i.col,a.col+1).map(({width:p})=>p)),u=i.col===a.col?n[i.col].paddingRight+n[a.col].paddingLeft:(0,ct.sumArray)(n.slice(i.col,a.col+1).map(({paddingLeft:p,paddingRight:f})=>p+f)),c=a.col-i.col,d=(0,ct.sequence)(i.col+1,a.col).filter(p=>!s(p,n.length)).length;return o+u+c-d};Ke.calculateSpanningCellWidth=na;var Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.makeRangeConfig=void 0;const ia=q,ra=(e,t)=>{var n;const{topLeft:s,bottomRight:i}=(0,ia.calculateRangeCoordinate)(e);return{...{...t[s.col],...e,paddingRight:(n=e.paddingRight)!==null&&n!==void 0?n:t[i.col].paddingRight},bottomRight:i,topLeft:s}};Xe.makeRangeConfig=ra;Object.defineProperty(Ze,"__esModule",{value:!0});Ze.createSpanningCellManager=void 0;const cn=se,sa=Ke,aa=Xe,re=q,bt=(e,t)=>t.find(n=>(0,re.isCellInRange)(e,n)),dn=(e,t)=>{const n=(0,sa.calculateSpanningCellWidth)(e,t),s=(0,cn.wrapRangeContent)(e,n,t),i=(0,cn.alignVerticalRangeContent)(e,s,t);return{...e,extractBorderContent:u=>{const{topLeft:c}=e,d=(0,re.sumArray)(t.rowHeights.slice(c.row,u))+(u-c.row-1);return i[d]},extractCellContent:u=>{const{topLeft:c}=e,{drawHorizontalLine:d,rowHeights:p}=t,f=u-c.row,g=(0,re.sequence)(c.row+1,u).filter(w=>!(d!=null&&d(w,p.length))).length,b=(0,re.sumArray)(p.slice(c.row,u))+f-g;return i.slice(b,b+p[u])},height:s.length,width:n}},oa=(e,t,n)=>{const s=bt(e,n),i=bt(t,n);return s&&i?(0,re.areCellEqual)(s.topLeft,i.topLeft):!1},la=e=>{const{row:t,col:n}=e.topLeft;return`${t}/${n}`},ua=e=>{const{spanningCellConfigs:t,columnsConfig:n}=e,s=t.map(o=>(0,aa.makeRangeConfig)(o,n)),i={};let a=[];return{getContainingRange:(o,u)=>{var c;const d=u!=null&&u.mapped?(0,re.findOriginalRowIndex)(a,o.row):o.row,p=bt({...o,row:d},s);if(!p)return;if(a.length===0)return dn(p,{...e,rowHeights:a});const f=la(p);return(c=i[f])!==null&&c!==void 0||(i[f]=dn(p,{...e,rowHeights:a})),i[f]},inSameRange:(o,u)=>oa(o,u,s),rowHeights:a,setRowHeights:o=>{a=o}}};Ze.createSpanningCellManager=ua;var Qe={};Object.defineProperty(Qe,"__esModule",{value:!0});Qe.validateSpanningCellConfig=void 0;const dt=q,Ee=(e,t,n)=>e<=n&&n<=t,ca=(e,t)=>{const[n,s]=[e.length,e[0].length];t.forEach((o,u)=>{const{colSpan:c,rowSpan:d}=o;if(c===void 0&&d===void 0)throw new Error(`Expect at least colSpan or rowSpan is provided in config.spanningCells[${u}]`);if(c!==void 0&&c<1)throw new Error(`Expect colSpan is not equal zero, instead got: ${c} in config.spanningCells[${u}]`);if(d!==void 0&&d<1)throw new Error(`Expect rowSpan is not equal zero, instead got: ${d} in config.spanningCells[${u}]`)});const i=t.map(dt.calculateRangeCoordinate);i.forEach(({topLeft:o,bottomRight:u},c)=>{if(!Ee(0,s-1,o.col)||!Ee(0,n-1,o.row)||!Ee(0,s-1,u.col)||!Ee(0,n-1,u.row))throw new Error(`Some cells in config.spanningCells[${c}] are out of the table`)});const a=Array.from({length:n},()=>Array.from({length:s}));i.forEach(({topLeft:o,bottomRight:u},c)=>{(0,dt.sequence)(o.row,u.row).forEach(d=>{(0,dt.sequence)(o.col,u.col).forEach(p=>{if(a[d][p]!==void 0)throw new Error(`Spanning cells in config.spanningCells[${a[d][p]}] and config.spanningCells[${c}] are overlap each other`);a[d][p]=c})})})};Qe.validateSpanningCellConfig=ca;Object.defineProperty(Ge,"__esModule",{value:!0});Ge.makeTableConfig=void 0;const da=Yn,ha=Ze,pa=q,fa=Ce,ma=Qe,Da=(e,t,n,s)=>{const i=(0,da.calculateMaximumColumnWidths)(e,s);return e[0].map((a,o)=>({alignment:"left",paddingLeft:1,paddingRight:1,truncate:Number.POSITIVE_INFINITY,verticalAlignment:"top",width:i[o],wrapWord:!1,...n,...t==null?void 0:t[o]}))},ga=(e,t={},n)=>{var s,i,a,o,u;(0,fa.validateConfig)("config.json",t),(0,ma.validateSpanningCellConfig)(e,(s=t.spanningCells)!==null&&s!==void 0?s:[]);const c=(i=n??t.spanningCells)!==null&&i!==void 0?i:[],d=Da(e,t.columns,t.columnDefault,c),p=(a=t.drawVerticalLine)!==null&&a!==void 0?a:()=>!0,f=(o=t.drawHorizontalLine)!==null&&o!==void 0?o:()=>!0;return{...t,border:(0,pa.makeBorderConfig)(t.border),columns:d,drawHorizontalLine:f,drawVerticalLine:p,singleLine:(u=t.singleLine)!==null&&u!==void 0?u:!1,spanningCellManager:(0,ha.createSpanningCellManager)({columnsConfig:d,drawHorizontalLine:f,drawVerticalLine:p,rows:e,spanningCellConfigs:c})}};Ge.makeTableConfig=ga;var et={};Object.defineProperty(et,"__esModule",{value:!0});et.validateTableData=void 0;const ya=q,ba=e=>{if(!Array.isArray(e))throw new TypeError("Table data must be an array.");if(e.length===0)throw new Error("Table must define at least one row.");if(e[0].length===0)throw new Error("Table must define at least one column.");const t=e[0].length;for(const n of e){if(!Array.isArray(n))throw new TypeError("Table row data must be an array.");if(n.length!==t)throw new Error("Table must have a consistent number of cells.");for(const s of n)if(/[\u0001-\u0006\u0008\u0009\u000B-\u001A]/.test((0,ya.normalizeString)(String(s))))throw new Error("Table data must not contain control characters.")}};et.validateTableData=ba;Object.defineProperty(We,"__esModule",{value:!0});We.table=void 0;const Ca=fe,va=Ue,_a=ye,wa=Ye,Fa=Je,ka=Ge,Ea=qe,$a=He,Sa=ve,Ba=Ve,xa=q,Pa=et,Ma=(e,t={})=>{(0,Pa.validateTableData)(e);let n=(0,Sa.stringifyTableData)(e);const[s,i]=(0,Fa.injectHeaderConfig)(n,t),a=(0,ka.makeTableConfig)(s,t,i);n=(0,Ba.truncateTableData)(s,(0,xa.extractTruncates)(a));const o=(0,_a.calculateRowHeights)(n,a);a.spanningCellManager.setRowHeights(o),n=(0,Ea.mapDataUsingRowHeights)(n,o,a),n=(0,Ca.alignTableData)(n,a),n=(0,$a.padTableData)(n,a);const u=(0,va.calculateOutputColumnWidths)(a);return(0,wa.drawTable)(n,u,o,a)};We.table=Ma;var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});(function(e){var t=O&&O.__createBinding||(Object.create?function(o,u,c,d){d===void 0&&(d=c),Object.defineProperty(o,d,{enumerable:!0,get:function(){return u[c]}})}:function(o,u,c,d){d===void 0&&(d=c),o[d]=u[c]}),n=O&&O.__exportStar||function(o,u){for(var c in o)c!=="default"&&!Object.prototype.hasOwnProperty.call(u,c)&&t(u,o,c)};Object.defineProperty(e,"__esModule",{value:!0}),e.getBorderCharacters=e.createStream=e.table=void 0;const s=Le;Object.defineProperty(e,"createStream",{enumerable:!0,get:function(){return s.createStream}});const i=ge;Object.defineProperty(e,"getBorderCharacters",{enumerable:!0,get:function(){return i.getBorderCharacters}});const a=We;Object.defineProperty(e,"table",{enumerable:!0,get:function(){return a.table}}),n(Jn,e)})(gt);function te(e,t){const n=Array.from(e);return Array.from(t).some((s,i,a)=>n.every((o,u)=>o===a[i+u]))}const Aa={name:"AgentTerminal",props:{agent:{type:Object,required:!0}},data(){return{currentInput:"",outputLines:[],currentModule:null,moduleOptions:{},commandHistory:[],historyIndex:-1,moduleName:"",currentOptions:{},suggestions:[],currentSuggestionIndex:-1,tableConfig:{border:{topBody:"─",topJoin:"┬",topLeft:"┌",topRight:"┐",bottomBody:"─",bottomJoin:"┴",bottomLeft:"└",bottomRight:"┘",bodyLeft:"│",bodyRight:"│",bodyJoin:"│",joinBody:"─",joinLeft:"├",joinRight:"┤",joinJoin:"┼"}},helpCommands:[{command:"help",description:"Display the help menu for the current menu",usage:"help"},{command:"clear",description:"Clear the terminal output",usage:"clear"},{command:"back",description:"Return to the main menu from a module",usage:"back"},{command:"usemodule",description:"Use a specific module by name",usage:"usemodule <module_name>"},{command:"whoami",description:"Display current user",usage:"whoami"},{command:"sysinfo",description:"Tasks the specified agent to update sysinfo",usage:"sysinfo"},{command:"shell",description:"Tasks the specified agent to execute a shell command",usage:"shell [--literal / -l] <shell_cmd>"},{command:"ps",description:"Display the processes running on the agent's system",usage:"ps"},{command:"sc",description:"Run the powershell_collection_screenshot module with Ratio set to 80",usage:"sc"},{command:"sherlock",description:"PowerShell script to quickly find missing software patches for local privilege escalation vulnerabilities",usage:"sherlock"},{command:"socks",description:"Create a SOCKS proxy on the specified port",usage:"socks 1080"},{command:"revtoself",description:"Revert to self on the existing Agent",usage:"revtoself"},{command:"sleep",description:"Tasks specified agent to update delay (s) and jitter (0.0 - 1.0)",usage:"sleep <delay> <jitter>"},{command:"jobs",description:"Task the agent to return back a list of all previous tasks and their status",usage:"jobs"}],moduleHelpCommands:[{command:"execute",description:"Execute the selected module",usage:"execute"},{command:"generate",description:"Generate the selected module",usage:"generate"},{command:"help",description:"Display the help menu for the current menu",usage:"help"},{command:"info",description:"Print default info on the current record",usage:"info"},{command:"options",description:"Print the current record options",usage:"options"},{command:"set",description:"Set a field for the current record",usage:"set <key> <value>"},{command:"unset",description:"Unset a record option",usage:"unset <key>"},{command:"clear",description:"Clear the terminal output",usage:"clear"},{command:"back",description:"Return to the main menu from a module",usage:"back"}],isShellMenu:!1,currentDir:"loading..."}},computed:{moduleStore(){return Ki()},allModules(){return this.moduleStore.modules},listenerStore(){return bn()},bypassStore(){return Xi()},listeners(){return this.listenerStore.listeners},currentPrompt(){const e=this.colorizeText("(Empire: ","white"),t=this.colorizeText(" )>","white");let n="";return this.currentModule?n=this.colorizeText(`usemodule/${this.currentModule.id}`,"red"):this.isShellMenu?n=this.colorizeText(this.currentDir,"green"):n=this.colorizeText(this.agent.session_id,"red"),e+n+t}},watch:{currentInput(){this.generateSuggestions(),this.$nextTick(()=>this.positionSuggestions())},outputLines(e){localStorage.setItem(this.storageName(),JSON.stringify(e))},suggestions(){this.$nextTick(()=>this.positionSuggestions())}},async mounted(){var t;this.$refs.inputField.focus(),((t=this.allModules)==null?void 0:t.length)===0&&await this.moduleStore.getModules(),await this.listenerStore.getListeners();const e=localStorage.getItem(this.storageName());e&&(this.outputLines=JSON.parse(e)),this.scrollToBottom()},methods:{storageName(){return`terminal-history-${this.agent.session_id}`},ctrlCHandler(e){this.isShellMenu&&(this.isShellMenu=!1),this.addLine(`${this.currentPrompt} ${this.currentInput}`),this.currentInput=""},positionSuggestions(){const{inputField:e}=this.$refs,{suggestionList:t}=this.$refs,n=this.$el.querySelector(".prompt");if(e&&t&&n){const s=e.getBoundingClientRect(),i=n.getBoundingClientRect(),a=n.offsetWidth;t.style.top=`${s.bottom}px`,t.style.left=`${i.left+a}px`}},applySuggestion(e){this.currentInput=e,this.suggestions=[],this.currentSuggestionIndex=0},handleKeyEvents(e){if(e.code==="ArrowUp")e.preventDefault(),this.historyIndex>0&&(this.historyIndex--,this.currentInput=this.commandHistory[this.historyIndex]);else if(e.code==="ArrowDown")this.historyIndex<this.commandHistory.length-1&&(this.historyIndex++,this.currentInput=this.commandHistory[this.historyIndex]);else if(e.code==="Tab")this.currentInput===""&&this.generateSuggestions(),e.preventDefault(),this.suggestions.length>1?this.currentSuggestionIndex=(this.currentSuggestionIndex+1)%this.suggestions.length:this.suggestions.length===1&&(this.currentInput=this.suggestions[0],this.suggestions=[]),this.$nextTick(()=>{const t=this.$refs.suggestionList,n=t.children[this.currentSuggestionIndex];n&&(n.offsetTop+n.clientHeight>t.clientHeight?t.scrollTop=n.offsetTop+n.clientHeight-t.clientHeight:n.offsetTop<t.scrollTop&&(t.scrollTop=n.offsetTop))});else if(e.code==="Space"&&this.currentSuggestionIndex!==-1){e.preventDefault();const t=this.suggestions[this.currentSuggestionIndex],[n,s,...i]=this.currentInput.split(" ");s.toLowerCase()==="bypasses"?this.currentInput=`${n} ${s} ${[...i,t.split(" ").slice(-1)[0]].join(" ")}`:this.currentInput=t,this.suggestions=[],this.currentSuggestionIndex=-1}},async generateSuggestions(){var i;if(this.isShellMenu){this.suggestions=[];return}const e=this.currentInput.toLowerCase().trim();if(!e){this.suggestions=[];return}const t=e.split(" ");let n=[],s=[];if(e.startsWith("usemodule")){const a=e.replace("usemodule","").trim();n=this.allModules.filter(u=>te(a,u.id.toLowerCase())).map(u=>`usemodule ${u.id}`)}if(this.currentModule){if(t[0]==="set"){const a=((i=t[1])==null?void 0:i.toLowerCase())||"",o=t.slice(2).join(" ")||"",u=Object.keys(this.moduleOptions).reduce((c,d)=>(c[d.toLowerCase()]=this.moduleOptions[d],c),{});if(a.toLowerCase()==="listener")n=this.listeners.filter(c=>te(o,c.name.toLowerCase())).map(c=>`set Listener ${c.name}`);else if(a==="bypasses"){const c=o.split(" ").map(d=>d.trim().toLowerCase()).filter(d=>d!=="");n=this.bypassStore.bypassNames.filter(d=>!c.includes(d.toLowerCase())).map(d=>{const p=c.join(" ");return`set Bypasses ${p}${p?" ":""}${d}`})}else{const c=u[a];c&&c.suggested_values?n=c.suggested_values.filter(d=>te(o,d.toLowerCase())).map(d=>`set ${a} ${d}`):t[2]||(n=Object.keys(this.moduleOptions).filter(d=>d!=="Agent"&&te(a.toLowerCase(),d.toLowerCase())).map(d=>`set ${d}`))}}else t[0]==="unset"&&(n=Object.keys(this.moduleOptions).filter(a=>a!=="Agent"&&te((t[1]||"").toLowerCase(),a.toLowerCase())).map(a=>`unset ${a}`));s=this.moduleHelpCommands.map(a=>a.command.toLowerCase()).filter(a=>te(e,a)).map(a=>a)}else s=this.helpCommands.map(a=>a.command.toLowerCase()).filter(a=>te(e,a)).map(a=>a);this.suggestions=[...new Set([...n,...s])]},processCommand(){if(this.suggestions.length>0&&this.currentSuggestionIndex!==-1){this.currentInput=this.suggestions[this.currentSuggestionIndex],this.suggestions=[],this.currentSuggestionIndex=-1;return}if(!this.currentInput.trim()){this.addLine(""),this.addLine(this.currentPrompt),this.currentInput="";return}this.suggestions=[],this.addLine(`${this.currentPrompt} ${this.currentInput}`);const e=this.currentInput.split(" "),t=e[0],n=e.slice(1);if(this.isShellMenu)this.shellCommandOperator(this.currentInput);else if(t==="back")this.currentModule?this.currentModule=null:this.addLine("Already at the main menu.");else if(this.currentInput==="info")this.currentModule?(this.addLine(`${this.colorizeText("Module:","green")} ${this.currentModule.name}`,"indent-5-spaces"),this.addLine(`${this.colorizeText("Description:","green")} ${this.currentModule.description}`,"indent-5-spaces")):this.addLine("No module is currently selected.");else if(this.currentInput==="options")this.currentModule?this.displayModuleOptions():this.addLine("No module is currently selected.");else if(this.currentModule&&Object.keys(this.moduleOptions).includes(this.currentInput))this.displayOptionValue(this.currentInput);else if(this.currentModule)switch(t){case"set":this.setModuleOption(n[0],n.slice(1).join(" "));break;case"execute":this.executeCurrentModule();break;case"unset":this.unsetModuleOption(n[0]);break;case"generate":this.executeCurrentModule();break;default:switch(this.currentInput){case"help":this.displayHelpMenu();break;case"clear":this.outputLines=[];break;default:this.addError(`Command '${this.currentInput}' not found.`);break}}else switch(t){case"whoami":this.runShellCommand("whoami");break;case"usemodule":this.useModule(n[0]);break;case"sysinfo":this.getSysInfo();break;case"jobs":this.pollJobsEndpoint();break;case"shell":n.length<1?(this.isShellMenu=!0,this.updateCurrentDirectory(),this.addInfo(`Shell session started on ${this.agent.session_id}`),this.addInfo("Exit shell menu with Ctrl+C.")):this.runShellCommand(e.slice(1).join(" "));break;case"ps":this.runShellCommand("ps");break;case"sc":this.executeScreenshotModule();break;case"set":this.setModuleOption(n[0],n.slice(1).join(" "));break;case"sherlock":this.executeSherlockModule();break;case"revtoself":this.executeRevToSelfModule();break;case"execute":this.executeCurrentModule();break;case"socks":if(this.agent.language==="ironpython"){const s=n.length>0?n[0]:1080;Oi(this.agent.session_id,s).then(()=>{this.addInfo(`SOCKS proxy created on port ${s}`)}).catch(i=>{this.addError(`Error creating SOCKS proxy: ${i.message}`)})}else this.addError("Use Invoke-Socks Proxy module for non-Ironpython Agents.");break;case"sleep":if(n.length<2)this.addError("Invalid command. Usage: sleep <delay> <jitter>");else{const[s,i]=n;ft(this.agent.session_id,s,i),this.addLine(`Tasked agent to sleep delay/jitter ${s}/${i}`)}break;default:switch(this.currentInput){case"help":this.displayHelpMenu();break;case"clear":this.outputLines=[];break;default:this.addError(`Command '${this.currentInput}' not found.`);break}}this.currentInput.trim()&&(this.commandHistory.push(this.currentInput),this.historyIndex=this.commandHistory.length),this.currentInput=""},unsetModuleOption(e){if(!this.currentModule){this.addError("No module is currently selected.");return}if(!this.moduleOptions[e]){this.addError(`Option "${e}" not found in module ${this.currentModule.name}.`);return}this.moduleOptions[e].value=null,this.addInfo(`Unset ${e}.`)},async executeRevToSelfModule(){try{const e=this.agent.session_id,t=await Fe("powershell_credentials_tokens",{RevToSelf:!0,Agent:e},!1,!1);this.pollForResult(t.id),this.addInfo("RevToSelf module executed")}catch(e){this.addError(`Error executing command: ${e.message}`)}},async executeSherlockModule(){try{const e=this.agent.session_id,t=await Fe("powershell_privesc_sherlock",{Agent:e},!1,!1);this.pollForResult(t.id),this.addInfo("Sherlock module executed")}catch(e){this.addError(`Error executing command: ${e.message}`)}},async pollJobsEndpoint(){try{const e=await _n(this.agent.session_id);this.pollForResult(e.id),this.addInfo("Polling jobs endpoint...")}catch(e){this.addError(`Error polling jobs endpoint: ${e.message}`)}},async runShellCommand(e){if(!this.agent||!this.agent.session_id){this.addError("Error: agent data is not available.");return}const t=e.startsWith("--literal")||e.startsWith("-l");t&&(e=e.replace("--literal","").replace("-l","").trim());try{const n=await $e(this.agent.session_id,e,t);this.pollForResult(n.id)}catch(n){this.addError(`Error executing command: ${n.message}`)}},async pollForResult(e,t={print:!0,attempts:30,delay:5e3}){t.attempts||(t.attempts=30),t.delay=Math.max(t.delay||(this.agent.delay!=null?this.agent.delay*1e3:5e3),1e3);let n=null,s=!1,i=0,a=!1;for(;i<t.attempts;){if(n=await this.checkTaskComplete(e),n)if(n.toLowerCase().includes("job started"))s||(this.addLine(n,"indent-5-spaces"),s=!0);else{t.print&&this.addLine(n,"indent-5-spaces"),a=!0;break}await Dt(t.delay),i++}return a||this.addInfo(`No output received for task ${e}.`),n},getDirectoryCommand(){return this.agent.language==="python"?"echo $PWD":this.agent.language==="ironpython"?"cd .":"(Resolve-Path .\\).Path"},async updateCurrentDirectory(){this.currentDir="loading...";const e=await $e(this.agent.session_id,this.getDirectoryCommand());await this.pollForResult(e.id,{print:!1})&&(this.currentDir=(await this.checkTaskComplete(e.id)).split("\r")[0])},async shellCommandOperator(e){let t=null;e.trim()==="sysinfo"?t=await Be(this.agent.session_id):t=await $e(this.agent.session_id,e,!1);const n=await this.pollForResult(t.id,{print:!1});if(["cd","set-location"].includes(e.toLowerCase().split(" ")[0])){this.updateCurrentDirectory();return}n&&this.addLine(n,"indent-5-spaces")},async checkTaskComplete(e){try{const t=await vn(this.agent.session_id,e);return t.output?t.output:!1}catch{return!1}},addLine(e,t="preserve-newlines"){this.outputLines.push({content:e,cssClasses:t}),this.scrollToBottom()},addError(e){this.addLine(e,"error-text")},addInfo(e){this.addLine(e,"info-text")},scrollToBottom(){this.$nextTick(()=>{const e=this.$refs.output;e.scrollTop=e.scrollHeight})},displayTable(e){e.split(`
`).forEach(t=>{this.addLine(t,"indent-5-spaces")})},ansiToHTML(e){let t=e;return t=new Zi().ansi_to_html(t),t},async useModule(e){const t=this.allModules.find(n=>n.id===e);if(!t){this.addError(`Module with name '${e}' not found.`);return}this.currentModule=t,this.moduleOptions=t.options||{},this.currentOptions={...this.moduleOptions},this.addLine(`${this.colorizeText("Module:","green")} ${t.name}`,"indent-5-spaces"),this.addLine(`${this.colorizeText("Description:","green")} ${t.description}`,"indent-5-spaces"),this.displayModuleOptions()},displayModuleOptions(){this.moduleOptions.Agent&&(this.moduleOptions.Agent.value=this.agent.session_id);const e={...this.tableConfig,columns:{1:{width:20},2:{width:8},3:{width:40}}},t=[[this.colorizeText("Option Name","green"),this.colorizeText("Value","green"),this.colorizeText("Required","green"),this.colorizeText("Description","green")]];Object.entries(this.moduleOptions).forEach(([s,i])=>{s!=="Agent"&&t.push([s,i.value,i.required,i.description])});const n=gt.table(t,e);this.displayTable(n),this.addInfo('Use "set <option_name> <value>" to set an option value.')},displayOptionValue(e){const t=this.moduleOptions[e],n=t&&t.value?t.value:"N/A";this.addLine(`${this.colorizeText(e,"green")}: ${n}`)},setModuleOption(e,t){if(!this.currentModule){this.addError("No module is currently selected.");return}const s=Object.keys(this.moduleOptions).reduce((i,a)=>(i[a.toLowerCase()]=a,i),{})[e.toLowerCase()];if(!s){this.addError(`Option "${e}" not found in module ${this.currentModule.name}.`);return}if(s==="Agent"){this.addError("Error: Cannot set the Agent option.");return}this.moduleOptions[s].value=t,this.addInfo(`Set ${s} to ${t}.`)},async executeCurrentModule(){if(!this.currentModule){this.addError("No module is currently selected.");return}(!this.moduleOptions.Agent||!this.moduleOptions.Agent.value)&&(this.moduleOptions.Agent={value:this.agent.session_id,required:!0});const e=Object.entries(this.moduleOptions).filter(([t,n])=>n.required&&!n.value).map(([t,n])=>t);if(e.length>0){this.addError(`Missing required options: ${e.join(", ")}`);return}this.addInfo(`Executing module ${this.currentModule.name}...`);try{const t=Object.entries(this.moduleOptions).reduce((s,[i,a])=>(s[i]=a.value,s),{});let n;try{n=await Fe(this.currentModule.id,t,!1,!1)}catch(s){this.addError(`Error executing module: ${s.error}`);return}this.currentModule=null,this.moduleOptions={},this.pollForResult(n.id)}catch(t){this.addError(`Error executing module: ${t.message}`)}},async getSysInfo(){const e=await Be(this.agent.session_id);this.pollForResult(e.id)},displayHelpMenu(){this.currentModule&&(this.helpCommands=this.moduleHelpCommands);const e={...this.tableConfig,columns:{1:{width:40},2:{width:40}}},t=[[this.colorizeText("Command","green"),this.colorizeText("Description","green"),this.colorizeText("Usage","green")]];this.helpCommands.forEach(n=>{t.push([n.command,n.description,n.usage])}),this.displayTable(gt.table(t,e))},colorizeText(e,t=""){let n="";const s="\x1B[1m";switch(t.toLowerCase()){case"red":n="\x1B[91m";break;case"green":n="\x1B[92m";break;case"blue":n="\x1B[94m";break;case"yellow":n="\x1B[93m";break;case"white":n="\x1B[97m";break;default:return e}return`${s}${n}${e}\x1B[0m`},async executeScreenshotModule(){try{const e=this.agent.session_id,t=await Fe("powershell_collection_screenshot",{Ratio:80,Agent:e},!1,!1);this.pollForResult(t.id),this.addInfo("Screenshot saved to downloads")}catch(e){this.addError(`Error executing command: ${e.message}`)}}}};var Ta=function(){var t=this,n=t._self._c;return n("div",[n("div",{staticClass:"terminal-container"},[n("div",{ref:"output",staticClass:"terminal-output"},t._l(t.outputLines,function(s,i){return n("div",{key:i,class:s.cssClasses,staticStyle:{"white-space":"pre-wrap"},domProps:{innerHTML:t._s(t.ansiToHTML(s.content))}})}),0),n("div",{staticClass:"terminal-input"},[n("span",{staticClass:"prompt",domProps:{innerHTML:t._s(t.ansiToHTML(t.currentPrompt))}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.currentInput,expression:"currentInput"}],ref:"inputField",domProps:{value:t.currentInput},on:{keyup:[function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"c",void 0,s.key,void 0)||!s.ctrlKey?null:(s.preventDefault(),s.stopPropagation(),t.ctrlCHandler.apply(null,arguments))},function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.processCommand.apply(null,arguments)}],keydown:t.handleKeyEvents,input:function(s){s.target.composing||(t.currentInput=s.target.value)}}})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.suggestions.length,expression:"suggestions.length"}],ref:"suggestionList",staticClass:"autocomplete-suggestions"},t._l(t.suggestions,function(s,i){return n("div",{key:i,staticClass:"suggestion",class:{highlighted:i===t.currentSuggestionIndex},on:{click:function(a){return t.applySuggestion(s)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.applySuggestion(s)}}},[t._v(" "+t._s(s)+" ")])}),0)])},ja=[],Ra=X(Aa,Ta,ja,!1,null,"d607211e",null,null);const Gn=Ra.exports;const La={props:{agent:{type:Object,required:!0}},data(){return{loading:!1,form:{command:"",literal:!1},literal:{disabled:!1,tooltipText:"This will ensure that aliased commands such as whoami or ps do not execute the built-in agent aliases."},commands:[]}},watch:{},methods:{async submit(){this.form.command.length<1||(this.loading=!0,this.form.command.trim()==="sysinfo"?await Be(this.agent.session_id):await $e(this.agent.session_id,this.form.command,this.form.literal),this.form.command="",this.loading=!1,this.$snack.success(`Shell Command queued for ${this.agent.name}`))}}};var Oa=function(){var t=this,n=t._self._c;return n("div",{staticStyle:{padding:"10px"}},[n(Ct,{ref:"form",staticClass:"form",nativeOn:{submit:function(s){return s.preventDefault(),t.submit.apply(null,arguments)}}},[n(wn,[n(Ft,[n(he,{attrs:{cols:"10"}},[n("div",{staticStyle:{display:"flex"}},[n(zi,{staticClass:"pr-2",attrs:{label:"Literal",disabled:t.literal.disabled},model:{value:t.form.literal,callback:function(s){t.$set(t.form,"literal",s)},expression:"form.literal"}}),n(kt,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s}){return[n(W,t._g({staticClass:"pr-2",attrs:{small:""}},s),[t._v(" fa-question-circle ")])]}}])},[n("p",[t._v(t._s(t.literal.tooltipText))])]),n(de,{attrs:{dense:"",outlined:"",label:"Shell Command"},model:{value:t.form.command,callback:function(s){t.$set(t.form,"command",s)},expression:"form.command"}})],1)]),n(he,{attrs:{cols:"2",md:"2"}},[n(Y,{attrs:{color:"primary",loading:t.loading,type:"submit"}},[t._v(" Run ")])],1)],1)],1)],1)],1)},za=[],Na=X(La,Oa,za,!1,null,"28348e4a",null,null);const Zn=Na.exports,Ia={props:{value:Boolean,loading:{type:Boolean,default:!1}},data(){return{pathToFile:"",rules:{pathToFile:[e=>!!e||"PathToFile is required"]}}},computed:{show:{get(){return this.value},set(e){this.$emit("input",e)}}},watch:{value(e){e===!1&&this.$refs.form.reset()}},methods:{async submit(){this.$refs.form.validate()&&this.$emit("submit",{pathToFile:this.pathToFile})}}};var qa=function(){var t=this,n=t._self._c;return n(vt,{ref:"downloadDialog",attrs:{"max-width":"500px"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[n(Q,[n(_t,[n("span",{staticClass:"headline"},[t._v("Download")])]),n(Te,[n(Ct,{ref:"form",on:{submit:function(s){s.preventDefault()}}},[n(wn,[n(Ft,[n(he,{attrs:{cols:"12"}},[n(de,{attrs:{label:"path/to/file",rules:t.rules.pathToFile,outlined:"",dense:"",required:""},model:{value:t.pathToFile,callback:function(s){t.pathToFile=s},expression:"pathToFile"}})],1)],1)],1)],1)],1),n(wt,[n(pe),n(Y,{attrs:{color:"blue darken-1",text:""},on:{click:function(s){s.stopPropagation(),t.show=!1}}},[t._v(" Close ")]),n(Y,{attrs:{color:"blue darken-1",text:"",loading:t.loading},on:{click:t.submit}},[t._v(" Save ")])],1)],1)],1)},Ha=[],Va=X(Ia,qa,Ha,!1,null,null,null,null);const Kn=Va.exports,ht=1048576,Wa={components:{FileInput:kn},props:{value:Boolean,language:{type:String,default:""},loading:{type:Boolean,default:!1},pathToFile:{type:String,default:""}},data(){return{formatBytes:Yi,maxBytes:ht,descriptionLimit:80,entries:[],internalPathToFile:this.pathToFile,file:null,rules:{pathToFile:[e=>!!e||"PathToFile is required"],fileInput:[e=>!!e||"File required",e=>!!e&&e.size<ht||`Maximum size of ${Math.floor(ht/1e6)} MiB.`]}}},computed:{show:{get(){return this.value},set(e){this.$emit("input",e)}},fileName(){return this.file?this.file.filename:""},fileId(){return this.file?this.file.id:""},submitDisabled(){return!this.file||!this.internalPathToFile||this.loading}},watch:{pathToFile(e){this.internalPathToFile=e},value(e){e===!1&&(this.file=null,this.internalPathToFile=null)},fileName(e){e&&(["python","ironpython"].includes(this.language.toLowerCase())?this.pathToFile?this.internalPathToFile=this.addTrailingSlash(this.pathToFile)+e:this.internalPathToFile=`/tmp/${e}`:["powershell","csharp"].includes(this.language.toLowerCase())&&(this.pathToFile?this.internalPathToFile=this.addTrailingSlash(this.pathToFile)+e:this.internalPathToFile=`C:\\tmp\\${e}`))}},methods:{addTrailingSlash(e){return e.endsWith("/")||e.endsWith("\\")?e:["python","ironpython"].includes(this.language.toLowerCase())?`${e}/`:`${e}\\`},async submit(){this.$emit("submit",{file:this.fileId,pathToFile:this.internalPathToFile})}}};var Ua=function(){var t=this,n=t._self._c;return n(vt,{ref:"agentUploadDialog",attrs:{"max-width":"750px"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[n(Q,[n(_t,[n("span",{staticClass:"headline"},[t._v("Upload To Agent")])]),n(Te,[n("p",[t._v("Only showing files smaller than "+t._s(t.formatBytes(t.maxBytes)))]),n(kn,{attrs:{rules:t.rules.fileInput,"maximum-file-size":t.maxBytes,"return-object":""},model:{value:t.file,callback:function(s){t.file=s},expression:"file"}}),n(de,{attrs:{label:"path/to/file (On the agent's machine)",rules:t.rules.pathToFile,outlined:"",dense:"",required:"",disabled:!t.file},model:{value:t.internalPathToFile,callback:function(s){t.internalPathToFile=s},expression:"internalPathToFile"}})],1),n(wt,[n(pe),n(Y,{attrs:{color:"blue darken-1",text:""},on:{click:function(s){s.stopPropagation(),t.show=!1}}},[t._v(" Close ")]),n(Y,{attrs:{color:"blue darken-1",text:"",loading:t.loading,disabled:t.submitDisabled},on:{click:t.submit}},[t._v(" Upload ")])],1)],1)],1)},Ya=[],Ja=X(Wa,Ua,Ya,!1,null,null,null,null);const Xn=Ja.exports;var Ga=Object.defineProperty,Za=Object.defineProperties,Ka=Object.getOwnPropertyDescriptors,Me=Object.getOwnPropertySymbols,Qn=Object.prototype.hasOwnProperty,ei=Object.prototype.propertyIsEnumerable,hn=(e,t,n)=>t in e?Ga(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xa=(e,t)=>{for(var n in t||(t={}))Qn.call(t,n)&&hn(e,n,t[n]);if(Me)for(var n of Me(t))ei.call(t,n)&&hn(e,n,t[n]);return e},Qa=(e,t)=>Za(e,Ka(t)),eo=(e,t)=>{var n={};for(var s in e)Qn.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&Me)for(var s of Me(e))t.indexOf(s)<0&&ei.call(e,s)&&(n[s]=e[s]);return n};function ti(e,t,n,s,i,a,o,u){var c=typeof e=="function"?e.options:e;t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),s&&(c.functional=!0),a&&(c._scopeId="data-v-"+a);var d;if(o?(d=function(g){g=g||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!g&&typeof __VUE_SSR_CONTEXT__<"u"&&(g=__VUE_SSR_CONTEXT__),i&&i.call(this,g),g&&g._registeredComponents&&g._registeredComponents.add(o)},c._ssrRegister=d):i&&(d=u?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),d)if(c.functional){c._injectStyles=d;var p=c.render;c.render=function(b,w){return d.call(w),p(b,w)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,d):[d]}return{exports:e,options:c}}const to={name:"splitpanes",props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce((e,t)=>(e[t.id]=t)&&e,{})}},methods:{updatePaneComponents(){this.panes.forEach(e=>{e.update&&e.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[e.id].size}%`})})},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(e,t){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=t},onMouseMove(e){this.touch.mouseDown&&(e.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(e)),this.$emit("resize",this.panes.map(t=>({min:t.min,max:t.max,size:t.size}))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map(e=>({min:e.min,max:e.max,size:e.size}))),this.touch.mouseDown=!1,setTimeout(()=>{this.touch.dragging=!1,this.unbindEvents()},100)},onSplitterClick(e,t){"ontouchstart"in window&&(e.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===t?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(e,t),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=t,this.splitterTaps.timeoutId=setTimeout(()=>{this.splitterTaps.splitter=null},500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[t])},onSplitterDblClick(e,t){let n=0;this.panes=this.panes.map((s,i)=>(s.size=i===t?s.max:s.min,i!==t&&(n+=s.min),s)),this.panes[t].size-=n,this.$emit("pane-maximize",this.panes[t])},onPaneClick(e,t){this.$emit("pane-click",this.indexedPanes[t])},getCurrentMouseDrag(e){const t=this.container.getBoundingClientRect(),{clientX:n,clientY:s}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:n-t.left,y:s-t.top}},getCurrentDragPercentage(e){e=e[this.horizontal?"y":"x"];const t=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(e=t-e),e*100/t},calculatePanesSize(e){const t=this.touch.activeSplitter;let n={prevPanesSize:this.sumPrevPanesSize(t),nextPanesSize:this.sumNextPanesSize(t),prevReachedMinPanes:0,nextReachedMinPanes:0};const s=0+(this.pushOtherPanes?0:n.prevPanesSize),i=100-(this.pushOtherPanes?0:n.nextPanesSize),a=Math.max(Math.min(this.getCurrentDragPercentage(e),i),s);let o=[t,t+1],u=this.panes[o[0]]||null,c=this.panes[o[1]]||null;const d=u.max<100&&a>=u.max+n.prevPanesSize,p=c.max<100&&a<=100-(c.max+this.sumNextPanesSize(t+1));if(d||p){d?(u.size=u.max,c.size=Math.max(100-u.max-n.prevPanesSize-n.nextPanesSize,0)):(u.size=Math.max(100-c.max-n.prevPanesSize-this.sumNextPanesSize(t+1),0),c.size=c.max);return}if(this.pushOtherPanes){const f=this.doPushOtherPanes(n,a);if(!f)return;({sums:n,panesToResize:o}=f),u=this.panes[o[0]]||null,c=this.panes[o[1]]||null}u!==null&&(u.size=Math.min(Math.max(a-n.prevPanesSize-n.prevReachedMinPanes,u.min),u.max)),c!==null&&(c.size=Math.min(Math.max(100-a-n.nextPanesSize-n.nextReachedMinPanes,c.min),c.max))},doPushOtherPanes(e,t){const n=this.touch.activeSplitter,s=[n,n+1];return t<e.prevPanesSize+this.panes[s[0]].min&&(s[0]=this.findPrevExpandedPane(n).index,e.prevReachedMinPanes=0,s[0]<n&&this.panes.forEach((i,a)=>{a>s[0]&&a<=n&&(i.size=i.min,e.prevReachedMinPanes+=i.min)}),e.prevPanesSize=this.sumPrevPanesSize(s[0]),s[0]===void 0)?(e.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach((i,a)=>{a>0&&a<=n&&(i.size=i.min,e.prevReachedMinPanes+=i.min)}),this.panes[s[1]].size=100-e.prevReachedMinPanes-this.panes[0].min-e.prevPanesSize-e.nextPanesSize,null):t>100-e.nextPanesSize-this.panes[s[1]].min&&(s[1]=this.findNextExpandedPane(n).index,e.nextReachedMinPanes=0,s[1]>n+1&&this.panes.forEach((i,a)=>{a>n&&a<s[1]&&(i.size=i.min,e.nextReachedMinPanes+=i.min)}),e.nextPanesSize=this.sumNextPanesSize(s[1]-1),s[1]===void 0)?(e.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach((i,a)=>{a<this.panesCount-1&&a>=n+1&&(i.size=i.min,e.nextReachedMinPanes+=i.min)}),this.panes[s[0]].size=100-e.prevPanesSize-e.nextReachedMinPanes-this.panes[this.panesCount-1].min-e.nextPanesSize,null):{sums:e,panesToResize:s}},sumPrevPanesSize(e){return this.panes.reduce((t,n,s)=>t+(s<e?n.size:0),0)},sumNextPanesSize(e){return this.panes.reduce((t,n,s)=>t+(s>e+1?n.size:0),0)},findPrevExpandedPane(e){return[...this.panes].reverse().find(n=>n.index<e&&n.size>n.min)||{}},findNextExpandedPane(e){return this.panes.find(n=>n.index>e+1&&n.size>n.min)||{}},checkSplitpanesNodes(){Array.from(this.container.children).forEach(t=>{const n=t.classList.contains("splitpanes__pane"),s=t.classList.contains("splitpanes__splitter");if(!n&&!s){t.parentNode.removeChild(t),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed.");return}})},addSplitter(e,t,n=!1){const s=e-1,i=document.createElement("div");i.classList.add("splitpanes__splitter"),n||(i.onmousedown=a=>this.onMouseDown(a,s),typeof window<"u"&&"ontouchstart"in window&&(i.ontouchstart=a=>this.onMouseDown(a,s)),i.onclick=a=>this.onSplitterClick(a,s+1)),this.dblClickSplitter&&(i.ondblclick=a=>this.onSplitterDblClick(a,s+1)),t.parentNode.insertBefore(i,t)},removeSplitter(e){e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.parentNode.removeChild(e)},redoSplitters(){const e=Array.from(this.container.children);e.forEach(n=>{n.className.includes("splitpanes__splitter")&&this.removeSplitter(n)});let t=0;e.forEach(n=>{n.className.includes("splitpanes__pane")&&(!t&&this.firstSplitter?this.addSplitter(t,n,!0):t&&this.addSplitter(t,n),t++)})},requestUpdate(e){var t=e,{target:n}=t,s=eo(t,["target"]);const i=this.indexedPanes[n._uid];Object.entries(s).forEach(([a,o])=>i[a]=o)},onPaneAdd(e){let t=-1;Array.from(e.$el.parentNode.children).some(i=>(i.className.includes("splitpanes__pane")&&t++,i===e.$el));const n=parseFloat(e.minSize),s=parseFloat(e.maxSize);this.panes.splice(t,0,{id:e._uid,index:t,min:isNaN(n)?0:n,max:isNaN(s)?100:s,size:e.size===null?null:parseFloat(e.size),givenSize:e.size,update:e.update}),this.panes.forEach((i,a)=>i.index=a),this.ready&&this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[t]}),this.$emit("pane-add",{index:t,panes:this.panes.map(i=>({min:i.min,max:i.max,size:i.size}))})})},onPaneRemove(e){const t=this.panes.findIndex(s=>s.id===e._uid),n=this.panes.splice(t,1)[0];this.panes.forEach((s,i)=>s.index=i),this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:Qa(Xa({},n),{index:t})}),this.$emit("pane-remove",{removed:n,panes:this.panes.map(s=>({min:s.min,max:s.max,size:s.size}))})})},resetPaneSizes(e={}){!e.addedPane&&!e.removedPane?this.initialPanesSizing():this.panes.some(t=>t.givenSize!==null||t.min||t.max<100)?this.equalizeAfterAddOrRemove(e):this.equalize(),this.ready&&this.$emit("resized",this.panes.map(t=>({min:t.min,max:t.max,size:t.size})))},equalize(){const e=100/this.panesCount;let t=0,n=[],s=[];this.panes.forEach(i=>{i.size=Math.max(Math.min(e,i.max),i.min),t-=i.size,i.size>=i.max&&n.push(i.id),i.size<=i.min&&s.push(i.id)}),t>.1&&this.readjustSizes(t,n,s)},initialPanesSizing(){100/this.panesCount;let e=100,t=[],n=[],s=0;this.panes.forEach(a=>{e-=a.size,a.size!==null&&s++,a.size>=a.max&&t.push(a.id),a.size<=a.min&&n.push(a.id)});let i=100;e>.1&&(this.panes.forEach(a=>{a.size===null&&(a.size=Math.max(Math.min(e/(this.panesCount-s),a.max),a.min)),i-=a.size}),i>.1&&this.readjustSizes(e,t,n))},equalizeAfterAddOrRemove({addedPane:e,removedPane:t}={}){let n=100/this.panesCount,s=0,i=[],a=[];e&&e.givenSize!==null&&(n=(100-e.givenSize)/(this.panesCount-1)),this.panes.forEach(o=>{s-=o.size,o.size>=o.max&&i.push(o.id),o.size<=o.min&&a.push(o.id)}),!(Math.abs(s)<.1)&&(this.panes.forEach(o=>{e&&e.givenSize!==null&&e.id===o.id||(o.size=Math.max(Math.min(n,o.max),o.min)),s-=o.size,o.size>=o.max&&i.push(o.id),o.size<=o.min&&a.push(o.id)}),s>.1&&this.readjustSizes(s,i,a))},readjustSizes(e,t,n){let s;e>0?s=e/(this.panesCount-t.length):s=e/(this.panesCount-n.length),this.panes.forEach((i,a)=>{if(e>0&&!t.includes(i.id)){const o=Math.max(Math.min(i.size+s,i.max),i.min),u=o-i.size;e-=u,i.size=o}else if(!n.includes(i.id)){const o=Math.max(Math.min(i.size+s,i.max),i.min),u=o-i.size;e-=u,i.size=o}i.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[i.id].size}%`})}),Math.abs(e)>.1&&this.$nextTick(()=>{this.ready&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(e){[...this.container.querySelectorAll(".splitpanes__splitter")].forEach((n,s)=>{n.ondblclick=e?i=>this.onSplitterDblClick(i,s):void 0})}},beforeDestroy(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.$emit("ready"),this.ready=!0},render(e){return e("div",{ref:"container",class:["splitpanes",`splitpanes--${this.horizontal?"horizontal":"vertical"}`,{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default)}};let no,io;const pn={};var ro=ti(to,no,io,!1,so,null,null,null);function so(e){for(let t in pn)this[t]=pn[t]}var ao=function(){return ro.exports}(),oo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"splitpanes__pane",style:e.style,on:{click:function(s){return e.onPaneClick(s,e._uid)}}},[e._t("default")],2)},lo=[];const uo={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:null},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeDestroy(){this.onPaneRemove(this)},methods:{update(e){this.style=e}},computed:{sizeNumber(){return this.size||this.size===0?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(e){this.requestUpdate({target:this,size:e})},minSizeNumber(e){this.requestUpdate({target:this,min:e})},maxSizeNumber(e){this.requestUpdate({target:this,max:e})}}},fn={};var co=ti(uo,oo,lo,!1,ho,null,null,null);function ho(e){for(let t in fn)this[t]=fn[t]}var po=function(){return co.exports}();const fo={name:"AgentEdit",components:{AgentForm:An,AgentInteract:Zn,AgentExecuteModule:je,AgentFileBrowser:jn,AgentTasksList:$n,AgentTerminal:Gn,AgentUploadDialog:Xn,AgentDownloadDialog:Kn,TooltipButton:J,TooltipButtonToggle:Sn,ErrorStateAlert:Fn,Splitpanes:ao,Pane:po},data(){return{agent:{},nameLoading:!1,uploadLoading:!1,downloadLoading:!1,scriptImportLoading:!1,nameDialog:!1,uploadDialog:!1,downloadDialog:!1,scriptImportDialog:!1,initialized:!0,errorState:!1,paneSize:100,rightPaneInitialized:!1,pathToFile:"",isRefreshTasks:!0,interactTab:"form"}},computed:{agentStore(){return yn()},subscribedAgents(){return this.agentStore.subscribed},subscribed(){return this.subscribedAgents[this.id]||!1},breads(){return[{text:"Agents",disabled:this.isChild,to:"/agents",exact:!0},{text:this.breadcrumbName,disabled:!0,to:"/agent-edit"}]},archived(){return this.agent.archived},breadcrumbName(){return this.agent.name||this.id},id(){return this.$route.params.id},isChild(){return!!this.$route.query.hideSideBar},hideSideBar(){return this.$route.query.hideSideBar},tab:{set(e){this.$router.replace({query:{...this.$route.query,tab:e}})},get(){return this.$route.query.tab||"interact"}}},watch:{id(e){e&&this.getAgent(e)},paneSize(e){this.rightPaneInitialized||e<99&&(this.rightPaneInitialized=!0)},uploadDialog(e){e||(this.pathToFile="")}},mounted(){this.getAgent(this.$route.params.id)},methods:{subscribe(){this.agentStore.subscribe({sessionId:this.id})},unsubscribe(){this.agentStore.unsubscribe({sessionId:this.id})},async reloadSysInfo(){try{await Be(this.agent.session_id),this.$snack.success(`SysInfo reload queued for ${this.agent.name}`)}catch(e){this.$snack.error(`Error reloading SysInfo for ${this.agent.name}: ${e.message}`)}},async getAgentTasks(){try{await _n(this.agent.session_id),this.$snack.success(`Task list queued for ${this.agent.name}`)}catch(e){this.$snack.error(`Error getting jobs for ${this.agent.name}: ${e.message}`)}},toggleCollapsePane(){this.paneSize>95?this.paneSize=50:this.paneSize=100},splitPaneHeight(){return`height: calc(96vh - 104px ${this.isChild?"":"- 36px"})`},popout(){window.open(`${window.location.href}/?hideSideBar=true`,"popup","width=600,height=600"),this.$router.push({name:"agents"})},getAgent(e){Ni(e).then(t=>{this.agent=t}).catch(()=>{this.errorState=!0})},async killAgent(){await this.$root.$confirm("Kill Agent",`Do you want to kill agent ${this.agent.name}?`,{color:"red"})&&(this.agentStore.killAgent({sessionId:this.agent.session_id}),this.$snack.success(`Agent ${this.agent.name} tasked to run TASK_EXIT.`),this.$router.push({name:"agents"}))},async clearQueue(){const t=(await Ii(this.agent.session_id,{limit:-1,page:1,status:"queued"})).records.map(n=>n.id);if(t.length===0){this.$snack.info("No queued tasks to clear.");return}await this.$root.$confirm("",`Do you want to clear ${t.length} queued tasks?`,{color:"red"})&&(this.agentStore.clearQueue({sessionId:this.agent.session_id,tasks:t}),this.$snack.success(`Clearing queued tasks for Agent ${this.agent.session_id}.`))},openUploadDialogPrefilled({pathToFile:e}){this.uploadDialog=!0,this.pathToFile=e},async doUpload({file:e,pathToFile:t}){if(!(this.uploadLoading||e==null||t==null||t.length<1)){this.uploadLoading=!0;try{await qi(this.agent.session_id,e,t),this.$snack.success(`Tasked agent ${this.agent.name} to upload file to ${t}`)}catch(n){this.$snack.error(`Error: ${n}`)}this.uploadLoading=!1,this.uploadDialog=!1}},async doDownload({pathToFile:e}){if(!(this.downloadLoading||e==null||e.length<1)){this.downloadLoading=!0;try{await Cn(this.agent.session_id,e),this.$snack.success(`Tasked agent ${this.agent.name} to downloaded file ${e}`)}catch(t){this.$snack.error(`Error: ${t}`)}this.downloadLoading=!1,this.downloadDialog=!1}},scrollResults(){}}};var mo=function(){var t=this,n=t._self._c;return n("div",[n("div",[n("portal",{attrs:{to:"app-bar-extension"}},[n("div",{staticStyle:{display:"flex","flex-direction":"row",width:"100%"}},[n(Zt,{attrs:{"align-with-title":""},model:{value:t.tab,callback:function(s){t.tab=s},expression:"tab"}},[n(ne,{key:"interact",attrs:{href:"#interact"}},[t._v(" Interact "),n(W,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-arrow-pointer ")])],1),n(ne,{key:"file-browser",attrs:{href:"#file-browser"}},[t._v(" File Browser "),n(W,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-folder-open ")])],1),n(ne,{key:"tasks",attrs:{href:"#tasks"}},[t._v(" Tasks "),n(W,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-sticky-note ")])],1),n(ne,{key:"view",attrs:{href:"#view"}},[t._v(" View "),n(W,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-eye ")])],1)],1),n("div",{staticStyle:{display:"flex","flex-direction":"row"}},[t._e()],1)],1)]),n("portal",{attrs:{to:"app-bar"}},[n("div",{staticClass:"v-toolbar__content",staticStyle:{width:"100%"}},[n(Wi,{attrs:{items:t.breads}}),t.agent.high_integrity?n(kt,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s}){return[n(W,t._g({attrs:{small:""}},s),[t._v(" fa-user-cog ")])]}}],null,!1,1636569802)},[n("span",[t._v("Elevated Process")])]):t._e(),t.initialized&&t.archived?n(Qi,[t._v(" Archived ")]):t._e(),n(pe),!t.errorState&&t.initialized&&!t.archived?n("div",{staticClass:"pt-2",staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[n(Xn,{attrs:{language:t.agent.language,loading:t.uploadLoading,"path-to-file":t.pathToFile},on:{submit:t.doUpload},model:{value:t.uploadDialog,callback:function(s){t.uploadDialog=s},expression:"uploadDialog"}}),n(Kn,{attrs:{loading:t.downloadLoading},on:{submit:t.doDownload},model:{value:t.downloadDialog,callback:function(s){t.downloadDialog=s},expression:"downloadDialog"}}),n(Sn,{attrs:{icon:"fa-redo","button-text":t.isRefreshTasks?"On":"Off",text:"Auto-refresh Tasks"},model:{value:t.isRefreshTasks,callback:function(s){t.isRefreshTasks=s},expression:"isRefreshTasks"}}),n(J,{attrs:{icon:"fa-calendar-times",text:"Clear Queued Tasks"},on:{click:t.clearQueue}}),n(J,{attrs:{icon:"fa-upload",text:"Upload"},on:{click:function(s){t.uploadDialog=!0}}}),n(J,{attrs:{icon:"fa-download",text:"Download"},on:{click:function(s){t.downloadDialog=!0}}}),t.hideSideBar?t._e():n(J,{attrs:{icon:"fa-external-link-alt",text:"Popout"},on:{click:t.popout}}),t.subscribed?n(J,{attrs:{icon:"fa-bell-slash",text:"Unsubscribe from Notifications"},on:{click:t.unsubscribe}}):n(J,{attrs:{icon:"fa-bell",text:"Subscribe to Notifications"},on:{click:t.subscribe}}),n(J,{attrs:{icon:"fa-sync",text:"Reload SysInfo"},on:{click:t.reloadSysInfo}}),n(J,{attrs:{icon:"fa-tasks",text:"Get Agent Task Status List"},on:{click:t.getAgentTasks}}),t.initialized&&!t.archived?n(J,{attrs:{icon:"fa-trash-alt",text:"Kill Agent",color:"error"},on:{click:t.killAgent}}):t._e()],1):t._e()],1)]),t.errorState?n(Fn,{attrs:{"resource-id":t.id,"resource-type":"agent"}}):t._e(),t.errorState?t._e():n("div",{style:t.splitPaneHeight()},[n("splitpanes",{attrs:{disabled:!0},on:{resize:function(s){t.paneSize=s[0].size}}},[n("pane",{attrs:{"min-size":"30",size:t.paneSize}},[n(Kt,{staticClass:"scrollable-pane",model:{value:t.tab,callback:function(s){t.tab=s},expression:"tab"}},[n(ie,{key:"interact",attrs:{value:"interact",transition:!1,"reverse-transition":!1}},[t.initialized&&!t.archived?n(Q,{attrs:{flat:""}},[n(Zt,{attrs:{height:30,"align-with-title":""},model:{value:t.interactTab,callback:function(s){t.interactTab=s},expression:"interactTab"}},[n(ne,{key:"form",attrs:{href:"#form"}},[t._v(" Form "),n(W,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-list-check ")])],1),n(ne,{key:"terminal",attrs:{href:"#terminal"}},[t._v(" Terminal "),n(W,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-terminal ")])],1)],1),n(Kt,{model:{value:t.interactTab,callback:function(s){t.interactTab=s},expression:"interactTab"}},[n(ie,{key:"form",attrs:{value:"form",transition:!1,"reverse-transition":!1}},[n(Zn,{attrs:{agent:t.agent}}),n(Hi),n("h4",{staticClass:"pl-4 pt-2"},[t._v("Execute Module")]),n(je,{attrs:{agents:[t.agent]}})],1),n(ie,{key:"terminal",staticStyle:{height:"auto"},attrs:{value:"terminal",transition:!1,"reverse-transition":!1}},[n(Gn,{staticClass:"mt-2",attrs:{agent:t.agent}})],1)],1)],1):t.initialized&&t.archived?n(Q,{attrs:{flat:""}},[n(Te,[n(Vi,{attrs:{type:"error",icon:"fa-exclamation-triangle",value:!0}},[t._v(" This agent is archived. ")])],1)],1):t._e()],1),n(ie,{key:"browser",attrs:{value:"file-browser",transition:!1,"reverse-transition":!1}},[n(Q,{attrs:{flat:""}},[n(jn,{attrs:{agent:t.agent,"read-only":t.initialized&&t.archived},on:{openUploadDialog:t.openUploadDialogPrefilled}})],1)],1),n(ie,{key:"tasks",attrs:{value:"tasks",transition:!1,"reverse-transition":!1}},[n(Q,{attrs:{flat:""}},[n($n,{attrs:{"use-header":!1,agent:t.agent,"refresh-tasks":t.isRefreshTasks}})],1)],1),n(ie,{key:"view",attrs:{value:"view",transition:!1,"reverse-transition":!1}},[n(Q,{attrs:{flat:""}},[n(An,{attrs:{"read-only":t.initialized&&t.archived,agent:t.agent},on:{"refresh-agent":function(s){return t.getAgent(t.id)}}})],1)],1)],1)],1)],1)],1)],1)])},Do=[],go=X(fo,mo,Do,!1,null,null,null,null);const el=go.exports;export{el as default};

import{_ as u}from"./AuthorChips-e78b3e0a.js";import{_ as g}from"./ListPageTop-45935f88.js";import{V as p}from"./VueMarkdown-6e2c91f0.js";import{n as m,aI as _,aJ as h,c as i,d as P,e as f,aK as x,b as a,V as v,f as y,h as b,y as k,aL as I,a6 as n,a as r,i as o}from"./index-0d642ee6.js";import{c}from"./VSelect-bf684f23.js";import{_ as w}from"./VListItemGroup-4b98ef2e.js";import"./VTooltip-d0afbec0.js";import"./VItemGroup-69e76bc2.js";const O={name:"PluginMarketplace",components:{VueMarkdown:p,AuthorChips:u},data(){return{marketplacePlugins:[],breads:[{text:"Plugin Marketplace",disabled:!0,href:"/plugin-marketplace"}],headers:[{text:"Name",value:"name"},{text:"Description",value:"description"}],selectedPluginIndex:-1,selectedPluginRegistry:"",selectedPluginVersion:"",installing:!1}},computed:{selectedPluginObj(){var s;return this.selectedPluginIndex<0||this.selectedPluginRegistry===""?null:(s=this.marketplacePlugins[this.selectedPluginIndex])==null?void 0:s.registries[this.selectedPluginRegistry]},isSelectedInstalled(){var s;return(s=this.marketplacePlugins[this.selectedPluginIndex])==null?void 0:s.installed},registryOptions(){var s;return Object.keys((s=this.marketplacePlugins[this.selectedPluginIndex])==null?void 0:s.registries)},versionOptions(){return this.selectedPluginObj.versions},installedVersion(){var s;return(s=this.marketplacePlugins[this.selectedPluginIndex])==null?void 0:s.installed_version}},watch:{selectedPluginIndex(){var s;this.selectedPluginIndex<0||(this.selectedPluginRegistry=Object.keys((s=this.marketplacePlugins[this.selectedPluginIndex])==null?void 0:s.registries)[0],this.selectedPluginVersion=this.selectedPluginObj.versions[0].name)}},async mounted(){this.refreshMarketplace()},methods:{async refreshMarketplace(){const{records:s}=await _();this.marketplacePlugins=s.sort((e,t)=>e.name.localeCompare(t.name))},installSelectedPlugin(){this.installing=!0,h({name:this.selectedPluginObj.name,version:this.selectedPluginVersion,registry:this.selectedPluginRegistry}).catch(s=>{this.$snack.error(`Error: ${s}`)}).finally(()=>{this.installing=!1,this.refreshMarketplace()})},nameToId(s){return s.toLowerCase().replace(/[-/ ]/g,"_")}}};var C=function(){var e=this,t=e._self._c;return t("div",[t(g,{attrs:{breads:e.breads,"show-create":!1,"show-delete":!1,"show-refresh":!0},on:{refresh:e.getPlugins}}),t("div",{staticStyle:{display:"flex","flex-direction":"row"}},[t("div",{staticStyle:{width:"350px","min-width":"350px","max-width":"350px"}},[t(i,{staticClass:"pl-4 pr-4 pb-4",attrs:{elevation:"2",outlined:"",flat:""}},[t(P,{staticClass:"overflow-y-auto",staticStyle:{"max-height":"600px"},attrs:{disabled:e.installing}},[t(w,{attrs:{mandatory:"","active-class":"primary--text"},model:{value:e.selectedPluginIndex,callback:function(l){e.selectedPluginIndex=l},expression:"selectedPluginIndex"}},e._l(e.marketplacePlugins,function(l){return t(f,{key:l.name,attrs:{selectable:""}},[t(x,[l.icon?t("img",{attrs:{src:l.icon,alt:"Plugin Icon"}}):t(a,[e._v("fa-puzzle-piece")])],1),t(v,[t(y,[e._v(e._s(l.name))])],1),t(b,[e.marketplacePlugins.find(d=>d.name===l.name).installed?t(a,{attrs:{color:"green"}},[e._v(" fa-circle-check ")]):e._e()],1)],1)}),1)],1)],1)],1),t("div",{staticStyle:{"flex-grow":"1"}},[e.selectedPluginObj?t(i,{staticClass:"pl-4 pr-4 pb-4 overflow-y-auto",staticStyle:{"max-height":"600px"},attrs:{elevation:"2",outlined:"",flat:""}},[t("div",{staticStyle:{display:"flex","flex-direction":"row"}},[t("div",[t(k,[e._v(e._s(e.selectedPluginObj.name))]),t(I,[e._v(" Authors: "),t(u,{attrs:{authors:e.selectedPluginObj.authors}}),t(n),t("a",{attrs:{href:e.selectedPluginObj.homepage_url,target:"_blank",rel:"noopener noreferrer"}},[e._v(" Homepage ")]),t(n),t("a",{attrs:{href:e.selectedPluginObj.source_url,target:"_blank",rel:"noopener noreferrer"}},[e._v(" Source Code ")]),t(n)],1)],1),t(n),t("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"flex-end"}},[e.isSelectedInstalled?t("router-link",{staticClass:"text-decoration-none",staticStyle:{color:"inherit"},attrs:{to:{name:"pluginEdit",params:{id:e.nameToId(e.selectedPluginObj.name)}}}},[t(r,{staticClass:"pa-4 ma-4",attrs:{color:"primary"}},[e._v("Go To Plugin")])],1):t(r,{staticClass:"pa-4 ma-4",attrs:{color:"primary",loading:e.installing},on:{click:e.installSelectedPlugin}},[e._v(" Install ")]),t(c,{staticStyle:{width:"200px","max-width":"200px"},attrs:{disabled:e.registryOptions.length<2,label:"Registry",items:e.registryOptions,"item-text":"name","item-value":"name"},model:{value:e.selectedPluginRegistry,callback:function(l){e.selectedPluginRegistry=l},expression:"selectedPluginRegistry"}}),e.isSelectedInstalled?t("span",[t("b",[e._v("Installed Version:")]),e._v(" "+e._s(e.installedVersion)+" ")]):t(c,{staticStyle:{width:"200px","max-width":"200px"},attrs:{disabled:e.versionOptions.length<2,label:"Version",items:e.versionOptions,"item-text":"name","item-value":"name"},model:{value:e.selectedPluginVersion,callback:function(l){e.selectedPluginVersion=l},expression:"selectedPluginVersion"}})],1)],1),t(o,{staticClass:"mt-4 mb-4"}),t(i,{staticClass:"pa-4",attrs:{outlined:"",elevation:"2"}},[t("vue-markdown",{attrs:{source:e.selectedPluginObj.description}})],1),t(o,{staticClass:"mt-4 mb-4"})],1):e._e()],1)])],1)},S=[],V=m(O,C,S,!1,null,null,null,null);const E=V.exports;export{E as default};

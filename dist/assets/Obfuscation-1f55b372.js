import{_ as K}from"./ListPageTop-45935f88.js";import{J as n,K as i,L as x,as as $,n as C,x as _,c,y as d,z as u,ai as b,A as m,q as p,a as r,B as y,a6 as h,R as D,b as f,p as P,d as S,i as R,e as w,f as g,aL as T}from"./index-0d642ee6.js";import{_ as j}from"./VDataTable-330eab6e.js";import{_ as O}from"./VSwitch-2fb0a974.js";import"./VTooltip-d0afbec0.js";import"./VItemGroup-69e76bc2.js";import"./VSelect-bf684f23.js";function q(){return n.get("/obfuscation/keywords").then(({data:a})=>a.records).catch(a=>Promise.reject(i(a)))}function M(a){return n.post("/obfuscation/keywords",a).then(({data:e})=>e).catch(e=>Promise.reject(i(e)))}function A(a){return n.put(`/obfuscation/keywords/${a.id}`,a).then(({data:e})=>e).catch(e=>Promise.reject(i(e)))}function E(a){return n.delete(`/obfuscation/keywords/${a}`).then(({data:e})=>e).catch(e=>Promise.reject(i(e)))}function V(){return n.get("/obfuscation/global").then(({data:a})=>a.records).catch(a=>Promise.reject(i(a)))}function k(a){return n.put(`/obfuscation/global/${a.language}`,a).then(({data:e})=>e).catch(e=>Promise.reject(i(e)))}function L(a="powershell",e=!1){return n.post(`/obfuscation/global/${a}/preobfuscate`,{},{params:{reobfuscate:e}}).catch(t=>Promise.reject(i(t)))}function I(a="powershell"){return n.delete(`/obfuscation/global/${a}/preobfuscate`).catch(e=>Promise.reject(i(e)))}const v=x("obfuscation",{state:()=>({keywords:[],configs:[]}),actions:{async getKeywords(){const a=await q();this.keywords=a},async deleteKeyword(a){await E(a);const e=this.keywords.findIndex(t=>t.id===a);e>-1&&this.keywords.splice(e,1)},async getConfigs(){const a=await V();this.configs=a}},getters:{}});const U={components:{ListPageTop:K},data(){return{valid:!0,keywordDialog:!1,keywordDialogTitle:"",editedKeyword:{},preobfuscateDialog:!1,editedPreobfuscate:{},reobfuscate:!1,breads:[{text:"Obfuscation",disabled:!0,href:"/obfuscation"}],command:"",readonly:!1,headers:[{text:"Keyword",value:"keyword"},{text:"Replacement",value:"replacement"},{text:"Actions",value:"actions",sortable:!1,width:15}],rules:{keyword:[a=>!!a||"Keyword is required",a=>a.length>=3||"Keyword must be at least 3 characters"],replacement:[a=>!!a||"Replacement is required",a=>a.length>=3||"Replacement must be at least 3 characters"]}}},computed:{obfuscationStore(){return v()},...$(v,["keywords","configs"])},mounted(){this.refresh()},methods:{refresh(){this.refreshKeywords(),this.refreshConfigs()},refreshKeywords(){this.obfuscationStore.getKeywords()},refreshConfigs(){this.obfuscationStore.getConfigs()},toggleEditing(a){console.log("editing"),this.$set(a,"editing",!a.editing)},editKeyword(a){this.editedKeyword={...a},this.keywordDialogTitle="Edit Keyword",this.keywordDialog=!0},createKeyword(){this.editedKeyword={keyword:"",replacement:""},this.keywordDialogTitle="New Keyword",this.keywordDialog=!0},generateRandom(){this.editedKeyword.replacement=Math.random().toString(36).substring(2,8)},async saveKeyword(){if(this.$refs.form.validate())try{this.editedKeyword.id?await A(this.editedKeyword):await M(this.editedKeyword),this.refreshKeywords(),this.keywordDialog=!1}catch(a){this.$snack.error(`${a}`)}},async deleteKeyword(a){await this.$root.$confirm("Delete",`Are you sure you want to delete keyword ${a.keyword}?`,{color:"red"})&&await this.obfuscationStore.deleteKeyword(a.id)},async editConfig(a){try{await k(a),a.preobfuscatable?this.$snack.success('Updated config. Use "preobfuscate" to re-apply obfuscation.'):this.$snack.success("Updated config.")}catch(e){this.$snack.error(`${e}`)}},openPreobfuscateDialog(a){this.editedPreobfuscate={...a},this.reobfuscate=!1,this.preobfuscateDialog=!0},async preobfuscateModules(){try{await k(this.editedPreobfuscate),await L(this.editedPreobfuscate.language,this.reobfuscate),this.$snack.info("Preobfuscation started in the background. This will take a few minutes.")}catch(a){this.$snack.error(`${a}`)}this.preobfuscateDialog=!1},async deletePreobfuscatedModules(a){if(await this.$root.$confirm("","Are you sure? This will delete all preobfuscated modules.",{color:"red",width:500}))try{await I(a.language),this.$snack.success("Preobfuscated modules deleted.")}catch(e){this.$snack.error(`${e}`)}}}};var z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mr-6"},[t(K,{attrs:{breads:e.breads,"show-create":!1,"show-refresh":!0,"show-delete":!1},on:{refresh:e.refresh}}),t(_,{attrs:{"max-width":"500px"},model:{value:e.keywordDialog,callback:function(s){e.keywordDialog=s},expression:"keywordDialog"}},[t(c,[t(d,[t("span",{staticClass:"text-h5"},[e._v(e._s(e.keywordDialogTitle))])]),t(u,[t(b,[t(m,{ref:"form",nativeOn:{submit:function(s){return s.preventDefault(),e.saveKeyword.apply(null,arguments)}},model:{value:e.valid,callback:function(s){e.valid=s},expression:"valid"}},[t(p,{attrs:{rules:e.rules.keyword,dense:"",outlined:"",required:"",label:"Keyword"},model:{value:e.editedKeyword.keyword,callback:function(s){e.$set(e.editedKeyword,"keyword",s)},expression:"editedKeyword.keyword"}}),t(p,{attrs:{rules:e.rules.replacement,dense:"",outlined:"",required:"",label:"Replacement"},model:{value:e.editedKeyword.replacement,callback:function(s){e.$set(e.editedKeyword,"replacement",s)},expression:"editedKeyword.replacement"}}),t(r,{on:{click:e.generateRandom}},[e._v(" Random ")])],1)],1)],1),t(y,[t(h),t(r,{attrs:{color:"blue darken-1",text:""},on:{click:function(s){e.keywordDialog=!1}}},[e._v(" Cancel ")]),t(r,{attrs:{color:"blue darken-1",text:""},on:{click:e.saveKeyword}},[e._v(" Save ")])],1)],1)],1),t(_,{attrs:{"max-width":"500px"},model:{value:e.preobfuscateDialog,callback:function(s){e.preobfuscateDialog=s},expression:"preobfuscateDialog"}},[t(c,[t(d,[t("span",{staticClass:"text-h5"})]),t(u,[t("p",[e._v(' Are you sure? This will preobfuscate every module and will take a few minutes. Check "reobfuscate" if you need to force all modules to be reobfuscated after changing the global obfuscation configuration. ')]),t(b,[t(D,{attrs:{label:"Reobfuscate"},model:{value:e.reobfuscate,callback:function(s){e.reobfuscate=s},expression:"reobfuscate"}})],1)],1),t(y,[t(h),t(r,{attrs:{color:"blue darken-1",text:""},on:{click:function(s){e.preobfuscateDialog=!1}}},[e._v(" Cancel ")]),t(r,{attrs:{color:"blue darken-1",text:""},on:{click:e.preobfuscateModules}},[e._v(" Save ")])],1)],1)],1),t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[t(c,{staticClass:"ma-2 pa-2",staticStyle:{flex:"1 0 50%"}},[t(d,[t("span",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[t("span",{staticClass:"headline"},[e._v("Keyword Obfuscation")]),t(r,{attrs:{color:"primary"},on:{click:e.createKeyword}},[e._v(" Create "),t(f,{attrs:{right:""}},[e._v(" fa-plus-square ")])],1)],1)]),t(j,{attrs:{headers:e.headers,items:e.keywords},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t(P,{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:l,attrs:o}){return[t(r,e._g(e._b({attrs:{text:"",icon:"","x-small":""}},"v-btn",o,!1),l),[t(f,[e._v("fa-ellipsis-v")])],1)]}}],null,!0)},[t(S,{staticClass:"ml-2 mr-2"},[t(R,{staticClass:"pb-4"}),t(w,{key:"edit",attrs:{link:""},on:{click:function(l){return e.editKeyword(s)}}},[t(g,[t(f,[e._v("fa-edit")]),e._v(" Edit ")],1)],1),t(w,{key:"delete",attrs:{link:""},on:{click:function(l){return e.deleteKeyword(s)}}},[t(g,[t(f,[e._v("fa-trash-alt")]),e._v(" Delete ")],1)],1)],1)],1)]}}])})],1),t(c,{staticClass:"ma-2 pa-2",staticStyle:{flex:"1 0 50%"}},[t(d,[t("span",[t("span",{staticClass:"headline"},[e._v("Global Obfuscation")])])]),t(u,e._l(e.configs,function(s,l){return t(c,{key:l,staticClass:"ma-2 pa-2",attrs:{outlined:""}},[t(T,[e._v(e._s(s.language))]),t(u,[t(m,[t(O,{attrs:{label:"Enabled",readonly:e.readonly},model:{value:s.enabled,callback:function(o){e.$set(s,"enabled",o)},expression:"config.enabled"}}),t(p,{attrs:{label:"Command",rules:s.language!=="csharp"?[o=>!!o||"Command is required"]:[],dense:"",outlined:"",readonly:e.readonly},model:{value:s.command,callback:function(o){e.$set(s,"command",o)},expression:"config.command"}})],1)],1),t(y,[t(r,{attrs:{color:"primary"},on:{click:function(o){return e.editConfig(s)}}},[e._v(" Save ")]),t(r,{attrs:{disabled:!s.preobfuscatable,text:"",color:"primary"},on:{click:function(o){return e.openPreobfuscateDialog(s)}}},[e._v(" Preobfuscate ")]),t(r,{attrs:{disabled:!s.preobfuscatable,text:"",color:"error"},on:{click:function(o){return e.deletePreobfuscatedModules(s)}}},[e._v(" Remove preobfuscated modules ")])],1)],1)}),1)],1)],1)],1)},B=[],F=C(U,z,B,!1,null,null,null,null);const Y=F.exports;export{Y as default};
